<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>Environment.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script><style type="text/css">pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #555753; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #cc0000 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #8f5902 } /* Keyword */
.highlight .l { color: #2e3436 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #000000 } /* Operator */
.highlight .x { color: #2e3436 } /* Other */
.highlight .p { color: #000000 } /* Punctuation */
.highlight .ch { color: #555753; font-weight: bold; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #555753; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #3465a4; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #555753; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #555753; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3465a4; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #a40000 } /* Generic.Error */
.highlight .gh { color: #a40000; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #4e9a06 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #000000; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #000000; font-style: italic } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #4e9a06; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #4e9a06; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87 } /* Keyword.Pseudo */
.highlight .kr { color: #8f5902 } /* Keyword.Reserved */
.highlight .kt { color: #204a87 } /* Keyword.Type */
.highlight .ld { color: #2e3436 } /* Literal.Date */
.highlight .m { color: #2e3436 } /* Literal.Number */
.highlight .s { color: #ad7fa8 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #75507b } /* Name.Builtin */
.highlight .nc { color: #204a87 } /* Name.Class */
.highlight .no { color: #ce5c00 } /* Name.Constant */
.highlight .nd { color: #3465a4; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #c4a000; text-decoration: underline } /* Name.Entity */
.highlight .ne { color: #cc0000 } /* Name.Exception */
.highlight .nf { color: #a40000 } /* Name.Function */
.highlight .nl { color: #3465a4; font-weight: bold } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #a40000 } /* Name.Tag */
.highlight .nv { color: #ce5c00 } /* Name.Variable */
.highlight .ow { color: #8f5902 } /* Operator.Word */
.highlight .w { color: #d3d7cf; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #2e3436 } /* Literal.Number.Bin */
.highlight .mf { color: #2e3436 } /* Literal.Number.Float */
.highlight .mh { color: #2e3436 } /* Literal.Number.Hex */
.highlight .mi { color: #2e3436 } /* Literal.Number.Integer */
.highlight .mo { color: #2e3436 } /* Literal.Number.Oct */
.highlight .sa { color: #ad7fa8 } /* Literal.String.Affix */
.highlight .sb { color: #ad7fa8 } /* Literal.String.Backtick */
.highlight .sc { color: #ad7fa8; font-weight: bold } /* Literal.String.Char */
.highlight .dl { color: #ad7fa8 } /* Literal.String.Delimiter */
.highlight .sd { color: #ad7fa8 } /* Literal.String.Doc */
.highlight .s2 { color: #ad7fa8 } /* Literal.String.Double */
.highlight .se { color: #ad7fa8; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #ad7fa8; text-decoration: underline } /* Literal.String.Heredoc */
.highlight .si { color: #ce5c00 } /* Literal.String.Interpol */
.highlight .sx { color: #ad7fa8 } /* Literal.String.Other */
.highlight .sr { color: #ad7fa8 } /* Literal.String.Regex */
.highlight .s1 { color: #ad7fa8 } /* Literal.String.Single */
.highlight .ss { color: #8f5902 } /* Literal.String.Symbol */
.highlight .bp { color: #5c35cc } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a40000 } /* Name.Function.Magic */
.highlight .vc { color: #ce5c00 } /* Name.Variable.Class */
.highlight .vg { color: #ce5c00; text-decoration: underline } /* Name.Variable.Global */
.highlight .vi { color: #ce5c00 } /* Name.Variable.Instance */
.highlight .vm { color: #ce5c00 } /* Name.Variable.Magic */
.highlight .il { color: #2e3436 } /* Literal.Number.Integer.Long */</style></head><body><article class="alectryon-root alectryon-centered alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.11.0+0.11.1. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight"><span class="c">(* Distributed under the terms of the MIT license. *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">From</span> Coq <span class="kn">Require Import</span> ssreflect ssrfun Morphisms Setoid.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">From</span> MetaCoq.Template <span class="kn">Require Import</span> utils BasicAst.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">From</span> MetaCoq.Template <span class="kn">Require Import</span> Universes.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Module Type</span> <span class="nf">Term</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">term</span> : <span class="kt">Type</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">tRel</span> : nat -&gt; term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">tSort</span> : <span class="kn">Universe</span>.t -&gt; term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">tProd</span> : aname -&gt; term -&gt; term -&gt; term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">tLambda</span> : aname -&gt; term -&gt; term -&gt; term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">tLetIn</span> : aname -&gt; term -&gt; term -&gt; term -&gt; term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">tInd</span> : inductive -&gt; <span class="kn">Instance</span>.t -&gt; term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">tProj</span> : projection -&gt; term -&gt; term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">mkApps</span> : term -&gt; list term -&gt; term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">lift</span> : nat -&gt; nat -&gt; term -&gt; term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">subst</span> : list term -&gt; nat -&gt; term -&gt; term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">closedn</span> : nat -&gt; term -&gt; bool.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">noccur_between</span> : nat -&gt; nat -&gt; term -&gt; bool.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Parameter</span> <span class="nv">Inline</span> <span class="nv">subst_instance_constr</span> : UnivSubst term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Term</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Environment</span> (T : Term).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Import</span> T.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Existing Instance</span> <span class="nf">subst_instance_constr</span>.</span></span></span></pre><div class="doc">
<a name="lab1"></a><h2 class="section">Declarations</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">context_decl</span> := (context_decl term).</span></span></span></pre><div class="doc">
Local (de Bruijn) variable binding 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">vass</span> <span class="nv">x</span> <span class="nv">A</span> : context_decl :=
    {| decl_name := x ; decl_body := None ; decl_type := A |}.</span></span></span></pre><div class="doc">
Local (de Bruijn) let-binding 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">vdef</span> <span class="nv">x</span> <span class="nv">t</span> <span class="nv">A</span> : context_decl :=
    {| decl_name := x ; decl_body := Some t ; decl_type := A |}.</span></span></span></pre><div class="doc">
Local (de Bruijn) context 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">context</span> := list context_decl.</span></span></span></pre><div class="doc">
Last declaration first 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">lift_decl</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">d</span> := (map_decl (lift n k) d).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">lift_context</span> <span class="nv">n</span> <span class="nv">k</span> (<span class="nv">Œì</span> : <span class="kp">context</span>) : <span class="kp">context</span> :=
    fold_context_k (<span class="kr">fun</span> <span class="nv">k&#39;</span> =&gt; lift n (k&#39; + k)) Œì.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lift_context_alt</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">Œì</span> :
    lift_context n k Œì =
    mapi (<span class="kr">fun</span> <span class="nv">k&#39;</span> <span class="nv">d</span> =&gt; lift_decl n (Nat.pred #|Œì| - k&#39; + k) d) Œì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift_context n k Œì =
mapi
  (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt;
   [eta lift_decl n (Nat.pred #|Œì| - k&#39; + k)]) Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift_context n k Œì =
mapi
  (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt;
   [eta lift_decl n (Nat.pred #|Œì| - k&#39; + k)]) Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk2"><span class="highlight"><span class="nb">unfold</span> lift_context.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fold_context_k (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt; lift n (k&#39; + k)) Œì =
mapi
  (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt;
   [eta lift_decl n (Nat.pred #|Œì| - k&#39; + k)]) Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span>: fold_context_k_alt.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lift_context_length</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">Œì</span> : #|lift_context n k Œì| = #|Œì|.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|lift_context n k Œì| = #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|lift_context n k Œì| = #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> /lift_context; len.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> lift_context_length : len.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">subst_context</span> <span class="nv">s</span> <span class="nv">k</span> (<span class="nv">Œì</span> : <span class="kp">context</span>) : <span class="kp">context</span> :=
    fold_context_k (<span class="kr">fun</span> <span class="nv">k&#39;</span> =&gt; <span class="nb">subst</span> s (k&#39; + k)) Œì.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">subst_decl</span> <span class="nv">s</span> <span class="nv">k</span> (<span class="nv">d</span> : context_decl) := map_decl (<span class="nb">subst</span> s k) d.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_context_length</span> <span class="nv">s</span> <span class="nv">n</span> <span class="nv">Œì</span> : #|subst_context s n Œì| = #|Œì|.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|subst_context s n Œì| = #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|subst_context s n Œì| = #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> /subst_context; len.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> subst_context_length : len.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_context_nil</span> <span class="nv">s</span> <span class="nv">n</span> : subst_context s n [] = [].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">subst_context s n [] = []</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">subst_context s n [] = []</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_context_alt</span> <span class="nv">s</span> <span class="nv">k</span> <span class="nv">Œì</span> :
    subst_context s k Œì =
    mapi (<span class="kr">fun</span> <span class="nv">k&#39;</span> <span class="nv">d</span> =&gt; subst_decl s (Nat.pred #|Œì| - k&#39; + k) d) Œì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">subst_context s k Œì =
mapi
  (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt;
   [eta subst_decl s (Nat.pred #|Œì| - k&#39; + k)]) Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chka"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">subst_context s k Œì =
mapi
  (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt;
   [eta subst_decl s (Nat.pred #|Œì| - k&#39; + k)]) Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkb"><span class="highlight"><span class="nb">unfold</span> subst_context, fold_context_k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.rev
  (mapi
     (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt;
      [eta map_decl (<span class="nb">subst</span> s (k&#39; + k))]) (List.rev Œì)) =
mapi
  (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt;
   [eta subst_decl s (Nat.pred #|Œì| - k&#39; + k)]) Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkc"><span class="highlight"><span class="nb">rewrite</span> rev_mapi.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mapi
  (<span class="kr">fun</span> <span class="nv">k0</span> : nat =&gt;
   [eta map_decl
          (<span class="nb">subst</span> s (Nat.pred #|List.rev Œì| - k0 + k))])
  (List.rev (List.rev Œì)) =
mapi
  (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt;
   [eta subst_decl s (Nat.pred #|Œì| - k&#39; + k)]) Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkd"><span class="highlight"><span class="nb">rewrite</span> List.rev_involutive.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mapi
  (<span class="kr">fun</span> <span class="nv">k0</span> : nat =&gt;
   [eta map_decl
          (<span class="nb">subst</span> s (Nat.pred #|List.rev Œì| - k0 + k))])
  Œì =
mapi
  (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt;
   [eta subst_decl s (Nat.pred #|Œì| - k&#39; + k)]) Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chke"><span class="highlight"><span class="nb">apply</span> mapi_ext.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">x</span> : context_decl),
map_decl (<span class="nb">subst</span> s (Nat.pred #|List.rev Œì| - n + k)) x =
subst_decl s (Nat.pred #|Œì| - n + k) x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkf"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_decl (<span class="nb">subst</span> s (Nat.pred #|List.rev Œì| - n + k)) x =
subst_decl s (Nat.pred #|Œì| - n + k) x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk10"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_decl (<span class="nb">subst</span> s (Nat.pred #|List.rev Œì| - n + k)) x =
subst_decl s (Nat.pred #|Œì| - n + k) x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> List.rev_length.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk11"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_context_snoc</span> <span class="nv">s</span> <span class="nv">k</span> <span class="nv">Œì</span> <span class="nv">d</span> : subst_context s k (d :: Œì) = subst_context s k Œì ,, subst_decl s (#|Œì| + k) d.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">subst_context s k (d :: Œì) =
subst_context s k Œì,, subst_decl s (#|Œì| + k) d</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk12"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">subst_context s k (d :: Œì) =
subst_context s k Œì,, subst_decl s (#|Œì| + k) d</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> /subst_context fold_context_k_snoc0.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">subst_telescope</span> <span class="nv">s</span> <span class="nv">k</span> (<span class="nv">Œì</span> : <span class="kp">context</span>) : <span class="kp">context</span> :=
    mapi (<span class="kr">fun</span> <span class="nv">k&#39;</span> <span class="nv">decl</span> =&gt; map_decl (<span class="nb">subst</span> s (k&#39; + k)) decl) Œì.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Instance</span> <span class="nf">subst_instance_decl</span> : UnivSubst context_decl
    := map_decl ‚àò subst_instance.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Instance</span> <span class="nf">subst_instance_context</span> : UnivSubst <span class="kp">context</span>
    := map_context ‚àò subst_instance.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk13"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_instance_length</span> <span class="nv">u</span> (<span class="nv">ctx</span> : <span class="kp">context</span>)
    : #|subst_instance u ctx| = #|ctx|.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">Instance</span>.t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ctx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|subst_instance u ctx| = #|ctx|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk14"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">Instance</span>.t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ctx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|subst_instance u ctx| = #|ctx|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk15"><span class="highlight"><span class="nb">unfold</span> subst_instance, subst_instance_context, map_context.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">Instance</span>.t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ctx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|map (map_decl (subst_instance u)) ctx| = #|ctx|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> map_length.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> subst_instance_length : len.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">set_binder_name</span> (<span class="nv">na</span> : aname) (<span class="nv">x</span> : context_decl) : context_decl :=
    {| decl_name := na;
       decl_body := decl_body x;
       decl_type := decl_type x |}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">    
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">context_assumptions</span> (<span class="nv">Œì</span> : <span class="kp">context</span>) :=
    <span class="kr">match</span> Œì <span class="kr">with</span>
    | [] =&gt; <span class="mi">0</span>
    | d :: Œì =&gt;
      <span class="kr">match</span> d.(decl_body) <span class="kr">with</span>
      | Some _ =&gt; context_assumptions Œì
      | None =&gt; S (context_assumptions Œì)
      <span class="kr">end</span>
    <span class="kr">end</span>.</span></span></span></pre><div class="doc">
Smashing a context produces an assumption context. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">smash_context</span> (<span class="nv">Œì</span> <span class="nv">Œì&#39;</span> : <span class="kp">context</span>) : <span class="kp">context</span> :=
    <span class="kr">match</span> Œì&#39; <span class="kr">with</span>
    | {| decl_body := Some b |} :: Œì&#39; =&gt; smash_context (subst_context [b] <span class="mi">0</span> Œì) Œì&#39;
    | {| decl_body := None |} <span class="kr">as</span> d :: Œì&#39; =&gt; smash_context (Œì ++ [d]) Œì&#39;
    | [] =&gt; Œì
    <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">    
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk16"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">smash_context_length</span> <span class="nv">Œì</span> <span class="nv">Œì&#39;</span> : #|smash_context Œì Œì&#39;| = #|Œì| + context_assumptions Œì&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|smash_context Œì Œì&#39;| = #|Œì| + context_assumptions Œì&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk17"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|smash_context Œì Œì&#39;| = #|Œì| + context_assumptions Œì&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk18"><span class="highlight"><span class="nb">induction</span> Œì&#39; <span class="kr">as</span> [|[na [body|] ty] tl] <span class="kr">in</span> Œì |- *; <span class="nb">cbn</span>; <span class="nb">eauto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">body, ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHtl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : <span class="kp">context</span>,
#|smash_context Œì0 tl| =
#|Œì0| + context_assumptions tl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|smash_context (subst_context [body] <span class="mi">0</span> Œì) tl| =
#|Œì| + context_assumptions tl</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk19" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHtl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : <span class="kp">context</span>,
#|smash_context Œì0 tl| =
#|Œì0| + context_assumptions tl</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk19"><hr></label><div class="goal-conclusion"><span class="highlight">#|smash_context
    (Œì ++
     [{|
      decl_name := na;
      decl_body := None;
      decl_type := ty |}]) tl| =
#|Œì| + S (context_assumptions tl)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk1a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">body, ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHtl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : <span class="kp">context</span>,
#|smash_context Œì0 tl| =
#|Œì0| + context_assumptions tl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|smash_context (subst_context [body] <span class="mi">0</span> Œì) tl| =
#|Œì| + context_assumptions tl</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> IHtl subst_context_length.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk1b"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHtl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : <span class="kp">context</span>,
#|smash_context Œì0 tl| =
#|Œì0| + context_assumptions tl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|smash_context
    (Œì ++
     [{|
      decl_name := na;
      decl_body := None;
      decl_type := ty |}]) tl| =
#|Œì| + S (context_assumptions tl)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk1c"><span class="highlight"><span class="nb">rewrite</span> IHtl app_length.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHtl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : <span class="kp">context</span>,
#|smash_context Œì0 tl| =
#|Œì0| + context_assumptions tl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì| +
#|[{|
   decl_name := na;
   decl_body := None;
   decl_type := ty |}]| + context_assumptions tl =
#|Œì| + S (context_assumptions tl)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk1d"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHtl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : <span class="kp">context</span>,
#|smash_context Œì0 tl| =
#|Œì0| + context_assumptions tl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì| + <span class="mi">1</span> + context_assumptions tl =
#|Œì| + S (context_assumptions tl)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> smash_context_length : len.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
  <span class="c">(* Smashing a context Œì with Œî depending on it is the same as smashing Œì</span>
<span class="c">    and substituting all references to Œì in Œî by the expansions of let bindings. *)</span>
  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">extended_subst</span> (<span class="nv">Œì</span> : <span class="kp">context</span>) (<span class="nv">n</span> : nat) 
  (* Œî, smash_context Œì, n |- extended_subst Œì n : Œì *) :=
  <span class="kr">match</span> Œì <span class="kr">with</span>
  | nil =&gt; nil
  | cons d vs =&gt;
    <span class="kr">match</span> decl_body d <span class="kr">with</span>
    | Some b =&gt;
      <span class="c">(* Œî , vs |- b *)</span>
      <span class="kr">let</span> <span class="nv">s</span> := extended_subst vs n <span class="kr">in</span>
      <span class="c">(* Œî , smash_context vs , n |- s : vs *)</span>
      <span class="kr">let</span> <span class="nv">b&#39;</span> := lift (context_assumptions vs + n) #|s| b <span class="kr">in</span>
      <span class="c">(* Œî, smash_context vs, n , vs |- b&#39; *)</span>
      <span class="kr">let</span> <span class="nv">b&#39;</span> := <span class="nb">subst</span> s <span class="mi">0</span> b&#39; <span class="kr">in</span>
      <span class="c">(* Œî, smash_context vs , n |- b&#39; *)</span>
      b&#39; :: s
    | None =&gt; tRel n :: extended_subst vs (S n)
    <span class="kr">end</span>
  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk1e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">extended_subst_length</span> <span class="nv">Œì</span> <span class="nv">n</span> : #|extended_subst Œì n| = #|Œì|.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|extended_subst Œì n| = #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk1f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|extended_subst Œì n| = #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk20"><span class="highlight"><span class="nb">induction</span> Œì <span class="kr">in</span> n |- *; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n0</span> : nat, #|extended_subst Œì n0| = #|Œì|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|<span class="kr">match</span> decl_body a <span class="kr">with</span>
  | Some b =&gt;
      <span class="nb">subst</span> (extended_subst Œì n) <span class="mi">0</span>
        (lift (context_assumptions Œì + n)
           #|extended_subst Œì n| b)
      :: extended_subst Œì n
  | None =&gt; tRel n :: extended_subst Œì (S n)
  <span class="kr">end</span>| = S #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> a <span class="kr">as</span> [? [?|] ?] =&gt; /=; <span class="nb">simpl</span>; <span class="nb">rewrite</span> IHŒì.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> extended_subst_length : len.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">expand_lets_k</span> <span class="nv">Œì</span> <span class="nv">k</span> <span class="nv">t</span> := 
    (<span class="nb">subst</span> (extended_subst Œì <span class="mi">0</span>) k (lift (context_assumptions Œì) (k + #|Œì|) t)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">expand_lets</span> <span class="nv">Œì</span> <span class="nv">t</span> := expand_lets_k Œì <span class="mi">0</span> t.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">expand_lets_k_ctx</span> <span class="nv">Œì</span> <span class="nv">k</span> <span class="nv">Œî</span> := 
    (subst_context (extended_subst Œì <span class="mi">0</span>) k (lift_context (context_assumptions Œì) (k + #|Œì|) Œî)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">expand_lets_ctx</span> <span class="nv">Œì</span> <span class="nv">Œî</span> := expand_lets_k_ctx Œì <span class="mi">0</span> Œî.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk21"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">expand_lets_k_ctx_length</span> <span class="nv">Œì</span> <span class="nv">k</span> <span class="nv">Œî</span> : #|expand_lets_k_ctx Œì k Œî| = #|Œî|.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œî</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|expand_lets_k_ctx Œì k Œî| = #|Œî|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk22"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œî</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|expand_lets_k_ctx Œì k Œî| = #|Œî|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> /expand_lets_k_ctx; len.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> expand_lets_k_ctx_length : len.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk23"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">expand_lets_ctx_length</span> <span class="nv">Œì</span> <span class="nv">Œî</span> : #|expand_lets_ctx Œì Œî| = #|Œî|.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œî</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|expand_lets_ctx Œì Œî| = #|Œî|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk24"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œî</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|expand_lets_ctx Œì Œî| = #|Œî|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> /expand_lets_ctx; len.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> expand_lets_ctx_length : len.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">fix_context</span> (<span class="nv">m</span> : mfixpoint term) : <span class="kp">context</span> :=
    List.rev (mapi (<span class="kr">fun</span> <span class="nv">i</span> <span class="nv">d</span> =&gt; vass d.(dname) (lift i <span class="mi">0</span> d.(dtype))) m).</span></span></span></pre><div class="doc">
<a name="lab2"></a><h3 class="section">Environments</h3>
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">constructor_body</span> := {
    cstr_name : <span class="kn">ident</span>;
    <span class="c">(* The arguments and indices are typeable under the context of </span>
<span class="c">      arities of the mutual inductive + parameters *)</span>
    cstr_args : <span class="kp">context</span>;
    cstr_indices : list term;
    cstr_type : term; 
    <span class="c">(* Closed type: on well-formed constructors: forall params, cstr_args, I params cstr_indices *)</span>
    cstr_arity : nat; <span class="c">(* arity, w/o lets, w/o parameters *)</span>
  }.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">map_constructor_body</span> <span class="nv">npars</span> <span class="nv">arities</span> <span class="nv">f</span> <span class="nv">c</span> :=
    {| cstr_name := c.(cstr_name);
       cstr_args := fold_context_k (<span class="kr">fun</span> <span class="nv">x</span> =&gt; f (x + npars + arities)) c.(cstr_args);
       cstr_indices := map (f (npars + arities + #|c.(cstr_args)|)) c.(cstr_indices);
        <span class="c">(* Note only after positivity checking we can ensure that the indices do not mention the </span>
<span class="c">           inductive type.. beware of lets! *)</span>
       cstr_type := f arities c.(cstr_type);
       cstr_arity := c.(cstr_arity) |}.</span></span></span></pre><div class="doc">
See <span class="inlinecode"><span class="id" title="var">one_inductive_body</span></span> from <span class="inlinecode"><span class="id" title="var">declarations.ml</span></span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">one_inductive_body</span> := {
    ind_name : <span class="kn">ident</span>;
    ind_indices : <span class="kp">context</span>; <span class="c">(* Indices of the inductive types, under params *)</span>
    ind_sort : <span class="kn">Universe</span>.t; <span class="c">(* Sort of the inductive. *)</span>
    ind_type : term; <span class="c">(* Closed arity = forall mind_params, ind_indices, tSort ind_sort *)</span>
    ind_kelim : allowed_eliminations; <span class="c">(* Allowed eliminations *)</span>
    ind_ctors : list constructor_body;
    ind_projs : list (<span class="kn">ident</span> * term); <span class="c">(* names and types of projections, if any.</span>
<span class="c">                                      Type under context of params and inductive object *)</span>
    ind_relevance : relevance <span class="c">(* relevance of the inductive definition *)</span> }.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">map_one_inductive_body</span> <span class="nv">npars</span> <span class="nv">arities</span> <span class="nv">f</span> <span class="nv">m</span> :=
    <span class="kr">match</span> m <span class="kr">with</span>
    | Build_one_inductive_body ind_name ind_indices ind_sort 
        ind_type ind_kelim ind_ctors ind_projs ind_relevance =&gt;
      Build_one_inductive_body
         ind_name (fold_context_k (<span class="kr">fun</span> <span class="nv">x</span> =&gt; f (npars + x)) ind_indices) ind_sort
                  (f <span class="mi">0</span> ind_type) ind_kelim (map (map_constructor_body npars arities f) ind_ctors)
                  (map (on_snd (f (S npars))) ind_projs) ind_relevance
    <span class="kr">end</span>.</span></span></span></pre><div class="doc">
See <span class="inlinecode"><span class="id" title="var">mutual_inductive_body</span></span> from <span class="inlinecode"><span class="id" title="var">declarations.ml</span></span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">mutual_inductive_body</span> := {
    ind_finite : recursivity_kind;
    ind_npars : nat;
    ind_params : <span class="kp">context</span>;
    ind_bodies : list one_inductive_body ;
    ind_universes : universes_decl;
    ind_variance : option (list Universes.Variance.t) }.</span></span></span></pre><div class="doc">
See <span class="inlinecode"><span class="id" title="var">constant_body</span></span> from <span class="inlinecode"><span class="id" title="var">declarations.ml</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">constant_body</span> := {
      cst_type : term;
      cst_body : option term;
      cst_universes : universes_decl }.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">map_constant_body</span> <span class="nv">f</span> <span class="nv">decl</span> :=
    {| cst_type := f decl.(cst_type);
       cst_body := option_map f decl.(cst_body);
       cst_universes := decl.(cst_universes) |}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk25"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_cst_type</span> <span class="nv">f</span> <span class="nv">decl</span> :
    f (cst_type decl) = cst_type (map_constant_body f decl).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">constant_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (cst_type decl) =
cst_type (map_constant_body f decl)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk26"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">constant_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (cst_type decl) =
cst_type (map_constant_body f decl)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> decl; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk27"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_cst_body</span> <span class="nv">f</span> <span class="nv">decl</span> :
    option_map f (cst_body decl) = cst_body (map_constant_body f decl).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">constant_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">option_map f (cst_body decl) =
cst_body (map_constant_body f decl)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk28"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">constant_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">option_map f (cst_body decl) =
cst_body (map_constant_body f decl)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> decl; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Inductive</span> <span class="nf">global_decl</span> :=
  | ConstantDecl : constant_body -&gt; global_decl
  | InductiveDecl : mutual_inductive_body -&gt; global_decl.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Derive</span> <span class="nf">NoConfusion</span> <span class="kr">for</span> global_decl.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">global_env</span> := list (kername * global_decl).</span></span></span></pre><div class="doc">
A context of global declarations + global universe constraints,
      i.e. a global environment 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">global_env_ext</span> : <span class="kt">Type</span> := global_env * universes_decl.</span></span></span></pre><div class="doc">
Use a coercion for this common projection of the global context. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">fst_ctx</span> : global_env_ext -&gt; global_env := fst.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Coercion</span> <span class="nf">fst_ctx</span> : global_env_ext &gt;-&gt; global_env.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">empty_ext</span> (<span class="nv">Œ£</span> : global_env) : global_env_ext
    := (Œ£, Monomorphic_ctx ContextSet.empty).</span></span></span></pre><div class="doc">
<a name="lab3"></a><h3 class="section">Programs</h3>
<div class="paragraph"> </div>

    A set of declarations and a term, as produced by <span class="inlinecode"><span class="id" title="var">MetaCoq</span></span> <span class="inlinecode"><span class="id" title="var">Quote</span></span> <span class="inlinecode"><span class="id" title="var">Recursively</span></span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">program</span> : <span class="kt">Type</span> := global_env * term.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="c">(* TODO MOVE AstUtils factorisation *)</span>

</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">app_context</span> (<span class="nv">Œì</span> <span class="nv">Œì&#39;</span> : <span class="kp">context</span>) : <span class="kp">context</span> := Œì&#39; ++ Œì.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;Œì ,,, Œì&#39;&quot;</span> :=
    (app_context Œì Œì&#39;) (<span class="kn">at level</span> <span class="mi">25</span>, Œì&#39; <span class="kn">at next level</span>, <span class="kn">left associativity</span>).</span></span></span></pre><div class="doc">
Make a lambda/let-in string of abstractions from a context <span class="inlinecode"><span class="id" title="var">Œì</span></span>, ending with term <span class="inlinecode"><span class="id" title="var">t</span></span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">mkLambda_or_LetIn</span> <span class="nv">d</span> <span class="nv">t</span> :=
    <span class="kr">match</span> d.(decl_body) <span class="kr">with</span>
    | None =&gt; tLambda d.(decl_name) d.(decl_type) t
    | Some b =&gt; tLetIn d.(decl_name) b d.(decl_type) t
    <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">it_mkLambda_or_LetIn</span> (<span class="nv">l</span> : <span class="kp">context</span>) (<span class="nv">t</span> : term) :=
    List.fold_left (<span class="kr">fun</span> <span class="nv">acc</span> <span class="nv">d</span> =&gt; mkLambda_or_LetIn d acc) l t.</span></span></span></pre><div class="doc">
Make a prod/let-in string of abstractions from a context <span class="inlinecode"><span class="id" title="var">Œì</span></span>, ending with term <span class="inlinecode"><span class="id" title="var">t</span></span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">mkProd_or_LetIn</span> <span class="nv">d</span> <span class="nv">t</span> :=
    <span class="kr">match</span> d.(decl_body) <span class="kr">with</span>
    | None =&gt; tProd d.(decl_name) d.(decl_type) t
    | Some b =&gt; tLetIn d.(decl_name) b d.(decl_type) t
    <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">it_mkProd_or_LetIn</span> (<span class="nv">l</span> : <span class="kp">context</span>) (<span class="nv">t</span> : term) :=
    List.fold_left (<span class="kr">fun</span> <span class="nv">acc</span> <span class="nv">d</span> =&gt; mkProd_or_LetIn d acc) l t.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk29"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">it_mkProd_or_LetIn_app</span> <span class="nv">l</span> <span class="nv">l&#39;</span> <span class="nv">t</span> :
    it_mkProd_or_LetIn (l ++ l&#39;) t = it_mkProd_or_LetIn l&#39; (it_mkProd_or_LetIn l t).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">it_mkProd_or_LetIn (l ++ l&#39;) t =
it_mkProd_or_LetIn l&#39; (it_mkProd_or_LetIn l t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk2a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">it_mkProd_or_LetIn (l ++ l&#39;) t =
it_mkProd_or_LetIn l&#39; (it_mkProd_or_LetIn l t)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">induction</span> l <span class="kr">in</span> l&#39;, t |- *; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">reln</span> (<span class="nv">l</span> : list term) (<span class="nv">p</span> : nat) (<span class="nv">Œì0</span> : list context_decl) {<span class="nv">struct</span> <span class="nv">Œì0</span>} : list term :=
    <span class="kr">match</span> Œì0 <span class="kr">with</span>
    | [] =&gt; l
    | {| decl_body := Some _ |} :: hyps =&gt; reln l (p + <span class="mi">1</span>) hyps
    | {| decl_body := None |} :: hyps =&gt; reln (tRel p :: l) (p + <span class="mi">1</span>) hyps
    <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">to_extended_list_k</span> <span class="nv">Œì</span> <span class="nv">k</span> := reln [] k Œì.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">to_extended_list</span> <span class="nv">Œì</span> := to_extended_list_k Œì <span class="mi">0</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk2b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">reln_fold</span> <span class="nv">f</span> <span class="nv">ctx</span> <span class="nv">n</span> <span class="nv">acc</span> :
    reln acc n (fold_context_k f ctx) = 
    reln acc n ctx.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ctx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reln acc n (fold_context_k f ctx) = reln acc n ctx</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk2c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ctx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reln acc n (fold_context_k f ctx) = reln acc n ctx</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">induction</span> ctx <span class="kr">as</span> [|[na [b|] ty] ctx] <span class="kr">in</span> n, acc |- *; <span class="nb">simpl</span>; <span class="nb">auto</span>;
      <span class="nb">rewrite</span> fold_context_k_snoc0 /=; <span class="nb">apply</span> IHctx.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk2d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">reln_list_lift_above</span> <span class="nv">l</span> <span class="nv">p</span> <span class="nv">Œì</span> :
    Forall (<span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="kr">exists</span> <span class="nv">n</span>, x = tRel n /\ p &lt;= n /\ n &lt; p + length Œì) l -&gt;
    Forall (<span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="kr">exists</span> <span class="nv">n</span>, x = tRel n /\ p &lt;= n /\ n &lt; p + length Œì) (reln l p Œì).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p &lt;= n &lt; p + #|Œì|) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p &lt;= n &lt; p + #|Œì|)
  (reln l p Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk2e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p &lt;= n &lt; p + #|Œì|) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p &lt;= n &lt; p + #|Œì|)
  (reln l p Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk2f"><span class="highlight"><span class="nb">generalize</span> (le_refl p).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p &lt;= p -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p &lt;= n &lt; p + #|Œì|) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p &lt;= n &lt; p + #|Œì|)
  (reln l p Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk30"><span class="highlight"><span class="nb">generalize</span> p <span class="nb">at</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">5</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> : nat,
p0 &lt;= p -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; p + #|Œì|) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; p + #|Œì|)
  (reln l p Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk31"><span class="highlight"><span class="nb">induction</span> Œì <span class="kr">in</span> p, l |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> : nat,
p0 &lt;= p -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; p + #|[]|)
  l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; p + #|[]|)
  (reln l p [])</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk32" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p0</span> <span class="nv">p1</span> : nat),
p1 &lt;= p0 -&gt;
Forall (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p1 &lt;= n &lt; p0 + #|Œì|) l0 -&gt;
Forall (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p1 &lt;= n &lt; p0 + #|Œì|)
(reln l0 p0 Œì)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk32"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> : nat,
p0 &lt;= p -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + #|a :: Œì|) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + #|a :: Œì|)
  (reln l p (a :: Œì))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk33"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> : nat,
p0 &lt;= p -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; p + <span class="mi">0</span>) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; p + <span class="mi">0</span>) l</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk34" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p0</span> <span class="nv">p1</span> : nat),
p1 &lt;= p0 -&gt;
Forall (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p1 &lt;= n &lt; p0 + #|Œì|) l0 -&gt;
Forall (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p1 &lt;= n &lt; p0 + #|Œì|)
(reln l0 p0 Œì)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk34"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> : nat,
p0 &lt;= p -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + #|a :: Œì|) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + #|a :: Œì|)
  (reln l p (a :: Œì))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk35"><span class="highlight"><span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p0</span> <span class="nv">p1</span> : nat),
p1 &lt;= p0 -&gt;
Forall (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p1 &lt;= n &lt; p0 + #|Œì|) l0 -&gt;
Forall (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p1 &lt;= n &lt; p0 + #|Œì|)
(reln l0 p0 Œì)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> : nat,
p0 &lt;= p -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + #|a :: Œì|) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + #|a :: Œì|)
  (reln l p (a :: Œì))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk36"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
(reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + #|a :: Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + #|a :: Œì|)
  (reln l p (a :: Œì))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk37"><span class="highlight"><span class="nb">destruct</span> a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_body</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := decl_body;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := decl_body;
       decl_type := decl_type |} :: Œì|)
  (reln l p
     ({|
      decl_name := decl_name;
      decl_body := decl_body;
      decl_type := decl_type |} :: Œì))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk38"><span class="highlight"><span class="nb">destruct</span> decl_body.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t, decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := Some t;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := Some t;
       decl_type := decl_type |} :: Œì|)
  (reln l p
     ({|
      decl_name := decl_name;
      decl_body := Some t;
      decl_type := decl_type |} :: Œì))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk39" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk39"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|)
  (reln l p
     ({|
      decl_name := decl_name;
      decl_body := None;
      decl_type := decl_type |} :: Œì))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk3a"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t, decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := Some t;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; p + S #|Œì|)
  (reln l (p + <span class="mi">1</span>) Œì)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk3b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk3b"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|)
  (reln l p
     ({|
      decl_name := decl_name;
      decl_body := None;
      decl_type := decl_type |} :: Œì))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk3c"><span class="highlight"><span class="nb">assert</span>(p0 &lt;= S p) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t, decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := Some t;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= S p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; p + S #|Œì|)
  (reln l (p + <span class="mi">1</span>) Œì)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk3d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk3d"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|)
  (reln l p
     ({|
      decl_name := decl_name;
      decl_body := None;
      decl_type := decl_type |} :: Œì))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk3e"><span class="highlight"><span class="nb">specialize</span> (IHŒì l (S p) p0 H1).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t, decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|)
  (reln l (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := Some t;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= S p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; p + S #|Œì|)
  (reln l (p + <span class="mi">1</span>) Œì)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk3f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk3f"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|)
  (reln l p
     ({|
      decl_name := decl_name;
      decl_body := None;
      decl_type := decl_type |} :: Œì))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk40"><span class="highlight"><span class="nb">rewrite</span> &lt;- Nat.add_succ_comm, Nat.add_1_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t, decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|)
  (reln l (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := Some t;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= S p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|)
  (reln l (S p) Œì)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk41" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk41"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|)
  (reln l p
     ({|
      decl_name := decl_name;
      decl_body := None;
      decl_type := decl_type |} :: Œì))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk42"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t, decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln l (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + S #|Œì|) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= S p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln l (S p) Œì)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk43" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk43"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|)
  (reln l p
     ({|
      decl_name := decl_name;
      decl_body := None;
      decl_type := decl_type |} :: Œì))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk44"><span class="highlight"><span class="nb">rewrite</span> &lt;- Nat.add_succ_comm <span class="kr">in</span> H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t, decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)) l -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln l (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= S p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln l (S p) Œì)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk45" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk45"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|)
  (reln l p
     ({|
      decl_name := decl_name;
      decl_body := None;
      decl_type := decl_type |} :: Œì))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk46"><span class="highlight"><span class="nb">eauto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\
     p0 &lt;= n &lt;
     p +
     #|{|
       decl_name := decl_name;
       decl_body := None;
       decl_type := decl_type |} :: Œì|)
  (reln l p
     ({|
      decl_name := decl_name;
      decl_body := None;
      decl_type := decl_type |} :: Œì))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk47"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">p1</span> <span class="nv">p2</span> : nat),
p2 &lt;= p1 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|) l0 -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p2 &lt;= n &lt; p1 + #|Œì|)
  (reln l0 p1 Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + S #|Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; p + S #|Œì|)
  (reln (tRel p :: l) (p + <span class="mi">1</span>) Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk48"><span class="highlight"><span class="nb">specialize</span> (IHŒì (tRel p :: l) (S p) p0 <span class="kp">ltac</span>:(<span class="bp">lia</span>)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|)
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|)
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + S #|Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; p + S #|Œì|)
  (reln (tRel p :: l) (p + <span class="mi">1</span>) Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk49"><span class="highlight"><span class="nb">rewrite</span> &lt;- Nat.add_succ_comm, Nat.add_1_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|)
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|)
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + S #|Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|)
  (reln (tRel p :: l) (S p) Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk4a"><span class="highlight"><span class="nb">eapply</span> IHŒì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|)
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|)
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + S #|Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|)
  (tRel p :: l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk4b"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; p + S #|Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk4c"><span class="highlight"><span class="nb">rewrite</span> &lt;- Nat.add_succ_comm <span class="kr">in</span> H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk4d"><span class="highlight"><span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S p + #|Œì|) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk4e"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk4f"><span class="highlight"><span class="nb">constructor</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">n</span> : nat,
  tRel p = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk50" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)) l</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk50"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)) l</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk51"><span class="highlight"><span class="kr">exists</span> <span class="nv">p</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tRel p = tRel p /\ p0 &lt;= p &lt; S (p + #|Œì|)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk52" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)) l</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk52"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)) l</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk53"><span class="highlight"><span class="nb">intuition</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (tRel p :: l) -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|))
  (reln (tRel p :: l) (S p) Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p0 &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x = tRel n /\ p0 &lt;= n &lt; S (p + #|Œì|)) l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk54"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">to_extended_list_k_spec</span> <span class="nv">Œì</span> <span class="nv">k</span> :
    Forall (<span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="kr">exists</span> <span class="nv">n</span>, x = tRel n /\ k &lt;= n /\ n &lt; k + length Œì)
           (to_extended_list_k Œì k).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  (to_extended_list_k Œì k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk55"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  (to_extended_list_k Œì k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk56"><span class="highlight"><span class="nb">pose</span> (reln_list_lift_above [] k Œì).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">reln_list_lift_above [] k Œì</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  [] -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  (reln [] k Œì)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  (to_extended_list_k Œì k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk57"><span class="highlight"><span class="nb">unfold</span> to_extended_list_k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">reln_list_lift_above [] k Œì</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  [] -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  (reln [] k Œì)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  (reln [] k Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk58"><span class="highlight">forward f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">reln_list_lift_above [] k Œì</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  [] -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  (reln [] k Œì)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|) []</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk59" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  (reln [] k Œì)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk59"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  (reln [] k Œì)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk5a"><span class="highlight"><span class="nb">constructor</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  (reln [] k Œì)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ k &lt;= n &lt; k + #|Œì|)
  (reln [] k Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> f.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk5b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">to_extended_list_lift_above</span> <span class="nv">Œì</span> :
    Forall (<span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="kr">exists</span> <span class="nv">n</span>, x = tRel n /\ n &lt; length Œì) (to_extended_list Œì).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ n &lt; #|Œì|)
  (to_extended_list Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk5c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ n &lt; #|Œì|)
  (to_extended_list Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk5d"><span class="highlight"><span class="nb">pose</span> (reln_list_lift_above [] <span class="mi">0</span> Œì).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">reln_list_lift_above [] <span class="mi">0</span> Œì</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|)
  [] -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|)
  (reln [] <span class="mi">0</span> Œì)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ n &lt; #|Œì|)
  (to_extended_list Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk5e"><span class="highlight"><span class="nb">unfold</span> to_extended_list.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">reln_list_lift_above [] <span class="mi">0</span> Œì</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|)
  [] -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|)
  (reln [] <span class="mi">0</span> Œì)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ n &lt; #|Œì|)
  (to_extended_list_k Œì <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk5f"><span class="highlight">forward f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">reln_list_lift_above [] <span class="mi">0</span> Œì</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|)
  [] -&gt;
Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|)
  (reln [] <span class="mi">0</span> Œì)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|) []</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk60" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|)
  (reln [] <span class="mi">0</span> Œì)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk60"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ n &lt; #|Œì|)
  (to_extended_list_k Œì <span class="mi">0</span>)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk61"><span class="highlight"><span class="nb">constructor</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|)
  (reln [] <span class="mi">0</span> Œì)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ n &lt; #|Œì|)
  (to_extended_list_k Œì <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk62"><span class="highlight"><span class="nb">eapply</span> Forall_impl; <span class="nb">eauto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|)
  (reln [] <span class="mi">0</span> Œì)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : term,
(<span class="kr">fun</span> <span class="nv">x0</span> : term =&gt;
 <span class="kr">exists</span> <span class="nv">n</span> : nat, x0 = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|) x -&gt;
<span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ n &lt; #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk63"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x0</span> : term =&gt;
   <span class="kr">exists</span> <span class="nv">n</span> : nat,
     x0 = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|)
  (reln [] <span class="mi">0</span> Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x0</span> : term =&gt;
 <span class="kr">exists</span> <span class="nv">n</span> : nat, x0 = tRel n /\ <span class="mi">0</span> &lt;= n &lt; <span class="mi">0</span> + #|Œì|)
  x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">n</span> : nat, x = tRel n /\ n &lt; #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> H; <span class="nb">eexists</span>; <span class="nb">intuition</span> <span class="nb">eauto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">reln_alt</span> <span class="nv">p</span> (<span class="nv">Œì</span> : <span class="kp">context</span>) :=
    <span class="kr">match</span> Œì <span class="kr">with</span>
    | [] =&gt; []
    | {| decl_body := Some _ |} :: Œì =&gt; reln_alt (p + <span class="mi">1</span>) Œì
    | {| decl_body := None |} :: Œì =&gt; tRel p :: reln_alt (p + <span class="mi">1</span>) Œì
    <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk64"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">reln_alt_eq</span> <span class="nv">l</span> <span class="nv">Œì</span> <span class="nv">k</span> : reln l k Œì = List.rev (reln_alt k Œì) ++ l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reln l k Œì = List.rev (reln_alt k Œì) ++ l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk65"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reln l k Œì = List.rev (reln_alt k Œì) ++ l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk66"><span class="highlight"><span class="nb">induction</span> Œì <span class="kr">in</span> l, k |- *; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">k0</span> : nat),
reln l0 k0 Œì = List.rev (reln_alt k0 Œì) ++ l0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> a <span class="kr">with</span>
| {| decl_body := Some _ |} =&gt; reln l (k + <span class="mi">1</span>) Œì
| {| decl_body := None |} =&gt;
    reln (tRel k :: l) (k + <span class="mi">1</span>) Œì
<span class="kr">end</span> =
List.rev
  <span class="kr">match</span> a <span class="kr">with</span>
  | {| decl_body := Some _ |} =&gt; reln_alt (k + <span class="mi">1</span>) Œì
  | {| decl_body := None |} =&gt;
      tRel k :: reln_alt (k + <span class="mi">1</span>) Œì
  <span class="kr">end</span> ++ l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk67"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [na [body|] ty]; <span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">body, ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">k0</span> : nat),
reln l0 k0 Œì = List.rev (reln_alt k0 Œì) ++ l0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reln l (k + <span class="mi">1</span>) Œì = List.rev (reln_alt (k + <span class="mi">1</span>) Œì) ++ l</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk68" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">k0</span> : nat),
reln l0 k0 Œì = List.rev (reln_alt k0 Œì) ++ l0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk68"><hr></label><div class="goal-conclusion"><span class="highlight">reln (tRel k :: l) (k + <span class="mi">1</span>) Œì =
(List.rev (reln_alt (k + <span class="mi">1</span>) Œì) ++ [tRel k]) ++ l</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk69"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> IHŒì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l0</span> : list term) (<span class="nv">k0</span> : nat),
reln l0 k0 Œì = List.rev (reln_alt k0 Œì) ++ l0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reln (tRel k :: l) (k + <span class="mi">1</span>) Œì =
(List.rev (reln_alt (k + <span class="mi">1</span>) Œì) ++ [tRel k]) ++ l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> IHŒì -app_assoc.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk6a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">to_extended_list_k_cons</span> <span class="nv">d</span> <span class="nv">Œì</span> <span class="nv">k</span> :
    to_extended_list_k (d :: Œì) k =
    <span class="kr">match</span> d.(decl_body) <span class="kr">with</span>
    | None =&gt; to_extended_list_k Œì (S k) ++ [tRel k]
    | Some b =&gt; to_extended_list_k Œì (S k)
    <span class="kr">end</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">to_extended_list_k (d :: Œì) k =
<span class="kr">match</span> decl_body d <span class="kr">with</span>
| Some _ =&gt; to_extended_list_k Œì (S k)
| None =&gt; to_extended_list_k Œì (S k) ++ [tRel k]
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk6b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">to_extended_list_k (d :: Œì) k =
<span class="kr">match</span> decl_body d <span class="kr">with</span>
| Some _ =&gt; to_extended_list_k Œì (S k)
| None =&gt; to_extended_list_k Œì (S k) ++ [tRel k]
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk6c"><span class="highlight"><span class="nb">unfold</span> to_extended_list_k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reln [] k (d :: Œì) =
<span class="kr">match</span> decl_body d <span class="kr">with</span>
| Some _ =&gt; reln [] (S k) Œì
| None =&gt; reln [] (S k) Œì ++ [tRel k]
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk6d"><span class="highlight"><span class="nb">rewrite</span> reln_alt_eq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.rev (reln_alt k (d :: Œì)) ++ [] =
<span class="kr">match</span> decl_body d <span class="kr">with</span>
| Some _ =&gt; reln [] (S k) Œì
| None =&gt; reln [] (S k) Œì ++ [tRel k]
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk6e"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.rev
  <span class="kr">match</span> d <span class="kr">with</span>
  | {| decl_body := Some _ |} =&gt; reln_alt (k + <span class="mi">1</span>) Œì
  | {| decl_body := None |} =&gt;
      tRel k :: reln_alt (k + <span class="mi">1</span>) Œì
  <span class="kr">end</span> ++ [] =
<span class="kr">match</span> decl_body d <span class="kr">with</span>
| Some _ =&gt; reln [] (S k) Œì
| None =&gt; reln [] (S k) Œì ++ [tRel k]
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk6f"><span class="highlight"><span class="nb">destruct</span> d <span class="kr">as</span> [na [body|] ty].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">body, ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.rev (reln_alt (k + <span class="mi">1</span>) Œì) ++ [] =
<span class="kr">match</span>
  decl_body
    {|
    decl_name := na;
    decl_body := Some body;
    decl_type := ty |}
<span class="kr">with</span>
| Some _ =&gt; reln [] (S k) Œì
| None =&gt; reln [] (S k) Œì ++ [tRel k]
<span class="kr">end</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk70" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk70"><hr></label><div class="goal-conclusion"><span class="highlight">List.rev (tRel k :: reln_alt (k + <span class="mi">1</span>) Œì) ++ [] =
<span class="kr">match</span>
  decl_body
    {|
    decl_name := na;
    decl_body := None;
    decl_type := ty |}
<span class="kr">with</span>
| Some _ =&gt; reln [] (S k) Œì
| None =&gt; reln [] (S k) Œì ++ [tRel k]
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk71"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">body, ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.rev (reln_alt (k + <span class="mi">1</span>) Œì) ++ [] = reln [] (S k) Œì</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk72" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk72"><hr></label><div class="goal-conclusion"><span class="highlight">List.rev (tRel k :: reln_alt (k + <span class="mi">1</span>) Œì) ++ [] =
<span class="kr">match</span>
  decl_body
    {|
    decl_name := na;
    decl_body := None;
    decl_type := ty |}
<span class="kr">with</span>
| Some _ =&gt; reln [] (S k) Œì
| None =&gt; reln [] (S k) Œì ++ [tRel k]
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk73"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> reln_alt_eq Nat.add_1_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.rev (tRel k :: reln_alt (k + <span class="mi">1</span>) Œì) ++ [] =
<span class="kr">match</span>
  decl_body
    {|
    decl_name := na;
    decl_body := None;
    decl_type := ty |}
<span class="kr">with</span>
| Some _ =&gt; reln [] (S k) Œì
| None =&gt; reln [] (S k) Œì ++ [tRel k]
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk74"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(List.rev (reln_alt (k + <span class="mi">1</span>) Œì) ++ [tRel k]) ++ [] =
reln [] (S k) Œì ++ [tRel k]</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk75"><span class="highlight"><span class="nb">rewrite</span> reln_alt_eq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(List.rev (reln_alt (k + <span class="mi">1</span>) Œì) ++ [tRel k]) ++ [] =
(List.rev (reln_alt (S k) Œì) ++ []) ++ [tRel k]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- app_assoc, !app_nil_r, Nat.add_1_r.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">arities_context</span> (<span class="nv">l</span> : list one_inductive_body) :=
    rev_map (<span class="kr">fun</span> <span class="nv">ind</span> =&gt; vass (mkBindAnn (nNamed ind.(ind_name))
                            (ind.(ind_relevance))) ind.(ind_type)) l.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk76"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">arities_context_length</span> <span class="nv">l</span> : #|arities_context l| = #|l|.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list one_inductive_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|arities_context l| = #|l|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk77"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list one_inductive_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|arities_context l| = #|l|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk78"><span class="highlight"><span class="nb">unfold</span> arities_context.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list one_inductive_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|rev_map
    (<span class="kr">fun</span> <span class="nv">ind</span> : one_inductive_body =&gt;
     vass
       {|
       binder_name := nNamed (ind_name ind);
       binder_relevance := ind_relevance ind |}
       (ind_type ind)) l| = #|l|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> rev_map_length.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> arities_context_length : len.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk79"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">app_context_nil_l</span> <span class="nv">Œì</span> : [] ,,, Œì = Œì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[],,, Œì = Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk7a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[],,, Œì = Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk7b"><span class="highlight"><span class="nb">unfold</span> app_context.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Œì ++ [] = Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk7c"><span class="highlight"><span class="nb">rewrite</span> app_nil_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Œì = Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk7d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">app_context_assoc</span> <span class="nv">Œì</span> <span class="nv">Œì&#39;</span> <span class="nv">Œì&#39;&#39;</span> : Œì ,,, (Œì&#39; ,,, Œì&#39;&#39;) = Œì ,,, Œì&#39; ,,, Œì&#39;&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Œì,,, (Œì&#39;,,, Œì&#39;&#39;) = Œì,,, Œì&#39;,,, Œì&#39;&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk7e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Œì,,, (Œì&#39;,,, Œì&#39;&#39;) = Œì,,, Œì&#39;,,, Œì&#39;&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">unfold</span> app_context; <span class="bp">now</span> <span class="nb">rewrite</span> app_assoc.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk7f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">app_context_cons</span> <span class="nv">Œì</span> <span class="nv">Œì&#39;</span> <span class="nv">A</span> : Œì ,,, (Œì&#39; ,, A) = (Œì ,,, Œì&#39;) ,, A.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Œì,,, Œì&#39;,, A = (Œì,,, Œì&#39;),, A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk80"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Œì,,, Œì&#39;,, A = (Œì,,, Œì&#39;),, A</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (app_context_assoc _ _ [A]).</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk81"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">app_context_length</span> <span class="nv">Œì</span> <span class="nv">Œì&#39;</span> : #|Œì ,,, Œì&#39;| = #|Œì&#39;| + #|Œì|.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì,,, Œì&#39;| = #|Œì&#39;| + #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk82"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì,,, Œì&#39;| = #|Œì&#39;| + #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk83"><span class="highlight"><span class="nb">unfold</span> app_context.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì&#39; ++ Œì| = #|Œì&#39;| + #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> app_length.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> app_context_length : len.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk84"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">nth_error_app_context_ge</span> <span class="nv">v</span> <span class="nv">Œì</span> <span class="nv">Œì&#39;</span> :
    #|Œì&#39;| &lt;= v -&gt; nth_error (Œì ,,, Œì&#39;) v = nth_error Œì (v - #|Œì&#39;|).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= v -&gt;
nth_error (Œì,,, Œì&#39;) v = nth_error Œì (v - #|Œì&#39;|)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk85"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= v -&gt;
nth_error (Œì,,, Œì&#39;) v = nth_error Œì (v - #|Œì&#39;|)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> nth_error_app_ge.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk86"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">nth_error_app_context_lt</span> <span class="nv">v</span> <span class="nv">Œì</span> <span class="nv">Œì&#39;</span> :
    v &lt; #|Œì&#39;| -&gt; nth_error (Œì ,,, Œì&#39;) v = nth_error Œì&#39; v.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">v &lt; #|Œì&#39;| -&gt; nth_error (Œì,,, Œì&#39;) v = nth_error Œì&#39; v</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk87"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">v &lt; #|Œì&#39;| -&gt; nth_error (Œì,,, Œì&#39;) v = nth_error Œì&#39; v</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> nth_error_app_lt.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">map_mutual_inductive_body</span> <span class="nv">f</span> <span class="nv">m</span> :=
    <span class="kr">match</span> m <span class="kr">with</span>
    | Build_mutual_inductive_body finite ind_npars ind_pars ind_bodies ind_universes ind_variance =&gt;
      <span class="kr">let</span> <span class="nv">arities</span> := arities_context ind_bodies <span class="kr">in</span>
      <span class="kr">let</span> <span class="nv">pars</span> := fold_context_k f ind_pars <span class="kr">in</span>
      Build_mutual_inductive_body finite ind_npars pars
                                  (map (map_one_inductive_body (context_assumptions pars) (length arities) f) ind_bodies)
                                  ind_universes ind_variance
    <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk88"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ind_type_map</span> <span class="nv">f</span> <span class="nv">npars_ass</span> <span class="nv">arities</span> <span class="nv">oib</span> :
    ind_type (map_one_inductive_body npars_ass arities f oib) = f <span class="mi">0</span> (ind_type oib).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npars_ass, arities</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">oib</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">one_inductive_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_type
  (map_one_inductive_body npars_ass arities f oib) =
f <span class="mi">0</span> (ind_type oib)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk89"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npars_ass, arities</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">oib</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">one_inductive_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_type
  (map_one_inductive_body npars_ass arities f oib) =
f <span class="mi">0</span> (ind_type oib)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk8a"><span class="highlight"><span class="nb">destruct</span> oib.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npars_ass, arities</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_name0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">ident</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_indices0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_sort0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">Universe</span>.t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_type0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_kelim0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">allowed_eliminations</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_ctors0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list constructor_body</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_projs0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (<span class="kn">ident</span> √ó term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_relevance0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">relevance</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_type
  (map_one_inductive_body npars_ass arities f
     {|
     ind_name := ind_name0;
     ind_indices := ind_indices0;
     ind_sort := ind_sort0;
     ind_type := ind_type0;
     ind_kelim := ind_kelim0;
     ind_ctors := ind_ctors0;
     ind_projs := ind_projs0;
     ind_relevance := ind_relevance0 |}) =
f <span class="mi">0</span>
  (ind_type
     {|
     ind_name := ind_name0;
     ind_indices := ind_indices0;
     ind_sort := ind_sort0;
     ind_type := ind_type0;
     ind_kelim := ind_kelim0;
     ind_ctors := ind_ctors0;
     ind_projs := ind_projs0;
     ind_relevance := ind_relevance0 |})</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk8b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ind_ctors_map</span> <span class="nv">f</span> <span class="nv">npars_ass</span> <span class="nv">arities</span> <span class="nv">oib</span> :
    ind_ctors (map_one_inductive_body npars_ass arities f oib) =
    map (map_constructor_body npars_ass arities f) (ind_ctors oib).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npars_ass, arities</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">oib</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">one_inductive_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_ctors
  (map_one_inductive_body npars_ass arities f oib) =
map (map_constructor_body npars_ass arities f)
  (ind_ctors oib)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk8c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npars_ass, arities</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">oib</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">one_inductive_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_ctors
  (map_one_inductive_body npars_ass arities f oib) =
map (map_constructor_body npars_ass arities f)
  (ind_ctors oib)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> oib; <span class="nb">simpl</span>; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk8d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ind_pars_map</span> <span class="nv">f</span> <span class="nv">m</span> :
    ind_params (map_mutual_inductive_body f m) =
    fold_context_k f (ind_params m).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mutual_inductive_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_params (map_mutual_inductive_body f m) =
fold_context_k f (ind_params m)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk8e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mutual_inductive_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_params (map_mutual_inductive_body f m) =
fold_context_k f (ind_params m)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> m; <span class="nb">simpl</span>; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk8f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ind_projs_map</span> <span class="nv">f</span> <span class="nv">npars_ass</span> <span class="nv">arities</span> <span class="nv">oib</span> :
    ind_projs (map_one_inductive_body npars_ass arities f oib) =
    map (on_snd (f (S npars_ass))) (ind_projs oib).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npars_ass, arities</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">oib</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">one_inductive_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_projs
  (map_one_inductive_body npars_ass arities f oib) =
map (on_snd (f (S npars_ass))) (ind_projs oib)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk90"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npars_ass, arities</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">oib</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">one_inductive_body</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_projs
  (map_one_inductive_body npars_ass arities f oib) =
map (on_snd (f (S npars_ass))) (ind_projs oib)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk91"><span class="highlight"><span class="nb">destruct</span> oib; <span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npars_ass, arities</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_name0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">ident</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_indices0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_sort0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">Universe</span>.t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_type0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_kelim0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">allowed_eliminations</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_ctors0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list constructor_body</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_projs0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (<span class="kn">ident</span> √ó term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ind_relevance0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">relevance</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map (on_snd (f (S npars_ass))) ind_projs0 =
map (on_snd (f (S npars_ass))) ind_projs0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">lookup_env</span> (<span class="nv">Œ£</span> : global_env) (<span class="nv">kn</span> : kername) : option global_decl :=
    <span class="kr">match</span> Œ£ <span class="kr">with</span>
    | nil =&gt; None
    | d :: tl =&gt;
      <span class="kr">if</span> eq_kername kn d.<span class="mi">1</span> <span class="kr">then</span> Some d.<span class="mi">2</span>
      <span class="kr">else</span> lookup_env tl kn
    <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk92"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">context_assumptions_fold</span> <span class="nv">Œì</span> <span class="nv">f</span> : context_assumptions (fold_context_k f Œì) = context_assumptions Œì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (fold_context_k f Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk93"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (fold_context_k f Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk94"><span class="highlight"><span class="nb">rewrite</span> fold_context_k_alt.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions
  (mapi
     (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt;
      [eta map_decl (f (Nat.pred #|Œì| - k&#39;))]) Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk95"><span class="highlight"><span class="nb">unfold</span> mapi.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions
  (mapi_rec
     (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt;
      [eta map_decl (f (Nat.pred #|Œì| - k&#39;))]) Œì <span class="mi">0</span>) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk96"><span class="highlight"><span class="nb">generalize</span> <span class="mi">0</span> (Nat.pred #|Œì|).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">n0</span> : nat,
context_assumptions
  (mapi_rec
     (<span class="kr">fun</span> <span class="nv">k&#39;</span> : nat =&gt; [eta map_decl (f (n0 - k&#39;))]) Œì
     n) = context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">induction</span> Œì <span class="kr">as</span> [|[na [body|] ty] tl]; <span class="nb">cbn</span>; <span class="nb">intros</span>; <span class="nb">eauto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> context_assumptions_fold : len.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk97"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">nth_error_fold_context_k</span> (<span class="nv">f</span> : nat -&gt; term -&gt; term):
    <span class="kr">forall</span> (<span class="nv">Œì&#39;</span> <span class="nv">Œì&#39;&#39;</span> : <span class="kp">context</span>) (<span class="nv">v</span> : nat),
      v &lt; length Œì&#39; -&gt; <span class="kr">forall</span> <span class="nv">nth</span>,
        nth_error Œì&#39; v = Some nth -&gt;
        nth_error (fold_context_k f Œì&#39;) v = Some (map_decl (f (length Œì&#39; - S v)) nth).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì&#39;</span> : <span class="kp">context</span>,
<span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v</span> : nat,
v &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth</span> : context_decl,
nth_error Œì&#39; v = Some nth -&gt;
nth_error (fold_context_k f Œì&#39;) v =
Some (map_decl (f (#|Œì&#39;| - S v)) nth)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk98"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì&#39;</span> : <span class="kp">context</span>,
<span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v</span> : nat,
v &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth</span> : context_decl,
nth_error Œì&#39; v = Some nth -&gt;
nth_error (fold_context_k f Œì&#39;) v =
Some (map_decl (f (#|Œì&#39;| - S v)) nth)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk99"><span class="highlight"><span class="nb">induction</span> Œì&#39;; <span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|[]|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error [] v = Some nth</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f []) v =
Some (map_decl (f (#|[]| - S v)) nth)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk9a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v0</span> : nat,
v0 &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth0</span> : context_decl,
nth_error Œì&#39; v0 = Some nth0 -&gt;
nth_error (fold_context_k f Œì&#39;) v0 =
Some (map_decl (f (#|Œì&#39;| - S v0)) nth0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|a :: Œì&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (a :: Œì&#39;) v = Some nth</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk9a"><hr></label><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f (a :: Œì&#39;)) v =
Some (map_decl (f (#|a :: Œì&#39;| - S v)) nth)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk9b"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|[]|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error [] v = Some nth</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f []) v =
Some (map_decl (f (#|[]| - S v)) nth)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">easy</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk9c"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v0</span> : nat,
v0 &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth0</span> : context_decl,
nth_error Œì&#39; v0 = Some nth0 -&gt;
nth_error (fold_context_k f Œì&#39;) v0 =
Some (map_decl (f (#|Œì&#39;| - S v0)) nth0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|a :: Œì&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (a :: Œì&#39;) v = Some nth</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f (a :: Œì&#39;)) v =
Some (map_decl (f (#|a :: Œì&#39;| - S v)) nth)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk9d"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v0</span> : nat,
v0 &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth0</span> : context_decl,
nth_error Œì&#39; v0 = Some nth0 -&gt;
nth_error (fold_context_k f Œì&#39;) v0 =
Some (map_decl (f (#|Œì&#39;| - S v0)) nth0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|a :: Œì&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (a :: Œì&#39;) v = Some nth</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f (a :: Œì&#39;)) v =
Some (map_decl (f (#|Œì&#39;| - v)) nth)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chk9e"><span class="highlight"><span class="nb">destruct</span> v; <span class="nb">rewrite</span> fold_context_k_snoc0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v</span> : nat,
v &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth0</span> : context_decl,
nth_error Œì&#39; v = Some nth0 -&gt;
nth_error (fold_context_k f Œì&#39;) v =
Some (map_decl (f (#|Œì&#39;| - S v)) nth0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; #|a :: Œì&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (a :: Œì&#39;) <span class="mi">0</span> = Some nth</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39;,, map_decl (f #|Œì&#39;|) a)
  <span class="mi">0</span> = Some (map_decl (f (#|Œì&#39;| - <span class="mi">0</span>)) nth)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chk9f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v0</span> : nat,
v0 &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth0</span> : context_decl,
nth_error Œì&#39; v0 = Some nth0 -&gt;
nth_error (fold_context_k f Œì&#39;) v0 =
Some (map_decl (f (#|Œì&#39;| - S v0)) nth0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S v &lt; #|a :: Œì&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (a :: Œì&#39;) (S v) = Some nth</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chk9f"><hr></label><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39;,, map_decl (f #|Œì&#39;|) a)
  (S v) = Some (map_decl (f (#|Œì&#39;| - S v)) nth)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chka0"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v</span> : nat,
v &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth0</span> : context_decl,
nth_error Œì&#39; v = Some nth0 -&gt;
nth_error (fold_context_k f Œì&#39;) v =
Some (map_decl (f (#|Œì&#39;| - S v)) nth0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; #|a :: Œì&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (a :: Œì&#39;) <span class="mi">0</span> = Some nth</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39;,, map_decl (f #|Œì&#39;|) a)
  <span class="mi">0</span> = Some (map_decl (f (#|Œì&#39;| - <span class="mi">0</span>)) nth)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chka1"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v</span> : nat,
v &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth0</span> : context_decl,
nth_error Œì&#39; v = Some nth0 -&gt;
nth_error (fold_context_k f Œì&#39;) v =
Some (map_decl (f (#|Œì&#39;| - S v)) nth0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; #|a :: Œì&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (a :: Œì&#39;) <span class="mi">0</span> = Some nth</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some (map_decl (f #|Œì&#39;|) a) =
Some (map_decl (f (#|Œì&#39;| - <span class="mi">0</span>)) nth)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chka2"><span class="highlight"><span class="kp">repeat</span> <span class="nb">f_equal</span>; <span class="kp">try</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v</span> : nat,
v &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth0</span> : context_decl,
nth_error Œì&#39; v = Some nth0 -&gt;
nth_error (fold_context_k f Œì&#39;) v =
Some (map_decl (f (#|Œì&#39;| - S v)) nth0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; #|a :: Œì&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (a :: Œì&#39;) <span class="mi">0</span> = Some nth</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a = nth</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chka3"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v</span> : nat,
v &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth0</span> : context_decl,
nth_error Œì&#39; v = Some nth0 -&gt;
nth_error (fold_context_k f Œì&#39;) v =
Some (map_decl (f (#|Œì&#39;| - S v)) nth0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S #|Œì&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Some a = Some nth</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a = nth</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">congruence</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chka4"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v0</span> : nat,
v0 &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth0</span> : context_decl,
nth_error Œì&#39; v0 = Some nth0 -&gt;
nth_error (fold_context_k f Œì&#39;) v0 =
Some (map_decl (f (#|Œì&#39;| - S v0)) nth0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S v &lt; #|a :: Œì&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (a :: Œì&#39;) (S v) = Some nth</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39;,, map_decl (f #|Œì&#39;|) a)
  (S v) = Some (map_decl (f (#|Œì&#39;| - S v)) nth)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chka5"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kr">forall</span> <span class="nv">v0</span> : nat,
v0 &lt; #|Œì&#39;| -&gt;
<span class="kr">forall</span> <span class="nv">nth0</span> : context_decl,
nth_error Œì&#39; v0 = Some nth0 -&gt;
nth_error (fold_context_k f Œì&#39;) v0 =
Some (map_decl (f (#|Œì&#39;| - S v0)) nth0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S v &lt; #|a :: Œì&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (a :: Œì&#39;) (S v) = Some nth</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39;) v =
Some (map_decl (f (#|Œì&#39;| - S v)) nth)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> IHŒì&#39;; <span class="nb">simpl</span> <span class="kr">in</span> *; (<span class="bp">lia</span> || <span class="bp">congruence</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chka6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">nth_error_fold_context_k_eq</span>:
    <span class="kr">forall</span> (<span class="nv">Œì&#39;</span> : <span class="kp">context</span>) (<span class="nv">v</span> : nat) (<span class="nv">f</span> : nat -&gt; term -&gt; term),
      nth_error (fold_context_k f Œì&#39;) v =
      option_map (map_decl (f (length Œì&#39; - S v))) (nth_error Œì&#39; v).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">Œì&#39;</span> : <span class="kp">context</span>) (<span class="nv">v</span> : nat)
  (<span class="nv">f</span> : nat -&gt; term -&gt; term),
nth_error (fold_context_k f Œì&#39;) v =
option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error Œì&#39; v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chka7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">Œì&#39;</span> : <span class="kp">context</span>) (<span class="nv">v</span> : nat)
  (<span class="nv">f</span> : nat -&gt; term -&gt; term),
nth_error (fold_context_k f Œì&#39;) v =
option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error Œì&#39; v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chka8"><span class="highlight"><span class="nb">induction</span> Œì&#39;; <span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f []) v =
option_map (map_decl (f (#|[]| - S v)))
  (nth_error [] v)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chka9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">v0</span> : nat) (<span class="nv">f0</span> : nat -&gt; term -&gt; term),
nth_error (fold_context_k f0 Œì&#39;) v0 =
option_map (map_decl (f0 (#|Œì&#39;| - S v0)))
  (nth_error Œì&#39; v0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chka9"><hr></label><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f (a :: Œì&#39;)) v =
option_map (map_decl (f (#|a :: Œì&#39;| - S v)))
  (nth_error (a :: Œì&#39;) v)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkaa"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f []) v =
option_map (map_decl (f (#|[]| - S v)))
  (nth_error [] v)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkab"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f []) v =
option_map (map_decl (f <span class="mi">0</span>)) (nth_error [] v)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkac"><span class="highlight"><span class="nb">unfold</span> fold_context_k; <span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error [] v =
option_map (map_decl (f <span class="mi">0</span>)) (nth_error [] v)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> nth_error_nil.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkad"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">v0</span> : nat) (<span class="nv">f0</span> : nat -&gt; term -&gt; term),
nth_error (fold_context_k f0 Œì&#39;) v0 =
option_map (map_decl (f0 (#|Œì&#39;| - S v0)))
  (nth_error Œì&#39; v0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f (a :: Œì&#39;)) v =
option_map (map_decl (f (#|a :: Œì&#39;| - S v)))
  (nth_error (a :: Œì&#39;) v)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkae"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">v0</span> : nat) (<span class="nv">f0</span> : nat -&gt; term -&gt; term),
nth_error (fold_context_k f0 Œì&#39;) v0 =
option_map (map_decl (f0 (#|Œì&#39;| - S v0)))
  (nth_error Œì&#39; v0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f (a :: Œì&#39;)) v =
option_map (map_decl (f (#|Œì&#39;| - v)))
  (nth_error (a :: Œì&#39;) v)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkaf"><span class="highlight"><span class="nb">destruct</span> v; <span class="nb">rewrite</span> fold_context_k_snoc0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">v</span> : nat) (<span class="nv">f0</span> : nat -&gt; term -&gt; term),
nth_error (fold_context_k f0 Œì&#39;) v =
option_map (map_decl (f0 (#|Œì&#39;| - S v)))
  (nth_error Œì&#39; v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39;,, map_decl (f #|Œì&#39;|) a)
  <span class="mi">0</span> =
option_map (map_decl (f (#|Œì&#39;| - <span class="mi">0</span>)))
  (nth_error (a :: Œì&#39;) <span class="mi">0</span>)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chkb0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">v0</span> : nat) (<span class="nv">f0</span> : nat -&gt; term -&gt; term),
nth_error (fold_context_k f0 Œì&#39;) v0 =
option_map (map_decl (f0 (#|Œì&#39;| - S v0)))
  (nth_error Œì&#39; v0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkb0"><hr></label><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39;,, map_decl (f #|Œì&#39;|) a)
  (S v) =
option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error (a :: Œì&#39;) (S v))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkb1"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">v</span> : nat) (<span class="nv">f0</span> : nat -&gt; term -&gt; term),
nth_error (fold_context_k f0 Œì&#39;) v =
option_map (map_decl (f0 (#|Œì&#39;| - S v)))
  (nth_error Œì&#39; v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39;,, map_decl (f #|Œì&#39;|) a)
  <span class="mi">0</span> =
option_map (map_decl (f (#|Œì&#39;| - <span class="mi">0</span>)))
  (nth_error (a :: Œì&#39;) <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkb2"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">v</span> : nat) (<span class="nv">f0</span> : nat -&gt; term -&gt; term),
nth_error (fold_context_k f0 Œì&#39;) v =
option_map (map_decl (f0 (#|Œì&#39;| - S v)))
  (nth_error Œì&#39; v)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some (map_decl (f #|Œì&#39;|) a) =
Some (map_decl (f (#|Œì&#39;| - <span class="mi">0</span>)) a)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kp">repeat</span> <span class="nb">f_equal</span>; <span class="kp">try</span> <span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkb3"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">v0</span> : nat) (<span class="nv">f0</span> : nat -&gt; term -&gt; term),
nth_error (fold_context_k f0 Œì&#39;) v0 =
option_map (map_decl (f0 (#|Œì&#39;| - S v0)))
  (nth_error Œì&#39; v0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39;,, map_decl (f #|Œì&#39;|) a)
  (S v) =
option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error (a :: Œì&#39;) (S v))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkb4"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">v0</span> : nat) (<span class="nv">f0</span> : nat -&gt; term -&gt; term),
nth_error (fold_context_k f0 Œì&#39;) v0 =
option_map (map_decl (f0 (#|Œì&#39;| - S v0)))
  (nth_error Œì&#39; v0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39;) v =
option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error Œì&#39; v)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> IHŒì&#39;; <span class="nb">simpl</span> <span class="kr">in</span> *; (<span class="bp">lia</span> || <span class="bp">congruence</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkb5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">nth_error_ge</span> {<span class="nv">Œì</span> <span class="nv">Œì&#39;</span> <span class="nv">v</span> <span class="nv">Œì&#39;&#39;</span>} (<span class="nv">f</span> : nat -&gt; term -&gt; term) :
    length Œì&#39; &lt;= v -&gt;
    nth_error (Œì&#39; ++ Œì) v =
    nth_error (fold_context_k f Œì&#39; ++ Œì&#39;&#39; ++ Œì) (length Œì&#39;&#39; + v).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= v -&gt;
nth_error (Œì&#39; ++ Œì) v =
nth_error (fold_context_k f Œì&#39; ++ Œì&#39;&#39; ++ Œì)
  (#|Œì&#39;&#39;| + v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkb6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= v -&gt;
nth_error (Œì&#39; ++ Œì) v =
nth_error (fold_context_k f Œì&#39; ++ Œì&#39;&#39; ++ Œì)
  (#|Œì&#39;&#39;| + v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkb7"><span class="highlight"><span class="nb">intros</span> Hv.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (Œì&#39; ++ Œì) v =
nth_error (fold_context_k f Œì&#39; ++ Œì&#39;&#39; ++ Œì)
  (#|Œì&#39;&#39;| + v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkb8"><span class="highlight"><span class="nb">rewrite</span> -&gt; !nth_error_app_ge, <span class="nl">?fold_context_k_length</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error Œì (v - #|Œì&#39;|) =
nth_error Œì (#|Œì&#39;&#39;| + v - #|Œì&#39;| - #|Œì&#39;&#39;|)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chkb9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkb9"><hr></label><div class="goal-conclusion"><span class="highlight">#|Œì&#39;&#39;| &lt;= #|Œì&#39;&#39;| + v - #|fold_context_k f Œì&#39;|</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="Environment-v-chkba" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkba"><hr></label><div class="goal-conclusion"><span class="highlight">#|fold_context_k f Œì&#39;| &lt;= #|Œì&#39;&#39;| + v</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="Environment-v-chkbb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkbb"><hr></label><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= v</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkbc"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">v - #|Œì&#39;| = #|Œì&#39;&#39;| + v - #|Œì&#39;| - #|Œì&#39;&#39;|</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chkbd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkbd"><hr></label><div class="goal-conclusion"><span class="highlight">#|Œì&#39;&#39;| &lt;= #|Œì&#39;&#39;| + v - #|fold_context_k f Œì&#39;|</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="Environment-v-chkbe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkbe"><hr></label><div class="goal-conclusion"><span class="highlight">#|fold_context_k f Œì&#39;| &lt;= #|Œì&#39;&#39;| + v</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="Environment-v-chkbf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkbf"><hr></label><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= v</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkc0"><span class="highlight"><span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì&#39;&#39;| &lt;= #|Œì&#39;&#39;| + v - #|fold_context_k f Œì&#39;|</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chkc1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkc1"><hr></label><div class="goal-conclusion"><span class="highlight">#|fold_context_k f Œì&#39;| &lt;= #|Œì&#39;&#39;| + v</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="Environment-v-chkc2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkc2"><hr></label><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= v</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkc3"><span class="highlight"><span class="nb">rewrite</span> fold_context_k_length.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì&#39;&#39;| &lt;= #|Œì&#39;&#39;| + v - #|Œì&#39;|</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chkc4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkc4"><hr></label><div class="goal-conclusion"><span class="highlight">#|fold_context_k f Œì&#39;| &lt;= #|Œì&#39;&#39;| + v</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="Environment-v-chkc5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkc5"><hr></label><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= v</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkc6"><span class="highlight"><span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|fold_context_k f Œì&#39;| &lt;= #|Œì&#39;&#39;| + v</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chkc7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkc7"><hr></label><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= v</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkc8"><span class="highlight"><span class="nb">rewrite</span> fold_context_k_length.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= #|Œì&#39;&#39;| + v</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chkc9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkc9"><hr></label><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= v</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkca"><span class="highlight"><span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= v</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= v</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkcb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">nth_error_lt</span> {<span class="nv">Œì</span> <span class="nv">Œì&#39;</span> <span class="nv">Œì&#39;&#39;</span> <span class="nv">v</span>} (<span class="nv">f</span> : nat -&gt; term -&gt; term) :
    v &lt; length Œì&#39; -&gt;
    nth_error (fold_context_k f Œì&#39; ++ Œì&#39;&#39; ++ Œì) v =
    option_map (map_decl (f (length Œì&#39; - S v))) (nth_error (Œì&#39; ++ Œì) v).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">v &lt; #|Œì&#39;| -&gt;
nth_error (fold_context_k f Œì&#39; ++ Œì&#39;&#39; ++ Œì) v =
option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error (Œì&#39; ++ Œì) v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkcc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">v &lt; #|Œì&#39;| -&gt;
nth_error (fold_context_k f Œì&#39; ++ Œì&#39;&#39; ++ Œì) v =
option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error (Œì&#39; ++ Œì) v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkcd"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">v &lt; #|Œì&#39;| -&gt;
nth_error (fold_context_k f Œì&#39; ++ Œì&#39;&#39; ++ Œì) v =
option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error (Œì&#39; ++ Œì) v)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkce"><span class="highlight"><span class="nb">intros</span> Hv.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|Œì&#39;|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39; ++ Œì&#39;&#39; ++ Œì) v =
option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error (Œì&#39; ++ Œì) v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkcf"><span class="highlight"><span class="nb">rewrite</span> -&gt; !nth_error_app_lt.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|Œì&#39;|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (fold_context_k f Œì&#39;) v =
option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error Œì&#39; v)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chkd0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|Œì&#39;|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkd0"><hr></label><div class="goal-conclusion"><span class="highlight">v &lt; #|Œì&#39;|</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="Environment-v-chkd1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|Œì&#39;|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkd1"><hr></label><div class="goal-conclusion"><span class="highlight">v &lt; #|fold_context_k f Œì&#39;|</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkd2"><span class="highlight"><span class="nb">rewrite</span> nth_error_fold_context_k_eq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|Œì&#39;|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error Œì&#39; v) =
option_map (map_decl (f (#|Œì&#39;| - S v)))
  (nth_error Œì&#39; v)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chkd3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|Œì&#39;|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkd3"><hr></label><div class="goal-conclusion"><span class="highlight">v &lt; #|Œì&#39;|</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="Environment-v-chkd4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|Œì&#39;|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkd4"><hr></label><div class="goal-conclusion"><span class="highlight">v &lt; #|fold_context_k f Œì&#39;|</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkd5"><span class="highlight"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|Œì&#39;|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">v &lt; #|Œì&#39;|</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Environment-v-chkd6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|Œì&#39;|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="Environment-v-chkd6"><hr></label><div class="goal-conclusion"><span class="highlight">v &lt; #|fold_context_k f Œì&#39;|</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkd7"><span class="highlight"><span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œì', Œì''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">v &lt; #|Œì&#39;|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">v &lt; #|fold_context_k f Œì&#39;|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> fold_context_k_length.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkd8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">context_assumptions_length_bound</span> <span class="nv">Œì</span> : context_assumptions Œì &lt;= #|Œì|.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions Œì &lt;= #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkd9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions Œì &lt;= #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkda"><span class="highlight"><span class="nb">induction</span> Œì; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_assumptions Œì &lt;= #|Œì|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> decl_body a <span class="kr">with</span>
| Some _ =&gt; context_assumptions Œì
| None =&gt; S (context_assumptions Œì)
<span class="kr">end</span> &lt;= S #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkdb"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [? [?|] ?]; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">decl_name</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">decl_type</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_assumptions Œì &lt;= #|Œì|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S (context_assumptions Œì) &lt;= S #|Œì|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkdc"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">context_assumptions_map</span> <span class="nv">f</span> <span class="nv">Œì</span> : context_assumptions (map_context f Œì) = context_assumptions Œì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (map_context f Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkdd"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (map_context f Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">induction</span> Œì <span class="kr">as</span> [|[? [?|] ?] ?]; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkde"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">context_assumptions_app</span> <span class="nv">Œì</span> <span class="nv">Œî</span> : context_assumptions (Œì ++ Œî) = 
    context_assumptions Œì + context_assumptions Œî.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œî</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (Œì ++ Œî) =
context_assumptions Œì + context_assumptions Œî</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkdf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì, Œî</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (Œì ++ Œî) =
context_assumptions Œì + context_assumptions Œî</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">induction</span> Œì <span class="kr">as</span> [|[? [] ?] ?]; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chke0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">context_assumptions_mapi</span> <span class="nv">f</span> <span class="nv">Œì</span> : context_assumptions (mapi (<span class="kr">fun</span> <span class="nv">i</span> =&gt; map_decl (f i)) Œì) = 
    context_assumptions Œì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions
  (mapi (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt; map_decl (f i)) Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chke1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions
  (mapi (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt; map_decl (f i)) Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chke2"><span class="highlight"><span class="nb">rewrite</span> /mapi; <span class="nb">generalize</span> <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
context_assumptions
  (mapi_rec (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt; map_decl (f i)) Œì n) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chke3"><span class="highlight"><span class="nb">induction</span> Œì; <span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="nb">eauto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n0</span> : nat,
context_assumptions (mapi_rec (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt; map_decl (f i)) Œì n0) =
context_assumptions Œì</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> option_map (f n) (decl_body a) <span class="kr">with</span>
| Some _ =&gt;
    context_assumptions
      (mapi_rec (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt; map_decl (f i)) Œì
         (S n))
| None =&gt;
    S
      (context_assumptions
         (mapi_rec (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt; map_decl (f i)) Œì
            (S n)))
<span class="kr">end</span> =
<span class="kr">match</span> decl_body a <span class="kr">with</span>
| Some _ =&gt; context_assumptions Œì
| None =&gt; S (context_assumptions Œì)
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [? [b|] ?]; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> context_assumptions_map context_assumptions_mapi context_assumptions_app : len.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chke4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">context_assumptions_subst_instance</span> <span class="nv">u</span> <span class="nv">Œì</span> : 
    context_assumptions (subst_instance u Œì) = 
    context_assumptions Œì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">Instance</span>.t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (subst_instance u Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chke5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">Instance</span>.t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (subst_instance u Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> context_assumptions_map.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chke6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">context_assumptions_subst_context</span> <span class="nv">s</span> <span class="nv">k</span> <span class="nv">Œì</span> : 
    context_assumptions (subst_context s k Œì) = 
    context_assumptions Œì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (subst_context s k Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chke7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (subst_context s k Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> context_assumptions_fold.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chke8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">context_assumptions_lift_context</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">Œì</span> : 
    context_assumptions (lift_context n k Œì) = 
    context_assumptions Œì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (lift_context n k Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chke9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">context_assumptions (lift_context n k Œì) =
context_assumptions Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> context_assumptions_fold.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Rewrite</span> context_assumptions_subst_instance
     context_assumptions_subst_context context_assumptions_lift_context : len.</span></span></span></pre><div class="doc">
Lifting a relation to declarations, without alpha renaming. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Inductive</span> <span class="nf">All_decls</span> (<span class="nv">P</span> : term -&gt; term -&gt; <span class="kt">Type</span>) : context_decl -&gt; context_decl -&gt; <span class="kt">Type</span> :=
  | on_vass na t t&#39; :
    P t t&#39; -&gt;
    All_decls P (vass na t) (vass na t&#39;)

  | on_vdef na b t b&#39; t&#39; :
    P b b&#39; -&gt;
    P t t&#39; -&gt;
    All_decls P (vdef na b t) (vdef na b&#39; t&#39;).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Derive</span> <span class="nf">Signature</span> NoConfusion <span class="kr">for</span> All_decls.</span></span></span></pre><div class="doc">
Allow alpha-renaming of binders 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Inductive</span> <span class="nf">All_decls_alpha</span> (<span class="nv">P</span> : term -&gt; term -&gt; <span class="kt">Type</span>) : context_decl -&gt; context_decl -&gt; <span class="kt">Type</span> :=
  | on_vass_alpha na na&#39; t t&#39; :
    eq_binder_annot na na&#39; -&gt;
    P t t&#39; -&gt;
    All_decls_alpha P (vass na t) (vass na&#39; t&#39;)
  
  | on_vdef_alpha na na&#39; b t b&#39; t&#39; :
    eq_binder_annot na na&#39; -&gt;
    P b b&#39; -&gt;
    P t t&#39; -&gt;
    All_decls_alpha P (vdef na b t) (vdef na&#39; b&#39; t&#39;).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Derive</span> <span class="nf">Signature</span> NoConfusion <span class="kr">for</span> All_decls_alpha.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkea"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">All_decls_impl</span> (<span class="nv">P</span> <span class="nv">Q</span> : term -&gt; term -&gt; <span class="kt">Type</span>) <span class="nv">d</span> <span class="nv">d&#39;</span> : 
    All_decls P d d&#39; -&gt;
    (<span class="kr">forall</span> <span class="nv">t</span> <span class="nv">t&#39;</span>, P t t&#39; -&gt; Q t t&#39;) -&gt;
    All_decls Q d d&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P, Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d, d'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All_decls P d d&#39; -&gt;
(<span class="kr">forall</span> <span class="nv">t</span> <span class="nv">t&#39;</span> : term, P t t&#39; -&gt; Q t t&#39;) -&gt;
All_decls Q d d&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkeb"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P, Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d, d'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All_decls P d d&#39; -&gt;
(<span class="kr">forall</span> <span class="nv">t</span> <span class="nv">t&#39;</span> : term, P t t&#39; -&gt; Q t t&#39;) -&gt;
All_decls Q d d&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">intros</span> ond H; <span class="nb">destruct</span> ond; <span class="nb">constructor</span>; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkec"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">All_decls_alpha_impl</span> (<span class="nv">P</span> <span class="nv">Q</span> : term -&gt; term -&gt; <span class="kt">Type</span>) <span class="nv">d</span> <span class="nv">d&#39;</span> : 
    All_decls_alpha P d d&#39; -&gt;
    (<span class="kr">forall</span> <span class="nv">t</span> <span class="nv">t&#39;</span>, P t t&#39; -&gt; Q t t&#39;) -&gt;
    All_decls_alpha Q d d&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P, Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d, d'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All_decls_alpha P d d&#39; -&gt;
(<span class="kr">forall</span> <span class="nv">t</span> <span class="nv">t&#39;</span> : term, P t t&#39; -&gt; Q t t&#39;) -&gt;
All_decls_alpha Q d d&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chked"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P, Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d, d'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All_decls_alpha P d d&#39; -&gt;
(<span class="kr">forall</span> <span class="nv">t</span> <span class="nv">t&#39;</span> : term, P t t&#39; -&gt; Q t t&#39;) -&gt;
All_decls_alpha Q d d&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">intros</span> ond H; <span class="nb">destruct</span> ond; <span class="nb">constructor</span>; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkee"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">All_decls_to_alpha</span> (<span class="nv">P</span> : term -&gt; term -&gt; <span class="kt">Type</span>) <span class="nv">d</span> <span class="nv">d&#39;</span> : 
    All_decls P d d&#39; -&gt;
    All_decls_alpha P d d&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d, d'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All_decls P d d&#39; -&gt; All_decls_alpha P d d&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkef"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d, d'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All_decls P d d&#39; -&gt; All_decls_alpha P d d&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">intros</span> []; <span class="nb">constructor</span>; <span class="nb">auto</span>; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Inductive</span> <span class="nf">All2_fold</span> {<span class="nv">P</span> : <span class="kp">context</span> -&gt; <span class="kp">context</span> -&gt; context_decl -&gt; context_decl -&gt; <span class="kt">Type</span>}
            : <span class="kr">forall</span> (<span class="nv">Œì</span> <span class="nv">Œì&#39;</span> : <span class="kp">context</span>), <span class="kt">Type</span> :=
  | All2_fold_nil : All2_fold nil nil
  | All2_fold_cons {d d&#39; Œì Œì&#39;} : All2_fold Œì Œì&#39; -&gt; P Œì Œì&#39; d d&#39; -&gt; All2_fold (d :: Œì) (d&#39; :: Œì&#39;).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Derive</span> <span class="nf">Signature</span> NoConfusion <span class="kr">for</span> All2_fold.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Arguments</span> All2_fold P Œì Œì&#39; : <span class="kn">clear implicits</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkf0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">All2_fold_length</span> {<span class="nv">P</span> <span class="nv">Œì</span> <span class="nv">Œì&#39;</span>} :
    All2_fold P Œì Œì&#39; -&gt; #|Œì| = #|Œì&#39;|.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kp">context</span> -&gt; context_decl -&gt; context_decl -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All2_fold P Œì Œì&#39; -&gt; #|Œì| = #|Œì&#39;|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkf1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kp">context</span> -&gt; context_decl -&gt; context_decl -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All2_fold P Œì Œì&#39; -&gt; #|Œì| = #|Œì&#39;|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">induction</span> <span class="mi">1</span>; <span class="nb">cbn</span>; <span class="bp">congruence</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkf2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">All2_fold_impl</span> {<span class="nv">P</span> <span class="nv">Q</span> <span class="nv">Œì</span> <span class="nv">Œì&#39;</span>} :
    All2_fold P Œì Œì&#39; -&gt; (<span class="kr">forall</span> <span class="nv">Œì</span> <span class="nv">Œì&#39;</span> <span class="nv">d</span> <span class="nv">d&#39;</span>, P Œì Œì&#39; d d&#39; -&gt; Q Œì Œì&#39; d d&#39;) -&gt;
    All2_fold Q Œì Œì&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P, Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kp">context</span> -&gt; context_decl -&gt; context_decl -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All2_fold P Œì Œì&#39; -&gt;
(<span class="kr">forall</span> (<span class="nv">Œì0</span> <span class="nv">Œì&#39;0</span> : <span class="kp">context</span>) (<span class="nv">d</span> <span class="nv">d&#39;</span> : context_decl),
 P Œì0 Œì&#39;0 d d&#39; -&gt; Q Œì0 Œì&#39;0 d d&#39;) -&gt; All2_fold Q Œì Œì&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkf3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P, Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kp">context</span> -&gt; context_decl -&gt; context_decl -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All2_fold P Œì Œì&#39; -&gt;
(<span class="kr">forall</span> (<span class="nv">Œì0</span> <span class="nv">Œì&#39;0</span> : <span class="kp">context</span>) (<span class="nv">d</span> <span class="nv">d&#39;</span> : context_decl),
 P Œì0 Œì&#39;0 d d&#39; -&gt; Q Œì0 Œì&#39;0 d d&#39;) -&gt; All2_fold Q Œì Œì&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">induction</span> <span class="mi">1</span>; <span class="nb">constructor</span>; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">All_over</span> {<span class="nv">A</span>} (<span class="nv">P</span> : <span class="kp">context</span> -&gt; <span class="kp">context</span> -&gt; A -&gt; A -&gt; <span class="kt">Type</span>) <span class="nv">Œì</span> <span class="nv">Œì&#39;</span> :=
    <span class="kr">fun</span> <span class="nv">Œî</span> <span class="nv">Œî&#39;</span> =&gt; P (Œì ,,, Œî) (Œì&#39; ,,, Œî&#39;).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkf4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">All2_fold_app_inv</span> :
    <span class="kr">forall</span> <span class="nv">P</span> (<span class="nv">Œì</span> <span class="nv">Œì&#39;</span> <span class="nv">Œìl</span> <span class="nv">Œìr</span> : <span class="kp">context</span>),
      All2_fold P Œì Œìl -&gt;
      All2_fold (All_over P Œì Œìl) Œì&#39; Œìr -&gt;
      All2_fold P (Œì ,,, Œì&#39;) (Œìl ,,, Œìr).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span>
  (<span class="nv">P</span> : <span class="kp">context</span> -&gt;
       <span class="kp">context</span> -&gt; context_decl -&gt; context_decl -&gt; <span class="kt">Type</span>)
  (<span class="nv">Œì</span> <span class="nv">Œì&#39;</span> <span class="nv">Œìl</span> <span class="nv">Œìr</span> : <span class="kp">context</span>),
All2_fold P Œì Œìl -&gt;
All2_fold (All_over P Œì Œìl) Œì&#39; Œìr -&gt;
All2_fold P (Œì,,, Œì&#39;) (Œìl,,, Œìr)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkf5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span>
  (<span class="nv">P</span> : <span class="kp">context</span> -&gt;
       <span class="kp">context</span> -&gt; context_decl -&gt; context_decl -&gt; <span class="kt">Type</span>)
  (<span class="nv">Œì</span> <span class="nv">Œì&#39;</span> <span class="nv">Œìl</span> <span class="nv">Œìr</span> : <span class="kp">context</span>),
All2_fold P Œì Œìl -&gt;
All2_fold (All_over P Œì Œìl) Œì&#39; Œìr -&gt;
All2_fold P (Œì,,, Œì&#39;) (Œìl,,, Œìr)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkf6"><span class="highlight"><span class="nb">induction</span> <span class="mi">2</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kp">context</span> -&gt; context_decl -&gt; context_decl -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì, Œìl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All2_fold P Œì Œìl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d, d'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì0, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All2_fold (All_over P Œì Œìl) Œì0 Œì&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All_over P Œì Œìl Œì0 Œì&#39; d d&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHX0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All2_fold P (Œì,,, Œì0) (Œìl,,, Œì&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All2_fold P (Œì,,, (d :: Œì0)) (Œìl,,, (d&#39; :: Œì&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkf7"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kp">context</span> -&gt; context_decl -&gt; context_decl -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì, Œìl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All2_fold P Œì Œìl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d, d'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì0, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All2_fold (All_over P Œì Œìl) Œì0 Œì&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All_over P Œì Œìl Œì0 Œì&#39; d d&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHX0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All2_fold P (Œì,,, Œì0) (Œìl,,, Œì&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All2_fold P (Œì,,, (d :: Œì0)) (Œìl,,, (d&#39; :: Œì&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Environment-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="Environment-v-chkf8"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span> -&gt;
<span class="kp">context</span> -&gt; context_decl -&gt; context_decl -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì, Œìl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All2_fold P Œì Œìl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d, d'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì0, Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">context</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All2_fold (All_over P Œì Œìl) Œì0 Œì&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All_over P Œì Œìl Œì0 Œì&#39; d d&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHX0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All2_fold P (Œì,,, Œì0) (Œìl,,, Œì&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All2_fold P (d :: Œì,,, Œì0) (d&#39; :: Œìl,,, Œì&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">constructor</span>; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">All2_fold_over</span> <span class="nv">P</span> <span class="nv">Œì</span> <span class="nv">Œì&#39;</span> := All2_fold (All_over P Œì Œì&#39;).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">on_decls</span> P := (<span class="kr">fun</span> <span class="nv">Œì</span> <span class="nv">Œì&#39;</span> =&gt; All_decls (P Œì Œì&#39;)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">on_contexts</span> P := (All2_fold (on_decls P)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">on_contexts_over</span> P Œì Œì&#39; := (All2_fold (All_over (on_decls P) Œì Œì&#39;)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Environment</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Module Type</span> <span class="nf">EnvironmentSig</span> (T : Term).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"> </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Include</span> Environment T.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">EnvironmentSig</span>.</span></span></span></pre></article></body></html>