<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>LiftSubst.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script><style type="text/css">pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #555753; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #cc0000 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #8f5902 } /* Keyword */
.highlight .l { color: #2e3436 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #000000 } /* Operator */
.highlight .x { color: #2e3436 } /* Other */
.highlight .p { color: #000000 } /* Punctuation */
.highlight .ch { color: #555753; font-weight: bold; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #555753; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #3465a4; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #555753; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #555753; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3465a4; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #a40000 } /* Generic.Error */
.highlight .gh { color: #a40000; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #4e9a06 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #000000; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #000000; font-style: italic } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #4e9a06; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #4e9a06; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87 } /* Keyword.Pseudo */
.highlight .kr { color: #8f5902 } /* Keyword.Reserved */
.highlight .kt { color: #204a87 } /* Keyword.Type */
.highlight .ld { color: #2e3436 } /* Literal.Date */
.highlight .m { color: #2e3436 } /* Literal.Number */
.highlight .s { color: #ad7fa8 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #75507b } /* Name.Builtin */
.highlight .nc { color: #204a87 } /* Name.Class */
.highlight .no { color: #ce5c00 } /* Name.Constant */
.highlight .nd { color: #3465a4; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #c4a000; text-decoration: underline } /* Name.Entity */
.highlight .ne { color: #cc0000 } /* Name.Exception */
.highlight .nf { color: #a40000 } /* Name.Function */
.highlight .nl { color: #3465a4; font-weight: bold } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #a40000 } /* Name.Tag */
.highlight .nv { color: #ce5c00 } /* Name.Variable */
.highlight .ow { color: #8f5902 } /* Operator.Word */
.highlight .w { color: #d3d7cf; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #2e3436 } /* Literal.Number.Bin */
.highlight .mf { color: #2e3436 } /* Literal.Number.Float */
.highlight .mh { color: #2e3436 } /* Literal.Number.Hex */
.highlight .mi { color: #2e3436 } /* Literal.Number.Integer */
.highlight .mo { color: #2e3436 } /* Literal.Number.Oct */
.highlight .sa { color: #ad7fa8 } /* Literal.String.Affix */
.highlight .sb { color: #ad7fa8 } /* Literal.String.Backtick */
.highlight .sc { color: #ad7fa8; font-weight: bold } /* Literal.String.Char */
.highlight .dl { color: #ad7fa8 } /* Literal.String.Delimiter */
.highlight .sd { color: #ad7fa8 } /* Literal.String.Doc */
.highlight .s2 { color: #ad7fa8 } /* Literal.String.Double */
.highlight .se { color: #ad7fa8; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #ad7fa8; text-decoration: underline } /* Literal.String.Heredoc */
.highlight .si { color: #ce5c00 } /* Literal.String.Interpol */
.highlight .sx { color: #ad7fa8 } /* Literal.String.Other */
.highlight .sr { color: #ad7fa8 } /* Literal.String.Regex */
.highlight .s1 { color: #ad7fa8 } /* Literal.String.Single */
.highlight .ss { color: #8f5902 } /* Literal.String.Symbol */
.highlight .bp { color: #5c35cc } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a40000 } /* Name.Function.Magic */
.highlight .vc { color: #ce5c00 } /* Name.Variable.Class */
.highlight .vg { color: #ce5c00; text-decoration: underline } /* Name.Variable.Global */
.highlight .vi { color: #ce5c00 } /* Name.Variable.Instance */
.highlight .vm { color: #ce5c00 } /* Name.Variable.Magic */
.highlight .il { color: #2e3436 } /* Literal.Number.Integer.Long */</style></head><body><article class="alectryon-root alectryon-centered alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.11.0+0.11.1. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight"><span class="c">(* Distributed under the terms of the MIT license. *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">From</span> MetaCoq.Template <span class="kn">Require Import</span> utils Ast AstUtils Environment Induction.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">From</span> Coq <span class="kn">Require Import</span> ssreflect.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">From</span> Equations <span class="kn">Require Import</span> Equations.</span></span></span></pre><div class="doc">
<a name="lab1"></a><h1 class="section">Lifting and substitution for the AST</h1>
<div class="paragraph"> </div>

  Along with standard commutation lemmas.
  Definition of <span class="inlinecode"><span class="id" title="var">closedn</span></span> (boolean) predicate for checking if
  a term is closed. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">up</span> := lift <span class="mi">1</span> <span class="mi">0</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Create HintDb</span> terms.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">arith_congr</span> := <span class="kp">repeat</span> (<span class="kp">try</span> <span class="bp">lia</span>; <span class="kp">progress</span> <span class="nb">f_equal</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">easy0</span> :=
  <span class="kr">let rec</span> <span class="nv">use_hyp</span> <span class="nv">H</span> :=
   (<span class="kr">match</span> <span class="kp">type of</span> H <span class="kr">with</span>
    | _ /\ _ =&gt; <span class="bp">exact</span> H || destruct_hyp H
    | _ * _ =&gt; <span class="bp">exact</span> H || destruct_hyp H
    | _ =&gt; <span class="kp">try</span> (<span class="kp">solve</span> [ <span class="nb">inversion</span> H ])
    <span class="kr">end</span>)
  <span class="kr">with</span> do_intro := (<span class="kr">let</span> <span class="nv">H</span> := <span class="kp">fresh</span> <span class="kr">in</span>
                    <span class="nb">intro</span> H; use_hyp H)
  <span class="kr">with</span> destruct_hyp H := (<span class="nb">case</span> H; <span class="nb">clear</span> H; do_intro; do_intro)
  <span class="kr">in</span>
  <span class="kr">let rec</span> <span class="nv">use_hyps</span> :=
   (<span class="kr">match goal with</span>
    | H:_ /\ _ |- _ =&gt; <span class="bp">exact</span> H || (destruct_hyp H; use_hyps)
    | H:_ * _ |- _ =&gt; <span class="bp">exact</span> H || (destruct_hyp H; use_hyps)
    | H:_ |- _ =&gt; <span class="kp">solve</span> [ <span class="nb">inversion</span> H ]
    | _ =&gt; <span class="kp">idtac</span>
    <span class="kr">end</span>)
  <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">do_atom</span> := (<span class="kp">solve</span> [ <span class="nb">trivial with</span> eq_true | <span class="bp">reflexivity</span> | <span class="nb">symmetry</span>; <span class="nb">trivial</span> | <span class="bp">contradiction</span> | <span class="bp">congruence</span>]) <span class="kr">in</span>
  <span class="kr">let rec</span> <span class="nv">do_ccl</span> := (<span class="kp">try</span> do_atom; <span class="kp">repeat</span> (do_intro; <span class="kp">try</span> do_atom); <span class="kp">try</span> arith_congr; (<span class="kp">solve</span> [ <span class="nb">split</span>; do_ccl ])) <span class="kr">in</span>
  (<span class="kp">solve</span> [ do_atom | use_hyps; do_ccl ]) || <span class="kp">fail</span> <span class="s2">&quot;Cannot solve this goal&quot;</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Extern</span> <span class="mi">10</span> (_ &lt; _)%nat =&gt; <span class="bp">lia</span> : terms.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Extern</span> <span class="mi">10</span> (_ &lt;= _)%nat =&gt; <span class="bp">lia</span> : terms.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Extern</span> <span class="mi">10</span> (@eq nat _ _) =&gt; <span class="bp">lia</span> : terms.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">easy</span> ::= easy0 || <span class="kp">solve</span> [<span class="nb">intuition</span> <span class="nb">eauto</span> <span class="mi">3</span> <span class="kr">with</span> core terms].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">subst_rec</span> N M k := (<span class="nb">subst</span> N k M) (<span class="kn">only parsing</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> PeanoNat.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Import</span> Nat.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lift_rel_ge</span> :
  <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">n</span> <span class="nv">p</span>, p &lt;= n -&gt; lift k p (tRel n) = tRel (k + n).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">n</span> <span class="nv">p</span> : nat,
p &lt;= n -&gt; lift k p (tRel n) = tRel (k + n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">n</span> <span class="nv">p</span> : nat,
p &lt;= n -&gt; lift k p (tRel n) = tRel (k + n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk2"><span class="highlight"><span class="nb">intros</span>; <span class="nb">simpl</span> <span class="kr">in</span> |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tRel (<span class="kr">if</span> p &lt;=? n <span class="kr">then</span> k + n <span class="kr">else</span> n) = tRel (k + n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">elim</span> (leb_spec p n).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lift_rel_lt</span> : <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">n</span> <span class="nv">p</span>, p &gt; n -&gt; lift k p (tRel n) = tRel n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">n</span> <span class="nv">p</span> : nat,
p &gt; n -&gt; lift k p (tRel n) = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">n</span> <span class="nv">p</span> : nat,
p &gt; n -&gt; lift k p (tRel n) = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk5"><span class="highlight"><span class="nb">intros</span>; <span class="nb">simpl</span> <span class="kr">in</span> |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &gt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tRel (<span class="kr">if</span> p &lt;=? n <span class="kr">then</span> k + n <span class="kr">else</span> n) = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">elim</span> (leb_spec p n).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_rel_lt</span> : <span class="kr">forall</span> <span class="nv">u</span> <span class="nv">n</span> <span class="nv">k</span>, k &gt; n -&gt; <span class="nb">subst</span> u k (tRel n) = tRel n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">u</span> : list term) (<span class="nv">n</span> <span class="nv">k</span> : nat),
k &gt; n -&gt; <span class="nb">subst</span> u k (tRel n) = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">u</span> : list term) (<span class="nv">n</span> <span class="nv">k</span> : nat),
k &gt; n -&gt; <span class="nb">subst</span> u k (tRel n) = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk8"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> |- *; <span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &gt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> k &lt;=? n
 <span class="kr">then</span>
  <span class="kr">match</span> nth_error u (n - k) <span class="kr">with</span>
  | Some b =&gt; lift0 k b
  | None =&gt; tRel (n - #|u|)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel n) = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">elim</span> (leb_spec k n); <span class="nb">intro</span> Hcomp; <span class="bp">easy</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_rel_gt</span> :
  <span class="kr">forall</span> <span class="nv">u</span> <span class="nv">n</span> <span class="nv">k</span>, n &gt;= k + length u -&gt; <span class="nb">subst</span> u k (tRel n) = tRel (n - length u).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">u</span> : list term) (<span class="nv">n</span> <span class="nv">k</span> : nat),
n &gt;= k + #|u| -&gt; <span class="nb">subst</span> u k (tRel n) = tRel (n - #|u|)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chka"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">u</span> : list term) (<span class="nv">n</span> <span class="nv">k</span> : nat),
n &gt;= k + #|u| -&gt; <span class="nb">subst</span> u k (tRel n) = tRel (n - #|u|)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkb"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> |- *; <span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> k &lt;=? n
 <span class="kr">then</span>
  <span class="kr">match</span> nth_error u (n - k) <span class="kr">with</span>
  | Some b =&gt; lift0 k b
  | None =&gt; tRel (n - #|u|)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel n) = tRel (n - #|u|)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkc"><span class="highlight"><span class="nb">elim</span> (leb_spec k n).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k &lt;= n -&gt;
<span class="kr">match</span> nth_error u (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - #|u|)
<span class="kr">end</span> = tRel (n - #|u|)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkd"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; k -&gt; tRel n = tRel (n - #|u|)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chke"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error u (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - #|u|)
<span class="kr">end</span> = tRel (n - #|u|)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkf"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; k -&gt; tRel n = tRel (n - #|u|)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk10"><span class="highlight"><span class="nb">destruct</span> nth_error <span class="nb">eqn</span>:Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u (n - k) = Some t0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 k t0 = tRel (n - #|u|)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk11" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u (n - k) = None</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk11"><hr></label><div class="goal-conclusion"><span class="highlight">tRel (n - #|u|) = tRel (n - #|u|)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk12" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk12"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; k -&gt; tRel n = tRel (n - #|u|)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk13"><span class="highlight"><span class="nb">assert</span> (n - k &lt; length u) <span class="bp">by</span> (<span class="nb">apply</span> nth_error_Some; <span class="bp">congruence</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u (n - k) = Some t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|u|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 k t0 = tRel (n - #|u|)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk14" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u (n - k) = None</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk14"><hr></label><div class="goal-conclusion"><span class="highlight">tRel (n - #|u|) = tRel (n - #|u|)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk15" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk15"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; k -&gt; tRel n = tRel (n - #|u|)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk16"><span class="highlight"><span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u (n - k) = None</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tRel (n - #|u|) = tRel (n - #|u|)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk17" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk17"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; k -&gt; tRel n = tRel (n - #|u|)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk18"><span class="highlight"><span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= k + #|u|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &lt; k -&gt; tRel n = tRel (n - #|u|)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk19"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_rel_eq</span> :
  <span class="kr">forall</span> (<span class="nv">u</span> : list term) <span class="nv">n</span> <span class="nv">i</span> <span class="nv">t</span> <span class="nv">p</span>,
    List.nth_error u i = Some t -&gt; p = n + i -&gt;
    <span class="nb">subst</span> u n (tRel p) = lift0 n t.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">u</span> : list term) (<span class="nv">n</span> <span class="nv">i</span> : nat) (<span class="nv">t0</span> : term)
  (<span class="nv">p</span> : nat),
nth_error u i = Some t0 -&gt;
p = n + i -&gt; <span class="nb">subst</span> u n (tRel p) = lift0 n t0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">u</span> : list term) (<span class="nv">n</span> <span class="nv">i</span> : nat) (<span class="nv">t0</span> : term)
  (<span class="nv">p</span> : nat),
nth_error u i = Some t0 -&gt;
p = n + i -&gt; <span class="nb">subst</span> u n (tRel p) = lift0 n t0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1b"><span class="highlight"><span class="nb">intros</span>; <span class="nb">simpl</span> <span class="kr">in</span> |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p = n + i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> n &lt;=? p
 <span class="kr">then</span>
  <span class="kr">match</span> nth_error u (p - n) <span class="kr">with</span>
  | Some b =&gt; lift0 n b
  | None =&gt; tRel (p - #|u|)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel p) = lift0 n t0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1c"><span class="highlight"><span class="nb">subst</span> p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> n &lt;=? n + i
 <span class="kr">then</span>
  <span class="kr">match</span> nth_error u (n + i - n) <span class="kr">with</span>
  | Some b =&gt; lift0 n b
  | None =&gt; tRel (n + i - #|u|)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel (n + i)) = lift0 n t0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1d"><span class="highlight"><span class="nb">elim</span> (leb_spec n (n + i)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &lt;= n + i -&gt;
<span class="kr">match</span> nth_error u (n + i - n) <span class="kr">with</span>
| Some b =&gt; lift0 n b
| None =&gt; tRel (n + i - #|u|)
<span class="kr">end</span> = lift0 n t0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk1e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk1e"><hr></label><div class="goal-conclusion"><span class="highlight">n + i &lt; n -&gt; tRel (n + i) = lift0 n t0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1f"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= n + i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error u (n + i - n) <span class="kr">with</span>
| Some b =&gt; lift0 n b
| None =&gt; tRel (n + i - #|u|)
<span class="kr">end</span> = lift0 n t0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk20" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk20"><hr></label><div class="goal-conclusion"><span class="highlight">n + i &lt; n -&gt; tRel (n + i) = lift0 n t0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk21"><span class="highlight"><span class="nb">assert</span> (n + i - n = i) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= n + i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n + i - n = i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error u (n + i - n) <span class="kr">with</span>
| Some b =&gt; lift0 n b
| None =&gt; tRel (n + i - #|u|)
<span class="kr">end</span> = lift0 n t0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk22" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk22"><hr></label><div class="goal-conclusion"><span class="highlight">n + i &lt; n -&gt; tRel (n + i) = lift0 n t0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk23"><span class="highlight"><span class="nb">rewrite</span> H1 H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= n + i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n + i - n = i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 n t0 = lift0 n t0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk24" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk24"><hr></label><div class="goal-conclusion"><span class="highlight">n + i &lt; n -&gt; tRel (n + i) = lift0 n t0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk25"><span class="highlight"><span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n + i &lt; n -&gt; tRel (n + i) = lift0 n t0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk26"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error u i = Some t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n + i &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tRel (n + i) = lift0 n t0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">change_Sk</span> :=
  <span class="kp">repeat</span> <span class="kr">match goal with</span>
    | |- <span class="kp">context</span> [S (<span class="nl">?x</span> + <span class="nl">?y</span>)] =&gt; <span class="kp">progress</span> <span class="nb">change</span> (S (x + y)) <span class="kr">with</span> (S x + y)
    | |- <span class="kp">context</span> [#|<span class="nl">?l</span>| + (<span class="nl">?x</span> + <span class="nl">?y</span>)] =&gt; <span class="kp">progress</span> <span class="nb">replace</span> (#|l| + (x + y)) <span class="kr">with</span> ((#|l| + x) + y) <span class="bp">by</span> <span class="bp">now</span> <span class="nb">rewrite</span> Nat.add_assoc
  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Extern</span> <span class="mi">10</span> =&gt; <span class="kp">progress</span> <span class="nb">unfold</span> map_branches_k : <span class="kp">all</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">solve_all_one</span> :=
  <span class="kp">try</span> <span class="kr">lazymatch goal with</span>
  | H: tCasePredProp _ _ _ |- _ =&gt; <span class="nb">destruct</span> H
  <span class="kr">end</span>;
  <span class="nb">unfold</span> tCaseBrsProp, tFixProp <span class="kr">in</span> *;
  <span class="kp">try</span> <span class="nb">apply</span> map_predicate_eq_spec;
  <span class="kp">try</span> <span class="nb">apply</span> map_predicate_id_spec;
  <span class="kp">repeat</span> toAll; <span class="kp">try</span> All_map; <span class="kp">try</span> close_Forall;
  change_Sk; <span class="nb">auto with</span> <span class="kp">all</span>;
  <span class="nb">intuition</span> <span class="nb">eauto</span> <span class="mi">4</span> <span class="kr">with</span> <span class="kp">all</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">solve_all</span> := <span class="kp">repeat</span> (<span class="kp">progress</span> solve_all_one).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Extern</span> <span class="mi">10</span> =&gt; <span class="nb">rewrite</span> !map_branch_map_branch : <span class="kp">all</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">nth_leb_simpl</span> :=
  <span class="kr">match goal with</span>
    |- <span class="kp">context</span> [leb <span class="nl">?k</span> <span class="nl">?n</span>] =&gt; <span class="nb">elim</span> (leb_spec_Set k n); <span class="kp">try</span> <span class="bp">lia</span>; <span class="nb">simpl</span>
  | |- <span class="kp">context</span> [nth_error <span class="nl">?l</span> <span class="nl">?n</span>] =&gt; <span class="nb">elim</span> (nth_error_spec l n); <span class="nb">rewrite</span> -&gt; <span class="nl">?app_length</span>, <span class="nl">?map_length</span>;
                                    <span class="kp">try</span> <span class="bp">lia</span>; <span class="nb">intros</span>; <span class="nb">simpl</span>
  | H : <span class="kp">context</span>[nth_error (<span class="nl">?l</span> ++ <span class="nl">?l&#39;</span>) <span class="nl">?n</span>] |- _ =&gt;
    (<span class="nb">rewrite</span> -&gt; (nth_error_app_ge l l&#39; n) <span class="kr">in</span> H <span class="bp">by</span> <span class="bp">lia</span>) ||
    (<span class="nb">rewrite</span> -&gt; (nth_error_app_lt l l&#39; n) <span class="kr">in</span> H <span class="bp">by</span> <span class="bp">lia</span>)
  | H : nth_error <span class="nl">?l</span> <span class="nl">?n</span> = Some _, H&#39; : nth_error <span class="nl">?l</span> <span class="nl">?n&#39;</span> = Some _ |- _ =&gt;
    <span class="nb">replace</span> n&#39; <span class="kr">with</span> n <span class="kr">in</span> H&#39; <span class="bp">by</span> <span class="bp">lia</span>; <span class="nb">rewrite</span> -&gt; H <span class="kr">in</span> H&#39;; <span class="nb">injection</span> H&#39;; <span class="nb">intros</span>; <span class="nb">subst</span>
  | _ =&gt; <span class="bp">lia</span> || <span class="bp">congruence</span> || <span class="kp">solve</span> [<span class="kp">repeat</span> (<span class="nb">f_equal</span>; <span class="kp">try</span> <span class="bp">lia</span>)]
  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk27"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lift0_id</span> : <span class="kr">forall</span> <span class="nv">M</span> <span class="nv">k</span>, lift <span class="mi">0</span> k M = M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">k</span> : nat), lift <span class="mi">0</span> k M = M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk28"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">k</span> : nat), lift <span class="mi">0</span> k M = M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk29"><span class="highlight"><span class="nb">intros</span> M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k</span> : nat, lift <span class="mi">0</span> k M = M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk2a"><span class="highlight"><span class="nb">elim</span> M <span class="nb">using</span> term_forall_list_ind; <span class="nb">simpl</span> <span class="kr">in</span> |- *; <span class="nb">intros</span>; <span class="kp">try</span> <span class="bp">easy</span> ;
    <span class="kp">try</span> (<span class="kp">try</span> <span class="nb">rewrite</span> H; <span class="kp">try</span> <span class="nb">rewrite</span> H0 ; <span class="kp">try</span> <span class="nb">rewrite</span> H1 ; <span class="bp">easy</span>);
    <span class="kp">try</span> (<span class="nb">f_equal</span>; <span class="nb">auto</span>; solve_all).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n <span class="kr">else</span> n) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">elim</span> (leb k n).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk2b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lift0_p</span> : <span class="kr">forall</span> <span class="nv">M</span>, lift0 <span class="mi">0</span> M = M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">M</span> : term, lift0 <span class="mi">0</span> M = M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk2c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">M</span> : term, lift0 <span class="mi">0</span> M = M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk2d"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> lift <span class="kr">in</span> |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fix</span> lift (n k : nat) (t : term) {<span class="kr">struct</span> t} : term :=
   <span class="kr">match</span> t <span class="kr">with</span>
   | tRel i =&gt; tRel (<span class="kr">if</span> k &lt;=? i <span class="kr">then</span> n + i <span class="kr">else</span> i)
   | tEvar ev args =&gt; tEvar ev (map (lift n k) args)
   | tCast c kind t0 =&gt;
       tCast (lift n k c) kind (lift n k t0)
   | tProd na A B =&gt;
       tProd na (lift n k A) (lift n (S k) B)
   | tLambda na T M0 =&gt;
       tLambda na (lift n k T) (lift n (S k) M0)
   | tLetIn na b t0 b&#39; =&gt;
       tLetIn na (lift n k b) (lift n k t0)
         (lift n (S k) b&#39;)
   | tApp u v =&gt; tApp (lift n k u) (map (lift n k) v)
   | tCase ind p c brs =&gt;
       tCase ind
         (map_predicate id (lift n k)
            (lift n (#|pcontext p| + k)) p)
         (lift n k c) (map_branches_k (lift n) k brs)
   | tProj p c =&gt; tProj p (lift n k c)
   | tFix mfix idx =&gt;
       tFix
         (map
            (map_def (lift n k) (lift n (#|mfix| + k)))
            mfix) idx
   | tCoFix mfix idx =&gt;
       tCoFix
         (map
            (map_def (lift n k) (lift n (#|mfix| + k)))
            mfix) idx
   | _ =&gt; t
   <span class="kr">end</span>) <span class="mi">0</span> <span class="mi">0</span> M = M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> lift0_id; <span class="bp">easy</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk2e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">simpl_lift</span> :
  <span class="kr">forall</span> <span class="nv">M</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">p</span> <span class="nv">i</span>,
    i &lt;= k + n -&gt;
    k &lt;= i -&gt; lift p i (lift n k M) = lift (p + n) k M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">n</span> <span class="nv">k</span> <span class="nv">p</span> <span class="nv">i</span> : nat),
i &lt;= k + n -&gt;
k &lt;= i -&gt; lift p i (lift n k M) = lift (p + n) k M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk2f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">n</span> <span class="nv">k</span> <span class="nv">p</span> <span class="nv">i</span> : nat),
i &lt;= k + n -&gt;
k &lt;= i -&gt; lift p i (lift n k M) = lift (p + n) k M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk30"><span class="highlight"><span class="nb">intros</span> M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">p</span> <span class="nv">i</span> : nat,
i &lt;= k + n -&gt;
k &lt;= i -&gt; lift p i (lift n k M) = lift (p + n) k M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk31"><span class="highlight"><span class="nb">elim</span> M <span class="nb">using</span> term_forall_list_ind;
    <span class="nb">intros</span>; <span class="nb">simpl</span>;
      <span class="nb">rewrite</span> -&gt; <span class="nl">?map_map_compose</span>, <span class="nl">?compose_on_snd</span>, <span class="nl">?compose_map_def</span>, <span class="nl">?map_length</span>;
      <span class="nb">rewrite</span> -&gt; <span class="nl">?map_predicate_map_predicate</span>;
      <span class="kp">try</span> (<span class="nb">rewrite</span> -&gt; H, <span class="nl">?H0</span>, <span class="nl">?H1</span>; <span class="nb">auto</span>); <span class="kp">try</span> (<span class="nb">f_equal</span>; <span class="nb">auto</span>; solve_all).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, n0, k, p, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt;= k + n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> i &lt;=? (<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n)
 <span class="kr">then</span> p + (<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n)
 <span class="kr">else</span> <span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n) =
(<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> p + n0 + n <span class="kr">else</span> n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk32"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, n0, k, p, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt;= k + n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> i &lt;=? (<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n)
 <span class="kr">then</span> p + (<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n)
 <span class="kr">else</span> <span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n) =
(<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> p + n0 + n <span class="kr">else</span> n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk33"><span class="highlight"><span class="nb">elim</span> (leb_spec k n); <span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, n0, k, p, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt;= k + n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> i &lt;=? n0 + n <span class="kr">then</span> p + (n0 + n) <span class="kr">else</span> n0 + n) =
p + n0 + n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk34" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, n0, k, p, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt;= k + n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; k</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk34"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> i &lt;=? n <span class="kr">then</span> p + n <span class="kr">else</span> n) = n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk35"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, n0, k, p, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt;= k + n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> i &lt;=? n0 + n <span class="kr">then</span> p + (n0 + n) <span class="kr">else</span> n0 + n) =
p + n0 + n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">elim</span> (leb_spec i (n0 + n)); <span class="nb">intros</span>; <span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk36"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, n0, k, p, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt;= k + n0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> i &lt;=? n <span class="kr">then</span> p + n <span class="kr">else</span> n) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">elim</span> (leb_spec i n); <span class="nb">intros</span>; <span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk37"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">simpl_lift0</span> : <span class="kr">forall</span> <span class="nv">M</span> <span class="nv">n</span>, lift0 (S n) M = lift0 <span class="mi">1</span> (lift0 n M).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">n</span> : nat),
lift0 (S n) M = lift0 <span class="mi">1</span> (lift0 n M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">intros</span>; <span class="nb">rewrite</span> simpl_lift.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk38"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_branches_k_map_branches_k</span>
      {<span class="nv">term</span> <span class="nv">term&#39;</span> <span class="nv">term&#39;&#39;</span>}
      (<span class="nv">f</span> : nat -&gt; term&#39; -&gt; term&#39;&#39;)
      (<span class="nv">g</span> : branch term -&gt; term -&gt; term&#39;)
      (<span class="nv">f&#39;</span> : term -&gt; term&#39;)
      (<span class="nv">l</span> : list (branch term)) <span class="nv">k</span> :
  map (<span class="kr">fun</span> <span class="nv">b</span> =&gt; map_branch (f (#|bcontext (map_branch (g b) b)| + k)) (map_branch f&#39; b)) l =
  map (<span class="kr">fun</span> <span class="nv">b</span> =&gt; map_branch (f (#|bcontext b| + k)) (map_branch f&#39; b)) l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">term, term', term''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term&#39; -&gt; term&#39;&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">branch term -&gt; term -&gt; term&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map
  (<span class="kr">fun</span> <span class="nv">b</span> : branch term =&gt;
   map_branch
     (f (#|bcontext (map_branch (g b) b)| + k))
     (map_branch f&#39; b)) l =
map
  (<span class="kr">fun</span> <span class="nv">b</span> : branch term =&gt;
   map_branch (f (#|bcontext b| + k))
     (map_branch f&#39; b)) l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk39"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">term, term', term''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term&#39; -&gt; term&#39;&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">branch term -&gt; term -&gt; term&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map
  (<span class="kr">fun</span> <span class="nv">b</span> : branch term =&gt;
   map_branch
     (f (#|bcontext (map_branch (g b) b)| + k))
     (map_branch f&#39; b)) l =
map
  (<span class="kr">fun</span> <span class="nv">b</span> : branch term =&gt;
   map_branch (f (#|bcontext b| + k))
     (map_branch f&#39; b)) l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk3a"><span class="highlight"><span class="nb">eapply</span> map_ext =&gt; b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">term, term', term''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term&#39; -&gt; term&#39;&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">branch term -&gt; term -&gt; term&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">branch term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_branch (f (#|bcontext (map_branch (g b) b)| + k))
  (map_branch f&#39; b) =
map_branch (f (#|bcontext b| + k)) (map_branch f&#39; b)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk3b"><span class="highlight"><span class="nb">rewrite</span> map_branch_map_branch.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">term, term', term''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; term&#39; -&gt; term&#39;&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">branch term -&gt; term -&gt; term&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">branch term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_branch
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   f (#|bcontext (map_branch (g b) b)| + k) (f&#39; x)) b =
map_branch
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   f (#|bcontext (map_branch (g b) b)| + k) (f&#39; x)) b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> map_branch_eq_spec.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk3c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">permute_lift</span> :
  <span class="kr">forall</span> <span class="nv">M</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">p</span> <span class="nv">i</span>,
    i &lt;= k -&gt;
    lift p i (lift n k M) = lift n (k + p) (lift p i M).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">n</span> <span class="nv">k</span> <span class="nv">p</span> <span class="nv">i</span> : nat),
i &lt;= k -&gt;
lift p i (lift n k M) = lift n (k + p) (lift p i M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk3d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">n</span> <span class="nv">k</span> <span class="nv">p</span> <span class="nv">i</span> : nat),
i &lt;= k -&gt;
lift p i (lift n k M) = lift n (k + p) (lift p i M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk3e"><span class="highlight"><span class="nb">intros</span> M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">p</span> <span class="nv">i</span> : nat,
i &lt;= k -&gt;
lift p i (lift n k M) = lift n (k + p) (lift p i M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">elim</span> M <span class="nb">using</span> term_forall_list_ind;
    <span class="nb">intros</span>; <span class="nb">simpl</span>; 
      <span class="nb">rewrite</span> -&gt; <span class="nl">?map_map_compose</span>, <span class="nl">?compose_on_snd</span>, <span class="nl">?compose_map_def</span>, <span class="nl">?map_length</span>,
      <span class="nl">?Nat</span>.add_assoc, <span class="nl">?map_predicate_map_predicate</span>, <span class="nl">?map_branches_map_branches</span>; <span class="nb">f_equal</span>;
      <span class="kp">try</span> <span class="kp">solve</span> [<span class="nb">auto</span>; solve_all]; <span class="kp">repeat</span> nth_leb_simpl.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk3f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">permute_lift0</span> :
  <span class="kr">forall</span> <span class="nv">M</span> <span class="nv">k</span>, lift0 <span class="mi">1</span> (lift <span class="mi">1</span> k M) = lift <span class="mi">1</span> (S k) (lift0 <span class="mi">1</span> M).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">k</span> : nat),
lift0 <span class="mi">1</span> (lift <span class="mi">1</span> k M) = lift <span class="mi">1</span> (S k) (lift0 <span class="mi">1</span> M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk40"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 <span class="mi">1</span> (lift <span class="mi">1</span> k M) = lift <span class="mi">1</span> (S k) (lift0 <span class="mi">1</span> M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk41"><span class="highlight"><span class="nb">change</span> (lift <span class="mi">1</span> <span class="mi">0</span> (lift <span class="mi">1</span> k M) = lift <span class="mi">1</span> (<span class="mi">1</span> + k) (lift <span class="mi">1</span> <span class="mi">0</span> M))
    <span class="kr">in</span> |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 <span class="mi">1</span> (lift <span class="mi">1</span> k M) = lift <span class="mi">1</span> (<span class="mi">1</span> + k) (lift0 <span class="mi">1</span> M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">rewrite</span> permute_lift; <span class="bp">easy</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk42"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lift_isApp</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">t</span> : isApp t = false -&gt; isApp (lift n k t) = false.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isApp t = false -&gt; isApp (lift n k t) = false</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk43"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isApp t = false -&gt; isApp (lift n k t) = false</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">induction</span> t; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk44"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_non_nil</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A -&gt; B) <span class="nv">l</span> : l &lt;&gt; nil -&gt; map f l &lt;&gt; nil.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l &lt;&gt; [] -&gt; map f l &lt;&gt; []</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk45"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l &lt;&gt; [] -&gt; map f l &lt;&gt; []</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk46"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map f l &lt;&gt; []</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk47"><span class="highlight"><span class="nb">intro</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">map f l = []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk48"><span class="highlight"><span class="nb">destruct</span> l; <span class="kp">try</span> <span class="bp">discriminate</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">[] &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">map f [] = []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">contradiction</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk49"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">isLambda_lift</span> <span class="nv">n</span> <span class="nv">k</span> (<span class="nv">bod</span> : term) :
  isLambda bod = true -&gt; isLambda (lift n k bod) = true.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bod</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isLambda bod = true -&gt; isLambda (lift n k bod) = true</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk4a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bod</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isLambda bod = true -&gt; isLambda (lift n k bod) = true</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> bod; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">congruence</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Resolve</span> lift_isApp map_non_nil isLambda_lift : <span class="kp">all</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk4b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">wf_lift</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">t</span> : <span class="kn">wf</span> t -&gt; <span class="kn">wf</span> (lift n k t).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> t -&gt; <span class="kn">wf</span> (lift n k t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk4c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> t -&gt; <span class="kn">wf</span> (lift n k t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk4d"><span class="highlight"><span class="nb">intros</span> wft; <span class="nb">revert</span> t wft k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">t0</span> : term,
<span class="kn">wf</span> t0 -&gt; <span class="kr">forall</span> <span class="nv">k</span> : nat, <span class="kn">wf</span> (lift n k t0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> (term_wf_forall_list_ind (<span class="kr">fun</span> <span class="nv">t</span> =&gt; <span class="kr">forall</span> <span class="nv">k</span>, <span class="kn">wf</span> (lift n k t)));
    <span class="nb">intros</span>; <span class="kp">try</span> <span class="nb">constructor</span>; <span class="nb">simpl</span>; <span class="nb">auto</span>; solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk4e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mkApps_tApp</span> <span class="nv">t</span> <span class="nv">l</span> :
  isApp t = false -&gt; l &lt;&gt; nil -&gt; mkApps t l = tApp t l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isApp t = false -&gt; l &lt;&gt; [] -&gt; mkApps t l = tApp t l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk4f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isApp t = false -&gt; l &lt;&gt; [] -&gt; mkApps t l = tApp t l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk50"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps t l = tApp t l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk51"><span class="highlight"><span class="nb">destruct</span> l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">[] &lt;&gt; []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps t [] = tApp t []</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk52" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t0 :: l &lt;&gt; []</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk52"><hr></label><div class="goal-conclusion"><span class="highlight">mkApps t (t0 :: l) = tApp t (t0 :: l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk53"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">[] &lt;&gt; []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t = tApp t []</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk54" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t0 :: l &lt;&gt; []</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk54"><hr></label><div class="goal-conclusion"><span class="highlight">mkApps t (t0 :: l) = tApp t (t0 :: l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk55"><span class="highlight"><span class="bp">contradiction</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t0 :: l &lt;&gt; []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps t (t0 :: l) = tApp t (t0 :: l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk56"><span class="highlight"><span class="nb">destruct</span> t; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">args</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp (tApp t1 args) = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t0 :: l &lt;&gt; []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tApp t1 (args ++ t0 :: l) =
tApp (tApp t1 args) (t0 :: l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk57"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">args</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">true = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t0 :: l &lt;&gt; []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tApp t1 (args ++ t0 :: l) =
tApp (tApp t1 args) (t0 :: l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">discriminate</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk58"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">simpl_subst_rec</span> :
  <span class="kr">forall</span> <span class="nv">M</span> (<span class="nv">H</span> : wf M) <span class="nv">N</span> <span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span>,
    p &lt;= n + k -&gt;
    k &lt;= p -&gt; <span class="nb">subst</span> N p (lift (List.length N + n) k M) = lift n k M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">M</span> : term,
<span class="kn">wf</span> M -&gt;
<span class="kr">forall</span> (<span class="nv">N</span> : list term) (<span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span> : nat),
p &lt;= n + k -&gt;
k &lt;= p -&gt; <span class="nb">subst</span> N p (lift (#|N| + n) k M) = lift n k M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk59"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">M</span> : term,
<span class="kn">wf</span> M -&gt;
<span class="kr">forall</span> (<span class="nv">N</span> : list term) (<span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span> : nat),
p &lt;= n + k -&gt;
k &lt;= p -&gt; <span class="nb">subst</span> N p (lift (#|N| + n) k M) = lift n k M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk5a"><span class="highlight"><span class="nb">intros</span> M wfM.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> M</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N</span> : list term) (<span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span> : nat),
p &lt;= n + k -&gt;
k &lt;= p -&gt; <span class="nb">subst</span> N p (lift (#|N| + n) k M) = lift n k M</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk5b"><span class="highlight"><span class="nb">induction</span> wfM <span class="nb">using</span> term_wf_forall_list_ind;
    <span class="nb">intros</span>; <span class="nb">simpl</span>;
      <span class="nb">rewrite</span> -&gt; <span class="nl">?map_map_compose</span>, <span class="nl">?compose_on_snd</span>, <span class="nl">?compose_map_def</span>, <span class="nl">?map_length</span>,
                 <span class="nl">?map_predicate_map_predicate</span>;
      <span class="kp">try</span> <span class="kp">solve</span> [<span class="nb">f_equal</span>; <span class="nb">auto</span>; solve_all]; <span class="kp">repeat</span> nth_leb_simpl.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   p0 &lt;= n0 + k0 -&gt;
   k0 &lt;= p0 -&gt;
   <span class="nb">subst</span> N0 p0 (lift (#|N0| + n0) k0 M) =
   lift n0 k0 M) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
p0 &lt;= n0 + k0 -&gt;
k0 &lt;= p0 -&gt;
<span class="nb">subst</span> N0 p0 (lift (#|N0| + n0) k0 t0) =
lift n0 k0 t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (<span class="nb">subst</span> N p (lift (#|N| + n) k t0))
  (map
     (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> N p (lift (#|N| + n) k x))
     l) = tApp (lift n k t0) (map (lift n k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk5c"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   p0 &lt;= n0 + k0 -&gt;
   k0 &lt;= p0 -&gt;
   <span class="nb">subst</span> N0 p0 (lift (#|N0| + n0) k0 M) =
   lift n0 k0 M) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
p0 &lt;= n0 + k0 -&gt;
k0 &lt;= p0 -&gt;
<span class="nb">subst</span> N0 p0 (lift (#|N0| + n0) k0 t0) =
lift n0 k0 t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (<span class="nb">subst</span> N p (lift (#|N| + n) k t0))
  (map
     (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> N p (lift (#|N| + n) k x))
     l) = tApp (lift n k t0) (map (lift n k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk5d"><span class="highlight"><span class="nb">rewrite</span> IHwfM; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   p0 &lt;= n0 + k0 -&gt;
   k0 &lt;= p0 -&gt;
   <span class="nb">subst</span> N0 p0 (lift (#|N0| + n0) k0 M) =
   lift n0 k0 M) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
p0 &lt;= n0 + k0 -&gt;
k0 &lt;= p0 -&gt;
<span class="nb">subst</span> N0 p0 (lift (#|N0| + n0) k0 t0) =
lift n0 k0 t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (lift n k t0)
  (map
     (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> N p (lift (#|N| + n) k x))
     l) = tApp (lift n k t0) (map (lift n k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk5e"><span class="highlight"><span class="nb">apply</span> (lift_isApp n k) <span class="kr">in</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp (lift n k t0) = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   p0 &lt;= n0 + k0 -&gt;
   k0 &lt;= p0 -&gt;
   <span class="nb">subst</span> N0 p0 (lift (#|N0| + n0) k0 M) =
   lift n0 k0 M) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
p0 &lt;= n0 + k0 -&gt;
k0 &lt;= p0 -&gt;
<span class="nb">subst</span> N0 p0 (lift (#|N0| + n0) k0 t0) =
lift n0 k0 t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (lift n k t0)
  (map
     (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> N p (lift (#|N| + n) k x))
     l) = tApp (lift n k t0) (map (lift n k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk5f"><span class="highlight"><span class="nb">rewrite</span> mkApps_tApp; <span class="nb">auto using</span> map_non_nil.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp (lift n k t0) = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   p0 &lt;= n0 + k0 -&gt;
   k0 &lt;= p0 -&gt;
   <span class="nb">subst</span> N0 p0 (lift (#|N0| + n0) k0 M) =
   lift n0 k0 M) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
p0 &lt;= n0 + k0 -&gt;
k0 &lt;= p0 -&gt;
<span class="nb">subst</span> N0 p0 (lift (#|N0| + n0) k0 t0) =
lift n0 k0 t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tApp (lift n k t0)
  (map
     (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> N p (lift (#|N| + n) k x))
     l) = tApp (lift n k t0) (map (lift n k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>; solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk60"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">simpl_subst</span> :
  <span class="kr">forall</span> <span class="nv">N</span> <span class="nv">M</span> (<span class="nv">H</span> : wf M) <span class="nv">n</span> <span class="nv">p</span>, p &lt;= n -&gt; <span class="nb">subst</span> N p (lift0 (length N + n) M) = lift0 n M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N</span> : list term) (<span class="nv">M</span> : term),
<span class="kn">wf</span> M -&gt;
<span class="kr">forall</span> <span class="nv">n</span> <span class="nv">p</span> : nat,
p &lt;= n -&gt; <span class="nb">subst</span> N p (lift0 (#|N| + n) M) = lift0 n M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk61"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N</span> : list term) (<span class="nv">M</span> : term),
<span class="kn">wf</span> M -&gt;
<span class="kr">forall</span> <span class="nv">n</span> <span class="nv">p</span> : nat,
p &lt;= n -&gt; <span class="nb">subst</span> N p (lift0 (#|N| + n) M) = lift0 n M</span></div></blockquote></div></div></small><span class="alectryon-wsp">  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk62"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> M</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> N p (lift0 (#|N| + n) M) = lift0 n M</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk63"><span class="highlight"><span class="nb">rewrite</span> simpl_subst_rec; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> M</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p &lt;= n + <span class="mi">0</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk64" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> M</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk64"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk65"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Nat.add_0_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> M</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk66"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mkApps_tRel</span> <span class="nv">n</span> <span class="nv">a</span> <span class="nv">l</span> : mkApps (tRel n) (a :: l) = tApp (tRel n) (a :: l).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (tRel n) (a :: l) = tApp (tRel n) (a :: l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk67"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (tRel n) (a :: l) = tApp (tRel n) (a :: l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk68"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tApp (tRel n) (a :: l) = tApp (tRel n) (a :: l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk69"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lift_mkApps</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">t</span> <span class="nv">l</span> : lift n k (mkApps t l) = mkApps (lift n k t) (map (lift n k) l).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n k (mkApps t l) =
mkApps (lift n k t) (map (lift n k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk6a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n k (mkApps t l) =
mkApps (lift n k t) (map (lift n k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk6b"><span class="highlight"><span class="nb">revert</span> n k t; <span class="nb">induction</span> l; <span class="nb">intros</span> n k t; <span class="nb">destruct</span> t; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> <span class="nv">k0</span> : nat) (<span class="nv">t1</span> : term),
lift n0 k0 (mkApps t1 l) = mkApps (lift n0 k0 t1) (map (lift n0 k0) l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">args</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n k (mkApps (tApp t0 args) (a :: l)) =
mkApps (lift n k (tApp t0 args))
  (map (lift n k) (a :: l))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk6c"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> <span class="nv">k0</span> : nat) (<span class="nv">t1</span> : term),
lift n0 k0 (mkApps t1 l) =
mkApps (lift n0 k0 t1) (map (lift n0 k0) l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">args</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tApp (lift n k t0) (map (lift n k) (args ++ a :: l)) =
tApp (lift n k t0)
  (map (lift n k) args ++
   lift n k a :: map (lift n k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk6d"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> <span class="nv">k0</span> : nat) (<span class="nv">t1</span> : term),
lift n0 k0 (mkApps t1 l) =
mkApps (lift n0 k0 t1) (map (lift n0 k0) l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">args</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map (lift n k) (args ++ a :: l) =
map (lift n k) args ++ lift n k a :: map (lift n k) l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> map_app.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk6e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">commut_lift_subst_rec</span> :
  <span class="kr">forall</span> <span class="nv">M</span> <span class="nv">N</span> <span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span>,
    k &lt;= p -&gt;
    lift n k (<span class="nb">subst</span> N p M) = <span class="nb">subst</span> N (p + n) (lift n k M).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">N</span> : list term) (<span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span> : nat),
k &lt;= p -&gt;
lift n k (<span class="nb">subst</span> N p M) = <span class="nb">subst</span> N (p + n) (lift n k M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk6f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">N</span> : list term) (<span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span> : nat),
k &lt;= p -&gt;
lift n k (<span class="nb">subst</span> N p M) = <span class="nb">subst</span> N (p + n) (lift n k M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk70"><span class="highlight"><span class="nb">intros</span> M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N</span> : list term) (<span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span> : nat),
k &lt;= p -&gt;
lift n k (<span class="nb">subst</span> N p M) = <span class="nb">subst</span> N (p + n) (lift n k M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk71"><span class="highlight"><span class="nb">elim</span> M <span class="nb">using</span> term_forall_list_ind;
    <span class="nb">intros</span>; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">easy</span>;
      <span class="nb">rewrite</span> -&gt; <span class="nl">?map_map_compose</span>, <span class="nl">?compose_on_snd</span>, <span class="nl">?compose_map_def</span>, <span class="nl">?map_length</span>, <span class="nl">?Nat</span>.add_assoc,
                 <span class="nl">?map_predicate_map_predicate</span>;
      <span class="kp">try</span> <span class="kp">solve</span> [<span class="nb">f_equal</span>; <span class="nb">auto</span>; solve_all].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n0 k
  (<span class="kr">if</span> p &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error N (n - p) <span class="kr">with</span>
    | Some b =&gt; lift0 p b
    | None =&gt; tRel (n - #|N|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n) =
(<span class="kr">if</span> p + n0 &lt;=? (<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n)
 <span class="kr">then</span>
  <span class="kr">match</span>
    nth_error N
      ((<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n) - (p + n0))
  <span class="kr">with</span>
  | Some b =&gt; lift0 (p + n0) b
  | None =&gt;
      tRel ((<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n) - #|N|)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel (<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk72" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
k0 &lt;= p0 -&gt;
lift n0 k0 (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   k0 &lt;= p0 -&gt;
   lift n0 k0 (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk72"><hr></label><div class="goal-conclusion"><span class="highlight">lift n k (mkApps (<span class="nb">subst</span> N p t0) (map (<span class="nb">subst</span> N p) l)) =
mkApps (<span class="nb">subst</span> N (p + n) (lift n k t0))
  (map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> N (p + n) (lift n k x))
     l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk73"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n0 k
  (<span class="kr">if</span> p &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error N (n - p) <span class="kr">with</span>
    | Some b =&gt; lift0 p b
    | None =&gt; tRel (n - #|N|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n) =
(<span class="kr">if</span> p + n0 &lt;=? (<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n)
 <span class="kr">then</span>
  <span class="kr">match</span>
    nth_error N
      ((<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n) - (p + n0))
  <span class="kr">with</span>
  | Some b =&gt; lift0 (p + n0) b
  | None =&gt;
      tRel ((<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n) - #|N|)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel (<span class="kr">if</span> k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk74"><span class="highlight"><span class="kp">repeat</span> nth_leb_simpl.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Some x0 = Some x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + n0 &lt;= n0 + n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n0 + n - (p + n0) &lt; #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n0 k (lift0 p x0) = lift0 (p + n0) x0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk75"><span class="highlight"><span class="nb">rewrite</span> -&gt; simpl_lift <span class="bp">by</span> <span class="bp">easy</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Some x0 = Some x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + n0 &lt;= n0 + n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n0 + n - (p + n0) &lt; #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 (n0 + p) x0 = lift0 (p + n0) x0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>; <span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk76"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
k0 &lt;= p0 -&gt;
lift n0 k0 (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   k0 &lt;= p0 -&gt;
   lift n0 k0 (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n k (mkApps (<span class="nb">subst</span> N p t0) (map (<span class="nb">subst</span> N p) l)) =
mkApps (<span class="nb">subst</span> N (p + n) (lift n k t0))
  (map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> N (p + n) (lift n k x))
     l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk77"><span class="highlight"><span class="nb">rewrite</span> lift_mkApps.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
k0 &lt;= p0 -&gt;
lift n0 k0 (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   k0 &lt;= p0 -&gt;
   lift n0 k0 (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (lift n k (<span class="nb">subst</span> N p t0))
  (map (lift n k) (map (<span class="nb">subst</span> N p) l)) =
mkApps (<span class="nb">subst</span> N (p + n) (lift n k t0))
  (map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> N (p + n) (lift n k x))
     l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk78"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
k0 &lt;= p0 -&gt;
lift n0 k0 (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   k0 &lt;= p0 -&gt;
   lift n0 k0 (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n k (<span class="nb">subst</span> N p t0) =
<span class="nb">subst</span> N (p + n) (lift n k t0)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk79" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
k0 &lt;= p0 -&gt;
lift n0 k0 (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   k0 &lt;= p0 -&gt;
   lift n0 k0 (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk79"><hr></label><div class="goal-conclusion"><span class="highlight">map (lift n k) (map (<span class="nb">subst</span> N p) l) =
map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> N (p + n) (lift n k x)) l</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk7a"><span class="highlight"><span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
k0 &lt;= p0 -&gt;
lift n0 k0 (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   k0 &lt;= p0 -&gt;
   lift n0 k0 (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map (lift n k) (map (<span class="nb">subst</span> N p) l) =
map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> N (p + n) (lift n k x)) l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk7b"><span class="highlight"><span class="nb">rewrite</span> map_map_compose.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
k0 &lt;= p0 -&gt;
lift n0 k0 (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   k0 &lt;= p0 -&gt;
   lift n0 k0 (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> N0 (p0 + n0) (lift n0 k0 M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; lift n k (<span class="nb">subst</span> N p x)) l =
map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> N (p + n) (lift n k x)) l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk7c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">commut_lift_subst</span> :
  <span class="kr">forall</span> <span class="nv">M</span> <span class="nv">N</span> <span class="nv">k</span>, <span class="nb">subst</span> N (S k) (lift0 <span class="mi">1</span> M) = lift0 <span class="mi">1</span> (<span class="nb">subst</span> N k M).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">N</span> : list term) (<span class="nv">k</span> : nat),
<span class="nb">subst</span> N (S k) (lift0 <span class="mi">1</span> M) = lift0 <span class="mi">1</span> (<span class="nb">subst</span> N k M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">intros</span>; <span class="nb">rewrite</span> commut_lift_subst_rec.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk7d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">distr_lift_subst_rec</span> :
  <span class="kr">forall</span> <span class="nv">M</span> <span class="nv">N</span> <span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span>,
    lift n (p + k) (<span class="nb">subst</span> N p M) =
    <span class="nb">subst</span> (List.map (lift n k) N) p (lift n (p + length N + k) M).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">N</span> : list term) (<span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span> : nat),
lift n (p + k) (<span class="nb">subst</span> N p M) =
<span class="nb">subst</span> (map (lift n k) N) p (lift n (p + #|N| + k) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk7e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">N</span> : list term) (<span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span> : nat),
lift n (p + k) (<span class="nb">subst</span> N p M) =
<span class="nb">subst</span> (map (lift n k) N) p (lift n (p + #|N| + k) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk7f"><span class="highlight"><span class="nb">intros</span> M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N</span> : list term) (<span class="nv">n</span> <span class="nv">p</span> <span class="nv">k</span> : nat),
lift n (p + k) (<span class="nb">subst</span> N p M) =
<span class="nb">subst</span> (map (lift n k) N) p (lift n (p + #|N| + k) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk80"><span class="highlight"><span class="nb">elim</span> M <span class="nb">using</span> term_forall_list_ind;
    <span class="nb">intros</span>; <span class="kr">match goal with</span>
              |- <span class="kp">context</span> [tRel _] =&gt; <span class="kp">idtac</span>
            | |- _ =&gt; <span class="nb">cbn</span> -[plus]
            <span class="kr">end</span>; <span class="kp">try</span> <span class="bp">easy</span>;
      <span class="nb">rewrite</span> -&gt; <span class="nl">?map_map_compose</span>, <span class="nl">?compose_on_snd</span>, <span class="nl">?compose_map_def</span>, <span class="nl">?map_length</span>, <span class="nl">?Nat</span>.add_assoc,
                 <span class="nl">?map_predicate_map_predicate</span>;
      <span class="kp">try</span> <span class="kp">solve</span> [<span class="nb">f_equal</span>; <span class="nb">auto</span>; solve_all].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n0 (p + k) (<span class="nb">subst</span> N p (tRel n)) =
<span class="nb">subst</span> (map (lift n0 k) N) p
  (lift n0 (p + #|N| + k) (tRel n))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk81" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
lift n0 (p0 + k0) (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> (map (lift n0 k0) N0) p0
  (lift n0 (p0 + #|N0| + k0) t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   lift n0 (p0 + k0) (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> (map (lift n0 k0) N0) p0
     (lift n0 (p0 + #|N0| + k0) M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk81"><hr></label><div class="goal-conclusion"><span class="highlight">lift n (p + k)
  (mkApps (<span class="nb">subst</span> N p t0) (map (<span class="nb">subst</span> N p) l)) =
mkApps
  (<span class="nb">subst</span> (map (lift n k) N) p
     (lift n (p + #|N| + k) t0))
  (map
     (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
      <span class="nb">subst</span> (map (lift n k) N) p
        (lift n (p + #|N| + k) x)) l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk82"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n0 (p + k) (<span class="nb">subst</span> N p (tRel n)) =
<span class="nb">subst</span> (map (lift n0 k) N) p
  (lift n0 (p + #|N| + k) (tRel n))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk83"><span class="highlight"><span class="nb">unfold</span> <span class="nb">subst</span> <span class="nb">at</span> <span class="mi">1</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n0 (p + k)
  (<span class="kr">if</span> p &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error N (n - p) <span class="kr">with</span>
    | Some b =&gt; lift0 p b
    | None =&gt; tRel (n - #|N|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n) =
<span class="nb">subst</span> (map (lift n0 k) N) p
  (lift n0 (p + #|N| + k) (tRel n))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk84"><span class="highlight"><span class="nb">unfold</span> lift <span class="nb">at</span> <span class="mi">4</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n0 (p + k)
  (<span class="kr">if</span> p &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error N (n - p) <span class="kr">with</span>
    | Some b =&gt; lift0 p b
    | None =&gt; tRel (n - #|N|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n) =
<span class="nb">subst</span> (map (lift n0 k) N) p
  (tRel (<span class="kr">if</span> p + #|N| + k &lt;=? n <span class="kr">then</span> n0 + n <span class="kr">else</span> n))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk85"><span class="highlight"><span class="kp">repeat</span> nth_leb_simpl.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0, p1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (map (lift n0 k) N) (n - p) = Some x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n0 (p + k) (lift0 p x) = lift0 p x0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk86"><span class="highlight"><span class="nb">rewrite</span> nth_error_map <span class="kr">in</span> e0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0, p1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option_map (lift n0 k) (nth_error N (n - p)) =
Some x0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n0 (p + k) (lift0 p x) = lift0 p x0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk87"><span class="highlight"><span class="nb">rewrite</span> e <span class="kr">in</span> e0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0, p1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option_map (lift n0 k) (Some x) = Some x0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n0 (p + k) (lift0 p x) = lift0 p x0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk88"><span class="highlight"><span class="nb">revert</span> e0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0, p1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">option_map (lift n0 k) (Some x) = Some x0 -&gt;
lift n0 (p + k) (lift0 p x) = lift0 p x0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk89"><span class="highlight"><span class="nb">intros</span> [= &lt;-].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0, p1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n0 (p + k) (lift0 p x) = lift0 p (lift n0 k x)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> (permute_lift x n0 k p <span class="mi">0</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk8a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
lift n0 (p0 + k0) (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> (map (lift n0 k0) N0) p0
  (lift n0 (p0 + #|N0| + k0) t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   lift n0 (p0 + k0) (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> (map (lift n0 k0) N0) p0
     (lift n0 (p0 + #|N0| + k0) M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n (p + k)
  (mkApps (<span class="nb">subst</span> N p t0) (map (<span class="nb">subst</span> N p) l)) =
mkApps
  (<span class="nb">subst</span> (map (lift n k) N) p
     (lift n (p + #|N| + k) t0))
  (map
     (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
      <span class="nb">subst</span> (map (lift n k) N) p
        (lift n (p + #|N| + k) x)) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk8b"><span class="highlight"><span class="nb">rewrite</span> lift_mkApps.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
lift n0 (p0 + k0) (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> (map (lift n0 k0) N0) p0
  (lift n0 (p0 + #|N0| + k0) t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   lift n0 (p0 + k0) (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> (map (lift n0 k0) N0) p0
     (lift n0 (p0 + #|N0| + k0) M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (lift n (p + k) (<span class="nb">subst</span> N p t0))
  (map (lift n (p + k)) (map (<span class="nb">subst</span> N p) l)) =
mkApps
  (<span class="nb">subst</span> (map (lift n k) N) p
     (lift n (p + #|N| + k) t0))
  (map
     (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
      <span class="nb">subst</span> (map (lift n k) N) p
        (lift n (p + #|N| + k) x)) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk8c"><span class="highlight"><span class="nb">f_equal</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
lift n0 (p0 + k0) (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> (map (lift n0 k0) N0) p0
  (lift n0 (p0 + #|N0| + k0) t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> (<span class="nv">N0</span> : list term) (<span class="nv">n0</span> <span class="nv">p0</span> <span class="nv">k0</span> : nat),
   lift n0 (p0 + k0) (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> (map (lift n0 k0) N0) p0
     (lift n0 (p0 + #|N0| + k0) M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map (lift n (p + k)) (map (<span class="nb">subst</span> N p) l) =
map
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="nb">subst</span> (map (lift n k) N) p
     (lift n (p + #|N| + k) x)) l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">rewrite</span> map_map_compose; solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk8d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">distr_lift_subst</span> :
  <span class="kr">forall</span> <span class="nv">M</span> <span class="nv">N</span> <span class="nv">n</span> <span class="nv">k</span>,
    lift n k (subst0 N M) = subst0 (map (lift n k) N) (lift n (length N + k) M).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">N</span> : list term) (<span class="nv">n</span> <span class="nv">k</span> : nat),
lift n k (subst0 N M) =
subst0 (map (lift n k) N) (lift n (#|N| + k) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk8e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">N</span> : list term) (<span class="nv">n</span> <span class="nv">k</span> : nat),
lift n k (subst0 N M) =
subst0 (map (lift n k) N) (lift n (#|N| + k) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk8f"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n k (subst0 N M) =
subst0 (map (lift n k) N) (lift n (#|N| + k) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk90"><span class="highlight"><span class="nb">pattern</span> k <span class="nb">at</span> <span class="mi">1</span> <span class="mi">3</span> <span class="kr">in</span> |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">n0</span> : nat =&gt;
 lift n n0 (subst0 N M) =
 subst0 (map (lift n k) N) (lift n (#|N| + n0) M)) k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk91"><span class="highlight"><span class="nb">replace</span> k <span class="kr">with</span> (<span class="mi">0</span> + k); <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n (<span class="mi">0</span> + k) (subst0 N M) =
subst0 (map (lift n k) N) (lift n (#|N| + (<span class="mi">0</span> + k)) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> distr_lift_subst_rec.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk92"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">distr_lift_subst10</span> :
  <span class="kr">forall</span> <span class="nv">M</span> <span class="nv">N</span> <span class="nv">n</span> <span class="nv">k</span>,
    lift n k (subst10 N M) = subst10 (lift n k N) (lift n (S k) M).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> <span class="nv">N</span> : term) (<span class="nv">n</span> <span class="nv">k</span> : nat),
lift n k (M {<span class="mi">0</span> := N}) =
(lift n (S k) M) {<span class="mi">0</span> := lift n k N}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk93"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> <span class="nv">N</span> : term) (<span class="nv">n</span> <span class="nv">k</span> : nat),
lift n k (M {<span class="mi">0</span> := N}) =
(lift n (S k) M) {<span class="mi">0</span> := lift n k N}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk94"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> <span class="nb">subst</span> <span class="kr">in</span> |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n k (M {<span class="mi">0</span> := N}) =
(lift n (S k) M) {<span class="mi">0</span> := lift n k N}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk95"><span class="highlight"><span class="nb">pattern</span> k <span class="nb">at</span> <span class="mi">1</span> <span class="mi">3</span> <span class="kr">in</span> |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">n0</span> : nat =&gt;
 lift n n0 (M {<span class="mi">0</span> := N}) =
 (lift n (S n0) M) {<span class="mi">0</span> := lift n k N}) k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk96"><span class="highlight"><span class="nb">replace</span> k <span class="kr">with</span> (<span class="mi">0</span> + k); <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n (<span class="mi">0</span> + k) (M {<span class="mi">0</span> := N}) =
(lift n (S (<span class="mi">0</span> + k)) M) {<span class="mi">0</span> := lift n k N}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> distr_lift_subst_rec.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk97"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_mkApps</span> <span class="nv">u</span> <span class="nv">k</span> <span class="nv">t</span> <span class="nv">l</span> :
  <span class="nb">subst</span> u k (mkApps t l) = mkApps (<span class="nb">subst</span> u k t) (map (<span class="nb">subst</span> u k) l).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> u k (mkApps t l) =
mkApps (<span class="nb">subst</span> u k t) (map (<span class="nb">subst</span> u k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk98"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> u k (mkApps t l) =
mkApps (<span class="nb">subst</span> u k t) (map (<span class="nb">subst</span> u k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk99"><span class="highlight"><span class="nb">revert</span> u k t; <span class="nb">induction</span> l; <span class="nb">intros</span> u k t; <span class="nb">destruct</span> t; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">u0</span> : list term) (<span class="nv">k0</span> : nat) (<span class="nv">t1</span> : term),
<span class="nb">subst</span> u0 k0 (mkApps t1 l) = mkApps (<span class="nb">subst</span> u0 k0 t1) (map (<span class="nb">subst</span> u0 k0) l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">args</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> u k (mkApps (tApp t0 args) (a :: l)) =
mkApps (<span class="nb">subst</span> u k (tApp t0 args))
  (map (<span class="nb">subst</span> u k) (a :: l))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk9a"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">u0</span> : list term) (<span class="nv">k0</span> : nat) (<span class="nv">t1</span> : term),
<span class="nb">subst</span> u0 k0 (mkApps t1 l) =
mkApps (<span class="nb">subst</span> u0 k0 t1) (map (<span class="nb">subst</span> u0 k0) l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">args</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> u k (mkApps (tApp t0 args) (a :: l)) =
mkApps (<span class="nb">subst</span> u k (tApp t0 args))
  (map (<span class="nb">subst</span> u k) (a :: l))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk9b"><span class="highlight"><span class="nb">simpl</span> mkApps <span class="nb">at</span> <span class="mi">1</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">u0</span> : list term) (<span class="nv">k0</span> : nat) (<span class="nv">t1</span> : term),
<span class="nb">subst</span> u0 k0 (mkApps t1 l) =
mkApps (<span class="nb">subst</span> u0 k0 t1) (map (<span class="nb">subst</span> u0 k0) l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">args</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> u k (tApp t0 (args ++ a :: l)) =
mkApps (<span class="nb">subst</span> u k (tApp t0 args))
  (map (<span class="nb">subst</span> u k) (a :: l))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk9c"><span class="highlight"><span class="nb">simpl</span> <span class="nb">subst</span> <span class="nb">at</span> <span class="mi">1</span> <span class="mi">2</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">u0</span> : list term) (<span class="nv">k0</span> : nat) (<span class="nv">t1</span> : term),
<span class="nb">subst</span> u0 k0 (mkApps t1 l) =
mkApps (<span class="nb">subst</span> u0 k0 t1) (map (<span class="nb">subst</span> u0 k0) l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">args</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (<span class="nb">subst</span> u k t0)
  (map (<span class="nb">subst</span> u k) (args ++ a :: l)) =
mkApps (mkApps (<span class="nb">subst</span> u k t0) (map (<span class="nb">subst</span> u k) args))
  (map (<span class="nb">subst</span> u k) (a :: l))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk9d"><span class="highlight"><span class="nb">rewrite</span> map_app.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">u0</span> : list term) (<span class="nv">k0</span> : nat) (<span class="nv">t1</span> : term),
<span class="nb">subst</span> u0 k0 (mkApps t1 l) =
mkApps (<span class="nb">subst</span> u0 k0 t1) (map (<span class="nb">subst</span> u0 k0) l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">args</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (<span class="nb">subst</span> u k t0)
  (map (<span class="nb">subst</span> u k) args ++ map (<span class="nb">subst</span> u k) (a :: l)) =
mkApps (mkApps (<span class="nb">subst</span> u k t0) (map (<span class="nb">subst</span> u k) args))
  (map (<span class="nb">subst</span> u k) (a :: l))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> mkApps_nested.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk9e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst1_mkApps</span> <span class="nv">u</span> <span class="nv">k</span> <span class="nv">t</span> <span class="nv">l</span> : subst1 u k (mkApps t l) = mkApps (subst1 u k t) (map (subst1 u k) l).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(mkApps t l) {k := u} =
mkApps (t {k := u}) (map (subst1 u k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk9f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(mkApps t l) {k := u} =
mkApps (t {k := u}) (map (subst1 u k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> subst_mkApps.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chka0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">distr_subst_rec</span> :
  <span class="kr">forall</span> <span class="nv">M</span> <span class="nv">N</span> (<span class="nv">P</span> : list term) (<span class="nv">wfP</span> : All wf P) <span class="nv">n</span> <span class="nv">p</span>,
    <span class="nb">subst</span> P (p + n) (<span class="nb">subst</span> N p M) =
    <span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p (<span class="nb">subst</span> P (p + length N + n) M).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">N</span> <span class="nv">P</span> : list term),
All <span class="kn">wf</span> P -&gt;
<span class="kr">forall</span> <span class="nv">n</span> <span class="nv">p</span> : nat,
<span class="nb">subst</span> P (p + n) (<span class="nb">subst</span> N p M) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p (<span class="nb">subst</span> P (p + #|N| + n) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chka1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">M</span> : term) (<span class="nv">N</span> <span class="nv">P</span> : list term),
All <span class="kn">wf</span> P -&gt;
<span class="kr">forall</span> <span class="nv">n</span> <span class="nv">p</span> : nat,
<span class="nb">subst</span> P (p + n) (<span class="nb">subst</span> N p M) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p (<span class="nb">subst</span> P (p + #|N| + n) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chka2"><span class="highlight"><span class="nb">intros</span> M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">N</span> <span class="nv">P</span> : list term,
All <span class="kn">wf</span> P -&gt;
<span class="kr">forall</span> <span class="nv">n</span> <span class="nv">p</span> : nat,
<span class="nb">subst</span> P (p + n) (<span class="nb">subst</span> N p M) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p (<span class="nb">subst</span> P (p + #|N| + n) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chka3"><span class="highlight"><span class="nb">elim</span> M <span class="nb">using</span> term_forall_list_ind;
    <span class="nb">intros</span>; <span class="kr">match goal with</span>
              |- <span class="kp">context</span> [tRel _] =&gt; <span class="kp">idtac</span>
            | |- _ =&gt; <span class="nb">simpl</span>
            <span class="kr">end</span>; <span class="kp">try</span> <span class="bp">easy</span>;
      <span class="nb">rewrite</span> -&gt; <span class="nl">?map_map_compose</span>, <span class="nl">?compose_on_snd</span>, <span class="nl">?compose_map_def</span>, <span class="nl">?map_length</span>, <span class="nl">?Nat</span>.add_assoc,
                 <span class="nl">?map_predicate_map_predicate</span>;
      <span class="kp">try</span> <span class="kp">solve</span> [<span class="nb">f_equal</span>; <span class="nb">auto</span>; solve_all].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (<span class="nb">subst</span> N p (tRel n)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="nb">subst</span> P (p + #|N| + n0) (tRel n))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chka4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
All <span class="kn">wf</span> P0 -&gt;
<span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
<span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
  (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
   All <span class="kn">wf</span> P0 -&gt;
   <span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
   <span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
     (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chka4"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n)
  (mkApps (<span class="nb">subst</span> N p t0) (map (<span class="nb">subst</span> N p) l)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p
  (mkApps (<span class="nb">subst</span> P (p + #|N| + n) t0)
     (map (<span class="nb">subst</span> P (p + #|N| + n)) l))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chka5"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (<span class="nb">subst</span> N p (tRel n)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="nb">subst</span> P (p + #|N| + n0) (tRel n))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chka6"><span class="highlight"><span class="nb">unfold</span> <span class="nb">subst</span> <span class="nb">at</span> <span class="mi">2</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0)
  (<span class="kr">if</span> p &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error N (n - p) <span class="kr">with</span>
    | Some b =&gt; lift0 p b
    | None =&gt; tRel (n - #|N|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="nb">subst</span> P (p + #|N| + n0) (tRel n))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chka7"><span class="highlight"><span class="nb">elim</span> (leb_spec p n); <span class="nb">intros</span>; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0)
  <span class="kr">match</span> nth_error N (n - p) <span class="kr">with</span>
  | Some b =&gt; lift0 p b
  | None =&gt; tRel (n - #|N|)
  <span class="kr">end</span> =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="nb">subst</span> P (p + #|N| + n0) (tRel n))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chka8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chka8"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel n) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="nb">subst</span> P (p + #|N| + n0) (tRel n))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">    
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chka9"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0)
  <span class="kr">match</span> nth_error N (n - p) <span class="kr">with</span>
  | Some b =&gt; lift0 p b
  | None =&gt; tRel (n - #|N|)
  <span class="kr">end</span> =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="nb">subst</span> P (p + #|N| + n0) (tRel n))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkaa"><span class="highlight"><span class="nb">destruct</span> (nth_error_spec N (n - p)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (lift0 p x) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="nb">subst</span> P (p + #|N| + n0) (tRel n))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkab" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkab"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel (n - #|N|)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="nb">subst</span> P (p + #|N| + n0) (tRel n))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkac"><span class="highlight">++</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (lift0 p x) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="nb">subst</span> P (p + #|N| + n0) (tRel n))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkad"><span class="highlight"><span class="nb">rewrite</span> -&gt; subst_rel_lt <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (lift0 p x) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (tRel n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkae"><span class="highlight"><span class="nb">erewrite</span> subst_rel_eq; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (lift0 p x) = lift0 p <span class="nl">?t</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkaf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkaf"><hr></label><div class="goal-conclusion"><span class="highlight">nth_error (map (<span class="nb">subst</span> P n0) N) <span class="nl">?i</span> = Some <span class="nl">?t</span></span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkb0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkb0"><hr></label><div class="goal-conclusion"><span class="highlight">n = p + <span class="nl">?i</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkb1"><span class="highlight"><span class="mi">2</span>:<span class="nb">rewrite</span> -&gt; nth_error_map, e; <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (lift0 p x) = lift0 p (<span class="nb">subst</span> P n0 x)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkb2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkb2"><hr></label><div class="goal-conclusion"><span class="highlight">n = p + (n - p)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkb3"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> commut_lift_subst_rec.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error N (n - p) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - p &lt; #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n = p + (n - p)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkb4"><span class="highlight">++</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel (n - #|N|)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="nb">subst</span> P (p + #|N| + n0) (tRel n))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkb5"><span class="highlight"><span class="nb">unfold</span> <span class="nb">subst</span> <span class="nb">at</span> <span class="mi">4</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel (n - #|N|)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="kr">if</span> p + #|N| + n0 &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error P (n - (p + #|N| + n0)) <span class="kr">with</span>
    | Some b =&gt; lift0 (p + #|N| + n0) b
    | None =&gt; tRel (n - #|P|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkb6"><span class="highlight"><span class="nb">elim</span> (leb_spec (p + length N + n0) n); <span class="nb">intros</span>; <span class="nb">subst</span>; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel (n - #|N|)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  <span class="kr">match</span> nth_error P (n - (p + #|N| + n0)) <span class="kr">with</span>
  | Some b =&gt; lift0 (p + #|N| + n0) b
  | None =&gt; tRel (n - #|P|)
  <span class="kr">end</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkb7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + n0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkb7"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel (n - #|N|)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (tRel n)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkb8"><span class="highlight"><span class="nb">destruct</span> (nth_error_spec P (n - (p + length N + n0))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error P (n - (p + #|N| + n0)) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (p + #|N| + n0) &lt; #|P|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel (n - #|N|)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (lift0 (p + #|N| + n0) x)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkb9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|P| &lt;= n - (p + #|N| + n0)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkb9"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel (n - #|N|)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (tRel (n - #|P|))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkba" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + n0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkba"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel (n - #|N|)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (tRel n)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkbb"><span class="highlight">+++</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error P (n - (p + #|N| + n0)) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (p + #|N| + n0) &lt; #|P|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel (n - #|N|)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (lift0 (p + #|N| + n0) x)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkbc"><span class="highlight"><span class="nb">erewrite</span> subst_rel_eq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error P (n - (p + #|N| + n0)) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (p + #|N| + n0) &lt; #|P|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 (p + n0) <span class="nl">?t</span> =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (lift0 (p + #|N| + n0) x)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkbd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error P (n - (p + #|N| + n0)) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (p + #|N| + n0) &lt; #|P|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkbd"><hr></label><div class="goal-conclusion"><span class="highlight">nth_error P <span class="nl">?i</span> = Some <span class="nl">?t</span></span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkbe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error P (n - (p + #|N| + n0)) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (p + #|N| + n0) &lt; #|P|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkbe"><hr></label><div class="goal-conclusion"><span class="highlight">n - #|N| = p + n0 + <span class="nl">?i</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkbf"><span class="highlight"><span class="mi">2</span>:<span class="nb">eauto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error P (n - (p + #|N| + n0)) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (p + #|N| + n0) &lt; #|P|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 (p + n0) x =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (lift0 (p + #|N| + n0) x)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkc0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error P (n - (p + #|N| + n0)) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (p + #|N| + n0) &lt; #|P|</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkc0"><hr></label><div class="goal-conclusion"><span class="highlight">n - #|N| = p + n0 + (n - (p + #|N| + n0))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkc1"><span class="highlight"><span class="mi">2</span>:<span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error P (n - (p + #|N| + n0)) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (p + #|N| + n0) &lt; #|P|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 (p + n0) x =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (lift0 (p + #|N| + n0) x)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">             </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkc2"><span class="highlight"><span class="nb">assert</span> (p + length N + n0 = length (map (<span class="nb">subst</span> P n0) N) + (p + n0))
               <span class="bp">by</span> (<span class="nb">rewrite</span> map_length; <span class="bp">lia</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error P (n - (p + #|N| + n0)) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (p + #|N| + n0) &lt; #|P|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 = #|map (<span class="nb">subst</span> P n0) N| + (p + n0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 (p + n0) x =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (lift0 (p + #|N| + n0) x)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">             </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkc3"><span class="highlight"><span class="nb">rewrite</span> H1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error P (n - (p + #|N| + n0)) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (p + #|N| + n0) &lt; #|P|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 = #|map (<span class="nb">subst</span> P n0) N| + (p + n0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 (p + n0) x =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (lift0 (#|map (<span class="nb">subst</span> P n0) N| + (p + n0)) x)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkc4"><span class="highlight"><span class="nb">rewrite</span> simpl_subst_rec; <span class="nb">eauto</span>; <span class="kp">try</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error P (n - (p + #|N| + n0)) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (p + #|N| + n0) &lt; #|P|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 = #|map (<span class="nb">subst</span> P n0) N| + (p + n0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">             </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">eapply</span> nth_error_all <span class="kr">in</span> e; <span class="nb">eauto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkc5"><span class="highlight">+++</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|P| &lt;= n - (p + #|N| + n0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel (n - #|N|)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (tRel (n - #|P|))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkc6"><span class="highlight"><span class="nb">rewrite</span> !subst_rel_gt; <span class="nb">rewrite</span> <span class="nl">?map_length</span>; <span class="kp">try</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p + #|N| + n0 &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|P| &lt;= n - (p + #|N| + n0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tRel (n - #|N| - #|P|) = tRel (n - #|P| - #|N|)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>; <span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkc7"><span class="highlight">+++</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + n0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel (n - #|N|)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (tRel n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkc8"><span class="highlight"><span class="nb">rewrite</span> subst_rel_lt; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + n0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tRel (n - #|N|) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p (tRel n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">             </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkc9"><span class="highlight"><span class="nb">rewrite</span> -&gt; subst_rel_gt; <span class="nb">rewrite</span> map_length.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + n0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tRel (n - #|N|) = tRel (n - #|N|)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkca" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + n0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkca"><hr></label><div class="goal-conclusion"><span class="highlight">n &gt;= p + #|N|</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkcb"><span class="highlight"><span class="nb">trivial</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|N| &lt;= n - p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p + #|N| + n0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &gt;= p + #|N|</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkcc"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n0) (tRel n) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n0) N) p
  (<span class="nb">subst</span> P (p + #|N| + n0) (tRel n))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">rewrite</span> !subst_rel_lt; <span class="kp">try</span> <span class="bp">easy</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkcd"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
All <span class="kn">wf</span> P0 -&gt;
<span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
<span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
  (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
   All <span class="kn">wf</span> P0 -&gt;
   <span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
   <span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
     (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (p + n)
  (mkApps (<span class="nb">subst</span> N p t0) (map (<span class="nb">subst</span> N p) l)) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p
  (mkApps (<span class="nb">subst</span> P (p + #|N| + n) t0)
     (map (<span class="nb">subst</span> P (p + #|N| + n)) l))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkce"><span class="highlight"><span class="nb">rewrite</span> !subst_mkApps.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
All <span class="kn">wf</span> P0 -&gt;
<span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
<span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
  (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
   All <span class="kn">wf</span> P0 -&gt;
   <span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
   <span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
     (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (<span class="nb">subst</span> P (p + n) (<span class="nb">subst</span> N p t0))
  (map (<span class="nb">subst</span> P (p + n)) (map (<span class="nb">subst</span> N p) l)) =
mkApps
  (<span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p
     (<span class="nb">subst</span> P (p + #|N| + n) t0))
  (map (<span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p)
     (map (<span class="nb">subst</span> P (p + #|N| + n)) l))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkcf"><span class="highlight"><span class="nb">rewrite</span> H; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
All <span class="kn">wf</span> P0 -&gt;
<span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
<span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
  (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
   All <span class="kn">wf</span> P0 -&gt;
   <span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
   <span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
     (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps
  (<span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p
     (<span class="nb">subst</span> P (p + #|N| + n) t0))
  (map (<span class="nb">subst</span> P (p + n)) (map (<span class="nb">subst</span> N p) l)) =
mkApps
  (<span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p
     (<span class="nb">subst</span> P (p + #|N| + n) t0))
  (map (<span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p)
     (map (<span class="nb">subst</span> P (p + #|N| + n)) l))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkd0"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
All <span class="kn">wf</span> P0 -&gt;
<span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
<span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
  (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
   All <span class="kn">wf</span> P0 -&gt;
   <span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
   <span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
     (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map (<span class="nb">subst</span> P (p + n)) (map (<span class="nb">subst</span> N p) l) =
map (<span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p)
  (map (<span class="nb">subst</span> P (p + #|N| + n)) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkd1"><span class="highlight"><span class="nb">rewrite</span> !map_map_compose.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">M, t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
All <span class="kn">wf</span> P0 -&gt;
<span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
<span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 t0) =
<span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
  (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">M0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">N0</span> <span class="nv">P0</span> : list term,
   All <span class="kn">wf</span> P0 -&gt;
   <span class="kr">forall</span> <span class="nv">n0</span> <span class="nv">p0</span> : nat,
   <span class="nb">subst</span> P0 (p0 + n0) (<span class="nb">subst</span> N0 p0 M0) =
   <span class="nb">subst</span> (map (<span class="nb">subst</span> P0 n0) N0) p0
     (<span class="nb">subst</span> P0 (p0 + #|N0| + n0) M0)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N, P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="nb">subst</span> P (p + n) (<span class="nb">subst</span> N p x)) l =
map
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   <span class="nb">subst</span> (map (<span class="nb">subst</span> P n) N) p
     (<span class="nb">subst</span> P (p + #|N| + n) x)) l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkd2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">distr_subst</span> :
  <span class="kr">forall</span> <span class="nv">P</span> (<span class="nv">wfP</span> : All Ast.wf P) <span class="nv">N</span> <span class="nv">M</span> <span class="nv">k</span>,
    <span class="nb">subst</span> P k (subst0 N M) = subst0 (map (<span class="nb">subst</span> P k) N) (<span class="nb">subst</span> P (length N + k) M).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : list term,
All <span class="kn">wf</span> P -&gt;
<span class="kr">forall</span> (<span class="nv">N</span> : list term) (<span class="nv">M</span> : term) (<span class="nv">k</span> : nat),
<span class="nb">subst</span> P k (subst0 N M) =
subst0 (map (<span class="nb">subst</span> P k) N) (<span class="nb">subst</span> P (#|N| + k) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkd3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : list term,
All <span class="kn">wf</span> P -&gt;
<span class="kr">forall</span> (<span class="nv">N</span> : list term) (<span class="nv">M</span> : term) (<span class="nv">k</span> : nat),
<span class="nb">subst</span> P k (subst0 N M) =
subst0 (map (<span class="nb">subst</span> P k) N) (<span class="nb">subst</span> P (#|N| + k) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkd4"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P k (subst0 N M) =
subst0 (map (<span class="nb">subst</span> P k) N) (<span class="nb">subst</span> P (#|N| + k) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkd5"><span class="highlight"><span class="nb">pattern</span> k <span class="nb">at</span> <span class="mi">1</span> <span class="mi">3</span> <span class="kr">in</span> |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt;
 <span class="nb">subst</span> P n (subst0 N M) =
 subst0 (map (<span class="nb">subst</span> P k) N) (<span class="nb">subst</span> P (#|N| + n) M)) k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkd6"><span class="highlight"><span class="nb">change</span> k <span class="kr">with</span> (<span class="mi">0</span> + k).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt;
 <span class="nb">subst</span> P n (subst0 N M) =
 subst0 (map (<span class="nb">subst</span> P (<span class="mi">0</span> + k)) N)
   (<span class="nb">subst</span> P (#|N| + n) M)) (<span class="mi">0</span> + k)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkd7"><span class="highlight"><span class="nb">hnf</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> P (<span class="mi">0</span> + k) (subst0 N M) =
subst0 (map (<span class="nb">subst</span> P (<span class="mi">0</span> + k)) N)
  (<span class="nb">subst</span> P (#|N| + (<span class="mi">0</span> + k)) M)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkd8"><span class="highlight"><span class="nb">apply</span> distr_subst_rec.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All <span class="kn">wf</span> P</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkd9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lift_closed</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">t</span> : closedn k t -&gt; lift n k t = t.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">closedn k t -&gt; lift n k t = t</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkda"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">closedn k t -&gt; lift n k t = t</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkdb"><span class="highlight"><span class="nb">revert</span> k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k</span> : nat, closedn k t -&gt; lift n k t = t</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkdc"><span class="highlight"><span class="nb">elim</span> t <span class="nb">using</span> term_forall_list_ind; <span class="nb">intros</span>; <span class="kp">try</span> <span class="bp">easy</span>;
    <span class="nb">rewrite</span> -&gt; <span class="nl">?map_map_compose</span>, <span class="nl">?compose_on_snd</span>, <span class="nl">?compose_map_def</span>, <span class="nl">?map_length</span>,
               <span class="nl">?map_predicate_map_predicate</span>;
    <span class="nb">simpl</span> closed <span class="kr">in</span> *;
    <span class="nb">unfold</span> test_def, test_predicate <span class="kr">in</span> *;
    <span class="kp">try</span> <span class="kp">solve</span> [<span class="nb">simpl</span> lift; <span class="nb">simpl</span> closed; <span class="nb">f_equal</span>; <span class="nb">auto</span>; rtoProp; solve_all]; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true (n0 &lt;? k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n k (tRel n0) = tRel n0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkdd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0)
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0) m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (forallb
     (<span class="kr">fun</span> <span class="nv">d</span> : def term =&gt;
      closedn k (dtype d) &amp;&amp;
      closedn (#|m| + k) (dbody d)) m)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkdd"><hr></label><div class="goal-conclusion"><span class="highlight">lift n k (tFix m n0) = tFix m n0</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkde" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0)
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0) m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (forallb
     (<span class="kr">fun</span> <span class="nv">d</span> : def term =&gt;
      closedn k (dtype d) &amp;&amp;
      closedn (#|m| + k) (dbody d)) m)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkde"><hr></label><div class="goal-conclusion"><span class="highlight">lift n k (tCoFix m n0) = tCoFix m n0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkdf"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true (n0 &lt;? k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n k (tRel n0) = tRel n0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chke0"><span class="highlight"><span class="nb">rewrite</span> lift_rel_lt; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true (n0 &lt;? k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k &gt; n0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chke1"><span class="highlight"><span class="nb">revert</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n0 &lt;? k -&gt; k &gt; n0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">elim</span> (Nat.ltb_spec n0 k); <span class="nb">intros</span>; <span class="kp">try</span> <span class="bp">easy</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chke2"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0)
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0) m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (forallb
     (<span class="kr">fun</span> <span class="nv">d</span> : def term =&gt;
      closedn k (dtype d) &amp;&amp;
      closedn (#|m| + k) (dbody d)) m)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n k (tFix m n0) = tFix m n0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chke3"><span class="highlight"><span class="nb">simpl</span> lift.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0)
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0) m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (forallb
     (<span class="kr">fun</span> <span class="nv">d</span> : def term =&gt;
      closedn k (dtype d) &amp;&amp;
      closedn (#|m| + k) (dbody d)) m)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tFix (map (map_def (lift n k) (lift n (#|m| + k))) m)
  n0 = tFix m n0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chke4"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0)
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0) m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (forallb
     (<span class="kr">fun</span> <span class="nv">d</span> : def term =&gt;
      closedn k (dtype d) &amp;&amp;
      closedn (#|m| + k) (dbody d)) m)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map (map_def (lift n k) (lift n (#|m| + k))) m = m</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chke5"><span class="highlight">solve_all.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">def term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (closedn k (dtype x) &amp;&amp;
   closedn (#|m| + k) (dbody x))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dtype x) -&gt;
lift n k0 (dtype x) = dtype x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dbody x) -&gt;
lift n k0 (dbody x) = dbody x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_def (lift n k) (lift n (#|m| + k)) x = x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chke6"><span class="highlight"><span class="nb">unfold</span> test_def <span class="kr">in</span> b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">def term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (closedn k (dtype x) &amp;&amp;
   closedn (#|m| + k) (dbody x))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dtype x) -&gt;
lift n k0 (dtype x) = dtype x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dbody x) -&gt;
lift n k0 (dbody x) = dbody x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_def (lift n k) (lift n (#|m| + k)) x = x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chke7"><span class="highlight">toProp.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">def term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">closedn k (dtype x) = true /\
closedn (#|m| + k) (dbody x) = true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dtype x) -&gt;
lift n k0 (dtype x) = dtype x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dbody x) -&gt;
lift n k0 (dbody x) = dbody x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_def (lift n k) (lift n (#|m| + k)) x = x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chke8"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0)
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0) m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (forallb
     (<span class="kr">fun</span> <span class="nv">d</span> : def term =&gt;
      closedn k (dtype d) &amp;&amp;
      closedn (#|m| + k) (dbody d)) m)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n k (tCoFix m n0) = tCoFix m n0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chke9"><span class="highlight"><span class="nb">simpl</span> lift.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0)
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0) m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (forallb
     (<span class="kr">fun</span> <span class="nv">d</span> : def term =&gt;
      closedn k (dtype d) &amp;&amp;
      closedn (#|m| + k) (dbody d)) m)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tCoFix
  (map (map_def (lift n k) (lift n (#|m| + k))) m) n0 =
tCoFix m n0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkea"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0)
  (<span class="kr">fun</span> <span class="nv">t0</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   closedn k0 t0 -&gt; lift n k0 t0 = t0) m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (forallb
     (<span class="kr">fun</span> <span class="nv">d</span> : def term =&gt;
      closedn k (dtype d) &amp;&amp;
      closedn (#|m| + k) (dbody d)) m)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map (map_def (lift n k) (lift n (#|m| + k))) m = m</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkeb"><span class="highlight">solve_all.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">def term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (closedn k (dtype x) &amp;&amp;
   closedn (#|m| + k) (dbody x))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dtype x) -&gt;
lift n k0 (dtype x) = dtype x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dbody x) -&gt;
lift n k0 (dbody x) = dbody x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_def (lift n k) (lift n (#|m| + k)) x = x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkec"><span class="highlight"><span class="nb">unfold</span> test_def <span class="kr">in</span> b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">def term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true
  (closedn k (dtype x) &amp;&amp;
   closedn (#|m| + k) (dbody x))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dtype x) -&gt;
lift n k0 (dtype x) = dtype x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dbody x) -&gt;
lift n k0 (dbody x) = dbody x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_def (lift n k) (lift n (#|m| + k)) x = x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chked"><span class="highlight">toProp.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">def term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">closedn k (dtype x) = true /\
closedn (#|m| + k) (dbody x) = true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dtype x) -&gt;
lift n k0 (dtype x) = dtype x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
closedn k0 (dbody x) -&gt;
lift n k0 (dbody x) = dbody x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_def (lift n k) (lift n (#|m| + k)) x = x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkee"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">closed_upwards</span> {<span class="nv">k</span> <span class="nv">t</span>} <span class="nv">k&#39;</span> : closedn k t -&gt; k&#39; &gt;= k -&gt; closedn k&#39; t.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">closedn k t -&gt; k&#39; &gt;= k -&gt; closedn k&#39; t</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkef"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">closedn k t -&gt; k&#39; &gt;= k -&gt; closedn k&#39; t</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkf0"><span class="highlight"><span class="nb">revert</span> k k&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">k&#39;</span> : nat,
closedn k t -&gt; k&#39; &gt;= k -&gt; closedn k&#39; t</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkf1"><span class="highlight"><span class="nb">elim</span> t <span class="nb">using</span> term_forall_list_ind; <span class="nb">intros</span>; <span class="kp">try</span> <span class="bp">lia</span>;
    <span class="nb">rewrite</span> -&gt; <span class="nl">?map_map_compose</span>, <span class="nl">?compose_on_snd</span>, <span class="nl">?compose_map_def</span>, <span class="nl">?map_length</span>,
               <span class="nl">?map_predicate_map_predicate</span>;
    <span class="nb">simpl</span> closed <span class="kr">in</span> *; <span class="nb">unfold</span> test_snd, test_def, test_predicate, test_branch <span class="kr">in</span> *;
      <span class="kp">try</span> <span class="kp">solve</span> [(<span class="kp">try</span> <span class="nb">f_equal</span>; <span class="nb">simpl</span>; <span class="kp">repeat</span> (rtoProp; solve_all); <span class="nb">eauto</span>)].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true (n &lt;? k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k&#39; &gt;= k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">is_true (n &lt;? k&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkf2"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true (n &lt;? k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k&#39; &gt;= k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">is_true (n &lt;? k&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkf3"><span class="highlight"><span class="nb">elim</span> (ltb_spec n k&#39;); <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true (n &lt;? k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k&#39; &gt;= k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k&#39; &lt;= n -&gt; false</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkf4"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">is_true (n &lt;? k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k&#39; &gt;= k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k&#39; &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">is_true false</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkf5"><span class="highlight"><span class="nb">apply</span> ltb_lt <span class="kr">in</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k&#39; &gt;= k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k&#39; &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">is_true false</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkf6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mkApps_mkApp</span> <span class="nv">u</span> <span class="nv">a</span> <span class="nv">v</span> : mkApps (mkApp u a) v = mkApps u (a :: v).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (mkApp u a) v = mkApps u (a :: v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkf7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (mkApp u a) v = mkApps u (a :: v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkf8"><span class="highlight"><span class="nb">induction</span> v.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (mkApp u a) [] = mkApps u [a]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkf9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a, a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mkApps (mkApp u a) v = mkApps u (a :: v)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkf9"><hr></label><div class="goal-conclusion"><span class="highlight">mkApps (mkApp u a) (a0 :: v) = mkApps u (a :: a0 :: v)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkfa"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApp u a =
<span class="kr">match</span> u <span class="kr">with</span>
| tApp f args =&gt; tApp f (args ++ [a])
| _ =&gt; tApp u [a]
<span class="kr">end</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chkfb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a, a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mkApps (mkApp u a) v = mkApps u (a :: v)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chkfb"><hr></label><div class="goal-conclusion"><span class="highlight">mkApps (mkApp u a) (a0 :: v) = mkApps u (a :: a0 :: v)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkfc"><span class="highlight"><span class="nb">destruct</span> u; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a, a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mkApps (mkApp u a) v = mkApps u (a :: v)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (mkApp u a) (a0 :: v) = mkApps u (a :: a0 :: v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkfd"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a, a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mkApps (mkApp u a) v = mkApps u (a :: v)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (mkApp u a) (a0 :: v) = mkApps u (a :: a0 :: v)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkfe"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a, a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mkApps (mkApp u a) v = mkApps u (a :: v)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> mkApp u a <span class="kr">with</span>
| tApp f args =&gt; tApp f (args ++ a0 :: v)
| _ =&gt; tApp (mkApp u a) (a0 :: v)
<span class="kr">end</span> =
<span class="kr">match</span> u <span class="kr">with</span>
| tApp f args =&gt; tApp f (args ++ a :: a0 :: v)
| _ =&gt; tApp u (a :: a0 :: v)
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chkff"><span class="highlight"><span class="nb">destruct</span> u; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">args</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mkApps (mkApp (tApp u args) a) v =
mkApps (tApp u args) (a :: v)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tApp u ((args ++ [a]) ++ a0 :: v) =
tApp u (args ++ a :: a0 :: v)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- app_assoc.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk100"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">wf_mkApp</span> <span class="nv">u</span> <span class="nv">a</span> : <span class="kn">wf</span> u -&gt; <span class="kn">wf</span> a -&gt; <span class="kn">wf</span> (mkApp u a).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> u -&gt; <span class="kn">wf</span> a -&gt; <span class="kn">wf</span> (mkApp u a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk101"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> u -&gt; <span class="kn">wf</span> a -&gt; <span class="kn">wf</span> (mkApp u a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk102"><span class="highlight"><span class="nb">intros</span> H H&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> u</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (mkApp u a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk103"><span class="highlight"><span class="nb">inversion_clear</span> H; <span class="kp">try</span> <span class="nb">constructor</span>; <span class="nb">simpl</span>; <span class="nb">auto</span>; <span class="kp">try</span> <span class="bp">congruence</span>; <span class="kp">try</span> <span class="nb">constructor</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> u0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">u0 ++ [a] &lt;&gt; []</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk104" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> u0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk104"><hr></label><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> (u0 ++ [a])</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk105"><span class="highlight"><span class="nb">intro</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> u0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 ++ [a] = []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk106" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> u0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk106"><hr></label><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> (u0 ++ [a])</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk107"><span class="highlight"><span class="nb">destruct</span> u0; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="bp">congruence</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> u0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> (u0 ++ [a])</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk108"><span class="highlight">solve_all.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 = [] -&gt; <span class="kt">False</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> u0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All <span class="kn">wf</span> (u0 ++ [a])</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> All_app_inv; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk109"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">wf_mkApps</span> <span class="nv">u</span> <span class="nv">a</span> : <span class="kn">wf</span> u -&gt; List.Forall <span class="kn">wf</span> a -&gt; <span class="kn">wf</span> (mkApps u a).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> u -&gt; Forall <span class="kn">wf</span> a -&gt; <span class="kn">wf</span> (mkApps u a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk10a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> u -&gt; Forall <span class="kn">wf</span> a -&gt; <span class="kn">wf</span> (mkApps u a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk10b"><span class="highlight"><span class="nb">intros</span> H H&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> u</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (mkApps u a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk10c"><span class="highlight"><span class="nb">induction</span> a; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> u</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> (a :: a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> a0 -&gt; <span class="kn">wf</span> (mkApps u a0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span>
  <span class="kr">match</span> u <span class="kr">with</span>
  | tApp f args =&gt; tApp f (args ++ a :: a0)
  | _ =&gt; tApp u (a :: a0)
  <span class="kr">end</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk10d"><span class="highlight"><span class="nb">inversion_clear</span> H; <span class="kp">try</span> <span class="nb">constructor</span>; <span class="nb">simpl</span>; <span class="nb">auto</span>; <span class="kp">try</span> <span class="bp">congruence</span>; <span class="kp">try</span> <span class="nb">constructor</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> (a :: a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> a0 -&gt; <span class="kn">wf</span> (mkApps u a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> u0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">u0 ++ a :: a0 &lt;&gt; []</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk10e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> (a :: a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> a0 -&gt; <span class="kn">wf</span> (mkApps u a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> u0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk10e"><hr></label><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> (u0 ++ a :: a0)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk10f"><span class="highlight"><span class="nb">intro</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> (a :: a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> a0 -&gt; <span class="kn">wf</span> (mkApps u a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> u0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 ++ a :: a0 = []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk110" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> (a :: a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> a0 -&gt; <span class="kn">wf</span> (mkApps u a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> u0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk110"><hr></label><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> (u0 ++ a :: a0)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk111"><span class="highlight"><span class="nb">destruct</span> u0; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="bp">congruence</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> (a :: a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> a0 -&gt; <span class="kn">wf</span> (mkApps u a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> u0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> (u0 ++ a :: a0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk112"><span class="highlight">solve_all.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">u, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> (a :: a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> a0 -&gt; <span class="kn">wf</span> (mkApps u a0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u0 = [] -&gt; <span class="kt">False</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> u0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All <span class="kn">wf</span> (u0 ++ a :: a0)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> All_app_inv; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk113"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">wf_subst</span> <span class="nv">ts</span> <span class="nv">k</span> <span class="nv">u</span> : List.Forall <span class="kn">wf</span> ts -&gt; <span class="kn">wf</span> u -&gt; <span class="kn">wf</span> (<span class="nb">subst</span> ts k u).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> ts -&gt; <span class="kn">wf</span> u -&gt; <span class="kn">wf</span> (<span class="nb">subst</span> ts k u)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk114"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> ts -&gt; <span class="kn">wf</span> u -&gt; <span class="kn">wf</span> (<span class="nb">subst</span> ts k u)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk115"><span class="highlight"><span class="nb">intros</span> wfts wfu.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> u</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (<span class="nb">subst</span> ts k u)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk116"><span class="highlight"><span class="nb">induction</span> wfu <span class="kr">in</span> k <span class="nb">using</span> term_wf_forall_list_ind; <span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="kp">try</span> <span class="nb">constructor</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span>
  (<span class="kr">if</span> k &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error ts (n - k) <span class="kr">with</span>
    | Some b =&gt; lift0 k b
    | None =&gt; tRel (n - #|ts|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk117" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk117"><hr></label><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> (map (<span class="nb">subst</span> ts k) l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk118" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk118"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (mkApps (<span class="nb">subst</span> ts k t0) (map (<span class="nb">subst</span> ts k) l))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk119" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCasePredProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) p0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk119"><hr></label><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span>
  (pparams
     (map_predicate id (<span class="nb">subst</span> ts k)
        (<span class="nb">subst</span> ts (#|pcontext p0| + k)) p0))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk11a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCasePredProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) p0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk11a"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span>
  (preturn
     (map_predicate id (<span class="nb">subst</span> ts k)
        (<span class="nb">subst</span> ts (#|pcontext p0| + k)) p0))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk11b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCasePredProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) p0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk11b"><hr></label><div class="goal-conclusion"><span class="highlight">Forall (<span class="kr">fun</span> <span class="nv">x</span> : branch term =&gt; <span class="kn">wf</span> (bbody x))
  (map_branches_k (<span class="nb">subst</span> ts) k l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk11c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) m</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk11c"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">def</span> : def term =&gt;
   <span class="kn">wf</span> (dtype def) /\ <span class="kn">wf</span> (dbody def))
  (map (map_def (<span class="nb">subst</span> ts k) (<span class="nb">subst</span> ts (#|m| + k))) m)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk11d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) m</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk11d"><hr></label><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">def</span> : def term =&gt;
   <span class="kn">wf</span> (dtype def) /\ <span class="kn">wf</span> (dbody def))
  (map (map_def (<span class="nb">subst</span> ts k) (<span class="nb">subst</span> ts (#|m| + k))) m)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk11e"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span>
  (<span class="kr">if</span> k &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error ts (n - k) <span class="kr">with</span>
    | Some b =&gt; lift0 k b
    | None =&gt; tRel (n - #|ts|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk11f"><span class="highlight"><span class="nb">unfold</span> <span class="nb">subst</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span>
  (<span class="kr">if</span> k &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error ts (n - k) <span class="kr">with</span>
    | Some b =&gt; lift0 k b
    | None =&gt; tRel (n - #|ts|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk120"><span class="highlight"><span class="nb">destruct</span> (leb_spec k n).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span>
  <span class="kr">match</span> nth_error ts (n - k) <span class="kr">with</span>
  | Some b =&gt; lift0 k b
  | None =&gt; tRel (n - #|ts|)
  <span class="kr">end</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk121" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; k</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk121"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (tRel n)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk122"><span class="highlight"><span class="nb">destruct</span> nth_error <span class="nb">eqn</span>:Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error ts (n - k) = Some t0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (lift0 k t0)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk123" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error ts (n - k) = None</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk123"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (tRel (n - #|ts|))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk124" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; k</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk124"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (tRel n)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk125"><span class="highlight"><span class="nb">apply</span> (nth_error_forall Heq) <span class="kr">in</span> wfts.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error ts (n - k) = Some t0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (lift0 k t0)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk126" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error ts (n - k) = None</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk126"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (tRel (n - #|ts|))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk127" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; k</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk127"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (tRel n)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk128"><span class="highlight"><span class="nb">apply</span> wf_lift; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error ts (n - k) = None</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (tRel (n - #|ts|))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk129" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; k</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk129"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (tRel n)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk12a"><span class="highlight"><span class="nb">constructor</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (tRel n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">constructor</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk12b"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> (map (<span class="nb">subst</span> ts k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk12c"><span class="highlight"><span class="nb">apply</span> Forall_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kn">wf</span> (<span class="nb">subst</span> ts k x)) l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">eapply</span> Forall_impl; <span class="nb">eauto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk12d"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (mkApps (<span class="nb">subst</span> ts k t0) (map (<span class="nb">subst</span> ts k) l))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk12e"><span class="highlight"><span class="nb">apply</span> wf_mkApps; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> (map (<span class="nb">subst</span> ts k) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk12f"><span class="highlight"><span class="nb">apply</span> Forall_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kn">wf</span> (<span class="nb">subst</span> ts k x)) l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">eapply</span> Forall_impl; <span class="nb">eauto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk130"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCasePredProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) p0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span>
  (pparams
     (map_predicate id (<span class="nb">subst</span> ts k)
        (<span class="nb">subst</span> ts (#|pcontext p0| + k)) p0))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk131"><span class="highlight"><span class="nb">destruct</span> X.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (pparams p0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 (preturn p0))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span>
  (pparams
     (map_predicate id (<span class="nb">subst</span> ts k)
        (<span class="nb">subst</span> ts (#|pcontext p0| + k)) p0))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk132"><span class="highlight"><span class="nb">apply</span> Forall_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (pparams p0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 (preturn p0))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kn">wf</span> (<span class="nb">subst</span> ts k x))
  (pparams p0)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk133"><span class="highlight"><span class="nb">apply</span> All_Forall.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (pparams p0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 (preturn p0))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; <span class="kn">wf</span> (<span class="nb">subst</span> ts k x)) (pparams p0)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">eapply</span> All_impl; <span class="nb">eauto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk134"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCasePredProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) p0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span>
  (preturn
     (map_predicate id (<span class="nb">subst</span> ts k)
        (<span class="nb">subst</span> ts (#|pcontext p0| + k)) p0))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> X; <span class="nb">cbn</span>; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk135"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCasePredProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) p0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall (<span class="kr">fun</span> <span class="nv">x</span> : branch term =&gt; <span class="kn">wf</span> (bbody x))
  (map_branches_k (<span class="nb">subst</span> ts) k l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk136"><span class="highlight"><span class="nb">apply</span> Forall_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCasePredProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) p0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : branch term =&gt;
   <span class="kn">wf</span>
     (bbody
        (map_branch (<span class="nb">subst</span> ts (#|bcontext x| + k)) x)))
  l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk137"><span class="highlight"><span class="nb">apply</span> All_Forall.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCasePredProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) p0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">x</span> : branch term =&gt;
   <span class="kn">wf</span>
     (bbody
        (map_branch (<span class="nb">subst</span> ts (#|bcontext x| + k)) x)))
  l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk138"><span class="highlight"><span class="nb">eapply</span> All_impl; tea.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCasePredProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) p0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tCaseBrsProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : branch term,
(<span class="kr">fun</span> <span class="nv">x0</span> : branch term =&gt;
 (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt; <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
   (bbody x0)) x -&gt;
<span class="kn">wf</span>
  (bbody (map_branch (<span class="nb">subst</span> ts (#|bcontext x| + k)) x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">intros</span> [] XX; <span class="nb">cbn</span> <span class="kr">in</span> *; <span class="nb">apply</span> XX.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk139"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">def</span> : def term =&gt;
   <span class="kn">wf</span> (dtype def) /\ <span class="kn">wf</span> (dbody def))
  (map (map_def (<span class="nb">subst</span> ts k) (<span class="nb">subst</span> ts (#|m| + k))) m)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk13a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">def</span> : def term =&gt;
   <span class="kn">wf</span> (dtype def) /\ <span class="kn">wf</span> (dbody def))
  (map (map_def (<span class="nb">subst</span> ts k) (<span class="nb">subst</span> ts (#|m| + k))) m)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk13b"><span class="highlight"><span class="nb">apply</span> Forall_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">x</span> : def term =&gt;
   <span class="kn">wf</span>
     (dtype
        (map_def (<span class="nb">subst</span> ts k) (<span class="nb">subst</span> ts (#|m| + k)) x)) /\
   <span class="kn">wf</span>
     (dbody
        (map_def (<span class="nb">subst</span> ts k) (<span class="nb">subst</span> ts (#|m| + k)) x)))
  m</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk13c"><span class="highlight"><span class="nb">eapply</span> All_Forall, All_impl; <span class="nb">eauto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfts</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> ts</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">mfixpoint term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">tFixProp
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
  (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u)) m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : def term,
(<span class="kr">fun</span> <span class="nv">x0</span> : def term =&gt;
 (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt; <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
   (dtype x0) *
 (<span class="kr">fun</span> <span class="nv">u</span> : term =&gt; <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="kn">wf</span> (<span class="nb">subst</span> ts k0 u))
   (dbody x0)) x -&gt;
<span class="kn">wf</span>
  (dtype
     (map_def (<span class="nb">subst</span> ts k) (<span class="nb">subst</span> ts (#|m| + k)) x)) /\
<span class="kn">wf</span>
  (dbody
     (map_def (<span class="nb">subst</span> ts k) (<span class="nb">subst</span> ts (#|m| + k)) x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">intros</span> [] XX; <span class="nb">cbn</span> <span class="kr">in</span> *; <span class="nb">split</span>; <span class="nb">apply</span> XX.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk13d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">wf_subst1</span> <span class="nv">t</span> <span class="nv">k</span> <span class="nv">u</span> : <span class="kn">wf</span> t -&gt; <span class="kn">wf</span> u -&gt; <span class="kn">wf</span> (subst1 t k u).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> t -&gt; <span class="kn">wf</span> u -&gt; <span class="kn">wf</span> (u {k := t})</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk13e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> t -&gt; <span class="kn">wf</span> u -&gt; <span class="kn">wf</span> (u {k := t})</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk13f"><span class="highlight"><span class="nb">intros</span> wft wfu.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wft</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> u</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (u {k := t})</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk140"><span class="highlight"><span class="nb">apply</span> wf_subst.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wft</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> u</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> [t]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk141" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wft</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> u</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk141"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> u</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk142"><span class="highlight"><span class="nb">constructor</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wft</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfu</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> u</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> u</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">auto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hint Resolve</span> wf_mkApps wf_subst wf_subst1 wf_lift : <span class="kn">wf</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk143"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_empty</span> <span class="nv">k</span> <span class="nv">a</span> : Ast.<span class="kn">wf</span> a -&gt; <span class="nb">subst</span> [] k a = a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> a -&gt; <span class="nb">subst</span> [] k a = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk144"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> a -&gt; <span class="nb">subst</span> [] k a = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk145"><span class="highlight"><span class="nb">induction</span> <span class="mi">1</span> <span class="kr">in</span> k |- * <span class="nb">using</span> term_wf_forall_list_ind; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">congruence</span>;
    <span class="kp">try</span> <span class="kp">solve</span> [<span class="nb">f_equal</span>; <span class="nb">eauto</span>; solve_all].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> k &lt;=? n
 <span class="kr">then</span>
  <span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
  | Some b =&gt; lift0 k b
  | None =&gt; tRel (n - <span class="mi">0</span>)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel n) = tRel n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk146" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">a</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="nb">subst</span> [] k0 a = a) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="nb">subst</span> [] k0 t0 = t0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk146"><hr></label><div class="goal-conclusion"><span class="highlight">mkApps (<span class="nb">subst</span> [] k t0) (map (<span class="nb">subst</span> [] k) l) =
tApp t0 l</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk147"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> k &lt;=? n
 <span class="kr">then</span>
  <span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
  | Some b =&gt; lift0 k b
  | None =&gt; tRel (n - <span class="mi">0</span>)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel n) = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk148"><span class="highlight"><span class="nb">elim</span> (Nat.compare_spec k n); <span class="nb">destruct</span> (Nat.leb_spec k n); <span class="nb">intros</span>; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k = n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk149" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk149"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk14a"><span class="highlight"><span class="nb">subst</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - n) <span class="kr">with</span>
| Some b =&gt; lift0 n b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk14b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk14b"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk14c"><span class="highlight"><span class="nb">rewrite</span> Nat.sub_diag.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] <span class="mi">0</span> <span class="kr">with</span>
| Some b =&gt; lift0 n b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk14d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk14d"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk14e"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tRel (n - <span class="mi">0</span>) = tRel n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk14f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk14f"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk150"><span class="highlight"><span class="nb">rewrite</span> Nat.sub_0_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tRel n = tRel n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk151" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk151"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk152"><span class="highlight"><span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk153"><span class="highlight"><span class="nb">assert</span> (n - k &gt; <span class="mi">0</span>) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &gt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk154"><span class="highlight"><span class="nb">assert</span> (<span class="kr">exists</span> <span class="nv">n&#39;</span>, n - k = S n&#39;).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &gt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">n&#39;</span> : nat, n - k = S n&#39;</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk155" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">n&#39;</span> : nat, n - k = S n&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk155"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk156"><span class="highlight"><span class="kr">exists</span> (<span class="nv">pred</span> (n - k)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &gt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n - k = S (pred (n - k))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk157" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">n&#39;</span> : nat, n - k = S n&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk157"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk158"><span class="highlight"><span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">n&#39;</span> : nat, n - k = S n&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk159"><span class="highlight"><span class="nb">destruct</span> H2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k = S x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (n - k) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk15a"><span class="highlight"><span class="nb">rewrite</span> H2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k = S x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> nth_error [] (S x) <span class="kr">with</span>
| Some b =&gt; lift0 k b
| None =&gt; tRel (n - <span class="mi">0</span>)
<span class="kr">end</span> = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk15b"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &gt; <span class="mi">0</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k = S x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tRel (n - <span class="mi">0</span>) = tRel n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Nat.sub_0_r.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk15c"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">a</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="nb">subst</span> [] k0 a = a) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="nb">subst</span> [] k0 t0 = t0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (<span class="nb">subst</span> [] k t0) (map (<span class="nb">subst</span> [] k) l) =
tApp t0 l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk15d"><span class="highlight"><span class="nb">rewrite</span> IHwf.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">a</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="nb">subst</span> [] k0 a = a) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="nb">subst</span> [] k0 t0 = t0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps t0 (map (<span class="nb">subst</span> [] k) l) = tApp t0 l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk15e"><span class="highlight"><span class="nb">rewrite</span> mkApps_tApp; <span class="nb">eauto with</span> <span class="kn">wf</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp t0 = false</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l &lt;&gt; []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall
  (<span class="kr">fun</span> <span class="nv">a</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="nb">subst</span> [] k0 a = a) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHwf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, <span class="nb">subst</span> [] k0 t0 = t0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tApp t0 (map (<span class="nb">subst</span> [] k) l) = tApp t0 l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>; solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk15f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lift_to_extended_list_k</span> <span class="nv">Œì</span> <span class="nv">k</span> : <span class="kr">forall</span> <span class="nv">k&#39;</span>,
    to_extended_list_k Œì (k&#39; + k) = map (lift0 k&#39;) (to_extended_list_k Œì k).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k&#39;</span> : nat,
to_extended_list_k Œì (k&#39; + k) =
map (lift0 k&#39;) (to_extended_list_k Œì k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk160"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k&#39;</span> : nat,
to_extended_list_k Œì (k&#39; + k) =
map (lift0 k&#39;) (to_extended_list_k Œì k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk161"><span class="highlight"><span class="nb">unfold</span> to_extended_list_k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k&#39;</span> : nat,
reln [] (k&#39; + k) Œì = map (lift0 k&#39;) (reln [] k Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk162"><span class="highlight"><span class="nb">intros</span> k&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reln [] (k&#39; + k) Œì = map (lift0 k&#39;) (reln [] k Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk163"><span class="highlight"><span class="nb">rewrite</span> !reln_alt_eq !app_nil_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.rev (reln_alt (k&#39; + k) Œì) =
map (lift0 k&#39;) (List.rev (reln_alt k Œì))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk164"><span class="highlight"><span class="nb">induction</span> Œì <span class="kr">in</span> k, k&#39; |- *; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> <span class="nv">k&#39;0</span> : nat,
List.rev (reln_alt (k&#39;0 + k0) Œì) = map (lift0 k&#39;0) (List.rev (reln_alt k0 Œì))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.rev
  <span class="kr">match</span> a <span class="kr">with</span>
  | {| decl_body := Some _ |} =&gt;
      reln_alt (k&#39; + k + <span class="mi">1</span>) Œì
  | {| decl_body := None |} =&gt;
      tRel (k&#39; + k) :: reln_alt (k&#39; + k + <span class="mi">1</span>) Œì
  <span class="kr">end</span> =
map (lift0 k&#39;)
  (List.rev
     <span class="kr">match</span> a <span class="kr">with</span>
     | {| decl_body := Some _ |} =&gt; reln_alt (k + <span class="mi">1</span>) Œì
     | {| decl_body := None |} =&gt;
         tRel k :: reln_alt (k + <span class="mi">1</span>) Œì
     <span class="kr">end</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk165"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [na [body|] ty].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">body, ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> <span class="nv">k&#39;0</span> : nat,
List.rev (reln_alt (k&#39;0 + k0) Œì) =
map (lift0 k&#39;0) (List.rev (reln_alt k0 Œì))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.rev (reln_alt (k&#39; + k + <span class="mi">1</span>) Œì) =
map (lift0 k&#39;) (List.rev (reln_alt (k + <span class="mi">1</span>) Œì))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk166" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> <span class="nv">k&#39;0</span> : nat,
List.rev (reln_alt (k&#39;0 + k0) Œì) =
map (lift0 k&#39;0) (List.rev (reln_alt k0 Œì))</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk166"><hr></label><div class="goal-conclusion"><span class="highlight">List.rev (tRel (k&#39; + k) :: reln_alt (k&#39; + k + <span class="mi">1</span>) Œì) =
map (lift0 k&#39;)
  (List.rev (tRel k :: reln_alt (k + <span class="mi">1</span>) Œì))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk167"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- Nat.add_assoc, (IHŒì (k + <span class="mi">1</span>) k&#39;).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> <span class="nv">k&#39;0</span> : nat,
List.rev (reln_alt (k&#39;0 + k0) Œì) =
map (lift0 k&#39;0) (List.rev (reln_alt k0 Œì))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.rev (tRel (k&#39; + k) :: reln_alt (k&#39; + k + <span class="mi">1</span>) Œì) =
map (lift0 k&#39;)
  (List.rev (tRel k :: reln_alt (k + <span class="mi">1</span>) Œì))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk168"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ty</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list context_decl</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, k'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHŒì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> <span class="nv">k&#39;0</span> : nat,
List.rev (reln_alt (k&#39;0 + k0) Œì) =
map (lift0 k&#39;0) (List.rev (reln_alt k0 Œì))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.rev (reln_alt (k&#39; + k + <span class="mi">1</span>) Œì) ++ [tRel (k&#39; + k)] =
map (lift0 k&#39;)
  (List.rev (reln_alt (k + <span class="mi">1</span>) Œì) ++ [tRel k])</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- Nat.add_assoc, (IHŒì (k + <span class="mi">1</span>) k&#39;), map_app.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk169"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">simpl_subst_k</span> (<span class="nv">N</span> : list term) (<span class="nv">M</span> : term) :
  Ast.<span class="kn">wf</span> M -&gt; <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">p</span>, p = #|N| -&gt; <span class="nb">subst</span> N k (lift p k M) = M.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> M -&gt;
<span class="kr">forall</span> <span class="nv">k</span> <span class="nv">p</span> : nat,
p = #|N| -&gt; <span class="nb">subst</span> N k (lift p k M) = M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk16a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> M -&gt;
<span class="kr">forall</span> <span class="nv">k</span> <span class="nv">p</span> : nat,
p = #|N| -&gt; <span class="nb">subst</span> N k (lift p k M) = M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk16b"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> M</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p = #|N|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> N k (lift p k M) = M</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk16c"><span class="highlight"><span class="nb">subst</span> p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> M</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> N k (lift #|N| k M) = M</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk16d"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Nat.add_0_r #|N|).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">M</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> M</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> N k (lift (#|N| + <span class="mi">0</span>) k M) = M</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">rewrite</span> -&gt; simpl_subst_rec, lift0_id; <span class="nb">auto</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk16e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_app_decomp</span> <span class="nv">l</span> <span class="nv">l&#39;</span> <span class="nv">k</span> <span class="nv">t</span> :
  Ast.<span class="kn">wf</span> t -&gt; Forall Ast.<span class="kn">wf</span> l -&gt;
  <span class="nb">subst</span> (l ++ l&#39;) k t = <span class="nb">subst</span> l&#39; k (<span class="nb">subst</span> (List.map (lift0 (length l&#39;)) l) k t).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> t -&gt;
Forall <span class="kn">wf</span> l -&gt;
<span class="nb">subst</span> (l ++ l&#39;) k t =
<span class="nb">subst</span> l&#39; k (<span class="nb">subst</span> (map (lift0 #|l&#39;|) l) k t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk16f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> t -&gt;
Forall <span class="kn">wf</span> l -&gt;
<span class="nb">subst</span> (l ++ l&#39;) k t =
<span class="nb">subst</span> l&#39; k (<span class="nb">subst</span> (map (lift0 #|l&#39;|) l) k t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk170"><span class="highlight"><span class="nb">intros</span> wft wfl.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wft</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> (l ++ l&#39;) k t =
<span class="nb">subst</span> l&#39; k (<span class="nb">subst</span> (map (lift0 #|l&#39;|) l) k t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk171"><span class="highlight"><span class="nb">induction</span> wft <span class="kr">in</span> k |- * <span class="nb">using</span> term_wf_forall_list_ind; <span class="nb">simpl</span>; <span class="nb">auto</span>;
    <span class="nb">rewrite</span> <span class="nl">?subst_mkApps</span>; <span class="kp">try</span> change_Sk;
    <span class="kp">try</span> (<span class="nb">f_equal</span>; <span class="nb">rewrite</span> -&gt; <span class="nl">?map_map_compose</span>, <span class="nl">?compose_on_snd</span>, <span class="nl">?compose_map_def</span>, <span class="nl">?map_length</span>,
                             <span class="nl">?map_predicate_map_predicate</span>;
         <span class="nb">eauto</span>; solve_all).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> k &lt;=? n
 <span class="kr">then</span>
  <span class="kr">match</span> nth_error (l ++ l&#39;) (n - k) <span class="kr">with</span>
  | Some b =&gt; lift0 k b
  | None =&gt; tRel (n - #|l ++ l&#39;|)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel n) =
<span class="nb">subst</span> l&#39; k
  (<span class="kr">if</span> k &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error (map (lift0 #|l&#39;|) l) (n - k) <span class="kr">with</span>
    | Some b =&gt; lift0 k b
    | None =&gt; tRel (n - #|l|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk172"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> k &lt;=? n
 <span class="kr">then</span>
  <span class="kr">match</span> nth_error (l ++ l&#39;) (n - k) <span class="kr">with</span>
  | Some b =&gt; lift0 k b
  | None =&gt; tRel (n - #|l ++ l&#39;|)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel n) =
<span class="nb">subst</span> l&#39; k
  (<span class="kr">if</span> k &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error (map (lift0 #|l&#39;|) l) (n - k) <span class="kr">with</span>
    | Some b =&gt; lift0 k b
    | None =&gt; tRel (n - #|l|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk173"><span class="highlight"><span class="kp">repeat</span> nth_leb_simpl.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error l (n - k) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l| + #|l&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (map (lift0 #|l&#39;|) l) (n - k) = Some x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 k x = <span class="nb">subst</span> l&#39; k (lift0 k x0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk174"><span class="highlight"><span class="nb">rewrite</span> nth_error_map <span class="kr">in</span> e0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error l (n - k) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l| + #|l&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option_map (lift0 #|l&#39;|) (nth_error l (n - k)) =
Some x0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 k x = <span class="nb">subst</span> l&#39; k (lift0 k x0)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk175"><span class="highlight"><span class="nb">rewrite</span> e <span class="kr">in</span> e0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error l (n - k) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l| + #|l&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option_map (lift0 #|l&#39;|) (Some x) = Some x0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 k x = <span class="nb">subst</span> l&#39; k (lift0 k x0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk176"><span class="highlight"><span class="nb">injection</span> e0; <span class="nb">intros</span> &lt;-.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error l (n - k) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l| + #|l&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option_map (lift0 #|l&#39;|) (Some x) =
Some (lift0 #|l&#39;| x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 k x = <span class="nb">subst</span> l&#39; k (lift0 k (lift0 #|l&#39;| x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk177"><span class="highlight"><span class="nb">rewrite</span> -&gt; permute_lift <span class="bp">by</span> <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error l (n - k) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l| + #|l&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option_map (lift0 #|l&#39;|) (Some x) =
Some (lift0 #|l&#39;| x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 k x =
<span class="nb">subst</span> l&#39; k (lift #|l&#39;| (<span class="mi">0</span> + k) (lift0 k x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk178"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Nat.add_0_r #|l&#39;|).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error l (n - k) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l| + #|l&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option_map (lift0 #|l&#39;|) (Some x) =
Some (lift0 #|l&#39;| x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 k x =
<span class="nb">subst</span> l&#39; k (lift (#|l&#39;| + <span class="mi">0</span>) (<span class="mi">0</span> + k) (lift0 k x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk179"><span class="highlight"><span class="nb">rewrite</span> -&gt; simpl_subst_rec, lift0_id; <span class="nb">auto with</span> <span class="kn">wf</span>; <span class="kp">try</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error l (n - k) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l| + #|l&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option_map (lift0 #|l&#39;|) (Some x) =
Some (lift0 #|l&#39;| x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> (lift0 k x)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk17a"><span class="highlight"><span class="nb">apply</span> wf_lift.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error l (n - k) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l| + #|l&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option_map (lift0 #|l&#39;|) (Some x) =
Some (lift0 #|l&#39;| x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk17b"><span class="highlight"><span class="nb">eapply</span> nth_error_forall <span class="kr">in</span> e; <span class="nb">eauto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error l (n - k) = Some x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l| + #|l&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option_map (lift0 #|l&#39;|) (Some x) =
Some (lift0 #|l&#39;| x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall <span class="kn">wf</span> l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk17c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subst_app_simpl</span> <span class="nv">l</span> <span class="nv">l&#39;</span> <span class="nv">k</span> <span class="nv">t</span> :
  Ast.<span class="kn">wf</span> t -&gt; Forall Ast.<span class="kn">wf</span> l -&gt; Forall Ast.<span class="kn">wf</span> l&#39; -&gt;
  <span class="nb">subst</span> (l ++ l&#39;) k t = <span class="nb">subst</span> l k (<span class="nb">subst</span> l&#39; (k + length l) t).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> t -&gt;
Forall <span class="kn">wf</span> l -&gt;
Forall <span class="kn">wf</span> l&#39; -&gt;
<span class="nb">subst</span> (l ++ l&#39;) k t =
<span class="nb">subst</span> l k (<span class="nb">subst</span> l&#39; (k + #|l|) t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk17d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> t -&gt;
Forall <span class="kn">wf</span> l -&gt;
Forall <span class="kn">wf</span> l&#39; -&gt;
<span class="nb">subst</span> (l ++ l&#39;) k t =
<span class="nb">subst</span> l k (<span class="nb">subst</span> l&#39; (k + #|l|) t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk17e"><span class="highlight"><span class="nb">intros</span> wft wfl wfl&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wft</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kn">wf</span> t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall <span class="kn">wf</span> l&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">subst</span> (l ++ l&#39;) k t =
<span class="nb">subst</span> l k (<span class="nb">subst</span> l&#39; (k + #|l|) t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk17f"><span class="highlight"><span class="nb">induction</span> wft <span class="kr">in</span> k |- * <span class="nb">using</span> term_wf_forall_list_ind; <span class="nb">simpl</span>; <span class="nb">eauto</span>;
    <span class="nb">rewrite</span> <span class="nl">?subst_mkApps</span>; <span class="kp">try</span> change_Sk;
    <span class="kp">try</span> (<span class="nb">f_equal</span>; <span class="nb">rewrite</span> -&gt; <span class="nl">?map_map_compose</span>, <span class="nl">?compose_on_snd</span>, <span class="nl">?compose_map_def</span>, <span class="nl">?map_length</span>,
                             <span class="nl">?Nat</span>.add_assoc, <span class="nl">?map_predicate_map_predicate</span>;
         <span class="nb">eauto</span>; solve_all; <span class="nb">eauto</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> k &lt;=? n
 <span class="kr">then</span>
  <span class="kr">match</span> nth_error (l ++ l&#39;) (n - k) <span class="kr">with</span>
  | Some b =&gt; lift0 k b
  | None =&gt; tRel (n - #|l ++ l&#39;|)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel n) =
<span class="nb">subst</span> l k
  (<span class="kr">if</span> k + #|l| &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error l&#39; (n - (k + #|l|)) <span class="kr">with</span>
    | Some b =&gt; lift0 (k + #|l|) b
    | None =&gt; tRel (n - #|l&#39;|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk180"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> k &lt;=? n
 <span class="kr">then</span>
  <span class="kr">match</span> nth_error (l ++ l&#39;) (n - k) <span class="kr">with</span>
  | Some b =&gt; lift0 k b
  | None =&gt; tRel (n - #|l ++ l&#39;|)
  <span class="kr">end</span>
 <span class="kr">else</span> tRel n) =
<span class="nb">subst</span> l k
  (<span class="kr">if</span> k + #|l| &lt;=? n
   <span class="kr">then</span>
    <span class="kr">match</span> nth_error l&#39; (n - (k + #|l|)) <span class="kr">with</span>
    | Some b =&gt; lift0 (k + #|l|) b
    | None =&gt; tRel (n - #|l&#39;|)
    <span class="kr">end</span>
   <span class="kr">else</span> tRel n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk181"><span class="highlight"><span class="kp">repeat</span> nth_leb_simpl.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Some x0 = Some x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error l&#39; (n - k - #|l|) = Some x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l| + #|l&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k + #|l| &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (k + #|l|) &lt; #|l&#39;|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 k x0 = <span class="nb">subst</span> l k (lift0 (k + #|l|) x0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk182"><span class="highlight"><span class="nb">rewrite</span> -&gt; Nat.add_comm, simpl_subst; <span class="nb">eauto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l, l'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">wfl'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All <span class="kn">wf</span> l&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Some x0 = Some x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error l&#39; (n - k - #|l|) = Some x0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - k &lt; #|l| + #|l&#39;|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k + #|l| &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n - (k + #|l|) &lt; #|l&#39;|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kn">wf</span> x0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">eapply</span> nth_error_all <span class="kr">in</span> e; <span class="nb">eauto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk183"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">isLambda_subst</span> (<span class="nv">s</span> : list term) <span class="nv">k</span> (<span class="nv">bod</span> : term) :
  isLambda bod = true -&gt; isLambda (<span class="nb">subst</span> s k bod) = true.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bod</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isLambda bod = true -&gt; isLambda (<span class="nb">subst</span> s k bod) = true</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk184"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bod</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isLambda bod = true -&gt; isLambda (<span class="nb">subst</span> s k bod) = true</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk185"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bod</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isLambda bod = true</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isLambda (<span class="nb">subst</span> s k bod) = true</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk186"><span class="highlight"><span class="nb">destruct</span> bod; <span class="kp">try</span> <span class="bp">discriminate</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">aname</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bod1, bod2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isLambda (tLambda na bod1 bod2) = true</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isLambda (<span class="nb">subst</span> s k (tLambda na bod1 bod2)) = true</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk187"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_vass_map_def</span> <span class="nv">g</span> <span class="nv">l</span> <span class="nv">n</span> <span class="nv">k</span> :
  (mapi (<span class="kr">fun</span> <span class="nv">i</span> (<span class="nv">d</span> : def term) =&gt; vass (dname d) (lift0 i (dtype d)))
        (map (map_def (lift n k) g) l)) =
  (mapi (<span class="kr">fun</span> <span class="nv">i</span> <span class="nv">d</span> =&gt; map_decl (lift n (i + k)) d) (mapi (<span class="kr">fun</span> <span class="nv">i</span> (<span class="nv">d</span> : def term) =&gt; vass (dname d) (lift0 i (dtype d))) l)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (def term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mapi
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">d</span> : def term) =&gt;
   vass (dname d) (lift0 i (dtype d)))
  (map (map_def (lift n k) g) l) =
mapi
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">d</span> : context_decl) =&gt;
   map_decl (lift n (i + k)) d)
  (mapi
     (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">d</span> : def term) =&gt;
      vass (dname d) (lift0 i (dtype d))) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk188"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (def term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mapi
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">d</span> : def term) =&gt;
   vass (dname d) (lift0 i (dtype d)))
  (map (map_def (lift n k) g) l) =
mapi
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">d</span> : context_decl) =&gt;
   map_decl (lift n (i + k)) d)
  (mapi
     (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">d</span> : def term) =&gt;
      vass (dname d) (lift0 i (dtype d))) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk189"><span class="highlight"><span class="nb">rewrite</span> mapi_mapi mapi_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (def term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mapi
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">x</span> : def term) =&gt;
   vass (dname (map_def (lift n k) g x))
     (lift0 i (dtype (map_def (lift n k) g x)))) l =
mapi
  (<span class="kr">fun</span> (<span class="nv">n0</span> : nat) (<span class="nv">x</span> : def term) =&gt;
   map_decl (lift n (n0 + k))
     (vass (dname x) (lift0 n0 (dtype x)))) l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk18a"><span class="highlight"><span class="nb">apply</span> mapi_ext.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (def term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">x</span> : def term),
vass (dname (map_def (lift n k) g x))
  (lift0 n0 (dtype (map_def (lift n k) g x))) =
map_decl (lift n (n0 + k))
  (vass (dname x) (lift0 n0 (dtype x)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk18b"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (def term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k, n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">def term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">vass (dname (map_def (lift n k) g x))
  (lift0 n0 (dtype (map_def (lift n k) g x))) =
map_decl (lift n (n0 + k))
  (vass (dname x) (lift0 n0 (dtype x)))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk18c"><span class="highlight"><span class="nb">unfold</span> map_decl, vass; <span class="nb">simpl</span>; <span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (def term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k, n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">def term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift0 n0 (lift n k (dtype x)) =
lift n (n0 + k) (lift0 n0 (dtype x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk18d"><span class="highlight"><span class="nb">rewrite</span> permute_lift.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (def term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k, n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">def term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= k</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk18e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (def term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k, n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">def term</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk18e"><hr></label><div class="goal-conclusion"><span class="highlight">lift n (k + n0) (lift0 n0 (dtype x)) =
lift n (n0 + k) (lift0 n0 (dtype x))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk18f"><span class="highlight"><span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term -&gt; term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (def term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k, n0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">def term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lift n (k + n0) (lift0 n0 (dtype x)) =
lift n (n0 + k) (lift0 n0 (dtype x))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>; <span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight"><span class="c">(* </span>
<span class="c">Lemma noccur_between_subst k n t : noccur_between k n t -&gt; </span>
<span class="c">  closedn (n + k) t -&gt; closedn k t.</span>
<span class="c">Proof.</span>
<span class="c">Admitted. *)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk190"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">strip_casts_lift</span> <span class="nv">n</span> <span class="nv">k</span> <span class="nv">t</span> : 
  strip_casts (lift n k t) = lift n k (strip_casts t).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">strip_casts (lift n k t) = lift n k (strip_casts t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk191"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">strip_casts (lift n k t) = lift n k (strip_casts t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk192"><span class="highlight"><span class="nb">induction</span> t <span class="kr">in</span> k |- * <span class="nb">using</span> term_forall_list_ind; <span class="nb">simpl</span>; <span class="nb">auto</span>; 
    <span class="nb">rewrite</span> <span class="nl">?map_map_compose</span>  <span class="nl">?compose_on_snd</span> <span class="nl">?compose_map_def</span> <span class="nl">?map_length</span>;
   <span class="nb">f_equal</span>; solve_all; <span class="nb">eauto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">t1</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 t1) =
   lift n k0 (strip_casts t1)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, strip_casts (lift n k0 t0) = lift n k0 (strip_casts t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (strip_casts (lift n k t0))
  (map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; strip_casts (lift n k x)) l) =
lift n k (mkApps (strip_casts t0) (map strip_casts l))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk193" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">t2</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 t2) =
   lift n k0 (strip_casts t2)) (pparams t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
strip_casts (lift n k0 (preturn t0)) =
lift n k0 (strip_casts (preturn t0))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">x</span> : branch term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 (bbody x)) =
   lift n k0 (strip_casts (bbody x))) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, strip_casts (lift n k0 t1) = lift n k0 (strip_casts t1)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk193"><hr></label><div class="goal-conclusion"><span class="highlight">map_predicate id strip_casts strip_casts
  (map_predicate id (lift n k)
     (lift n (#|pcontext t0| + k)) t0) =
map_predicate id (lift n k)
  (lift n (#|pcontext t0| + k))
  (map_predicate id strip_casts strip_casts t0)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk194"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">t1</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 t1) =
   lift n k0 (strip_casts t1)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, strip_casts (lift n k0 t0) = lift n k0 (strip_casts t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (strip_casts (lift n k t0))
  (map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; strip_casts (lift n k x)) l) =
lift n k (mkApps (strip_casts t0) (map strip_casts l))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk195"><span class="highlight"><span class="nb">rewrite</span> lift_mkApps IHt map_map_compose.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">t1</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 t1) =
   lift n k0 (strip_casts t1)) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, strip_casts (lift n k0 t0) = lift n k0 (strip_casts t0)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mkApps (lift n k (strip_casts t0))
  (map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; strip_casts (lift n k x)) l) =
mkApps (lift n k (strip_casts t0))
  (map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; lift n k (strip_casts x)) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>; solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk196"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">t2</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 t2) =
   lift n k0 (strip_casts t2)) (pparams t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
strip_casts (lift n k0 (preturn t0)) =
lift n k0 (strip_casts (preturn t0))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">x</span> : branch term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 (bbody x)) =
   lift n k0 (strip_casts (bbody x))) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, strip_casts (lift n k0 t1) = lift n k0 (strip_casts t1)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_predicate id strip_casts strip_casts
  (map_predicate id (lift n k)
     (lift n (#|pcontext t0| + k)) t0) =
map_predicate id (lift n k)
  (lift n (#|pcontext t0| + k))
  (map_predicate id strip_casts strip_casts t0)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk197"><span class="highlight"><span class="nb">rewrite</span> !map_predicate_map_predicate.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">t2</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 t2) =
   lift n k0 (strip_casts t2)) (pparams t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
strip_casts (lift n k0 (preturn t0)) =
lift n k0 (strip_casts (preturn t0))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">x</span> : branch term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 (bbody x)) =
   lift n k0 (strip_casts (bbody x))) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, strip_casts (lift n k0 t1) = lift n k0 (strip_casts t1)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map_predicate (<span class="kr">fun</span> <span class="nv">x</span> : <span class="kn">Instance</span>.t =&gt; id (id x))
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; strip_casts (lift n k x))
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   strip_casts (lift n (#|pcontext t0| + k) x)) t0 =
map_predicate (<span class="kr">fun</span> <span class="nv">x</span> : <span class="kn">Instance</span>.t =&gt; id (id x))
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; lift n k (strip_casts x))
  (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt;
   lift n (#|pcontext t0| + k) (strip_casts x)) t0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk198"><span class="highlight"><span class="nb">unfold</span> map_predicate.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">t2</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 t2) =
   lift n k0 (strip_casts t2)) (pparams t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
strip_casts (lift n k0 (preturn t0)) =
lift n k0 (strip_casts (preturn t0))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">x</span> : branch term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 (bbody x)) =
   lift n k0 (strip_casts (bbody x))) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, strip_casts (lift n k0 t1) = lift n k0 (strip_casts t1)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{|
puinst := id (id (puinst t0));
pparams := map
             (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; strip_casts (lift n k x))
             (pparams t0);
pcontext := pcontext t0;
preturn := strip_casts
             (lift n (#|pcontext t0| + k) (preturn t0)) |} =
{|
puinst := id (id (puinst t0));
pparams := map
             (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; lift n k (strip_casts x))
             (pparams t0);
pcontext := pcontext t0;
preturn := lift n (#|pcontext t0| + k)
             (strip_casts (preturn t0)) |}</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk199"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">t2</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 t2) =
   lift n k0 (strip_casts t2)) (pparams t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
strip_casts (lift n k0 (preturn t0)) =
lift n k0 (strip_casts (preturn t0))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">x</span> : branch term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 (bbody x)) =
   lift n k0 (strip_casts (bbody x))) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, strip_casts (lift n k0 t1) = lift n k0 (strip_casts t1)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; strip_casts (lift n k x))
  (pparams t0) =
map (<span class="kr">fun</span> <span class="nv">x</span> : term =&gt; lift n k (strip_casts x))
  (pparams t0)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk19a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">t2</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 t2) =
   lift n k0 (strip_casts t2)) (pparams t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
strip_casts (lift n k0 (preturn t0)) =
lift n k0 (strip_casts (preturn t0))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">x</span> : branch term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 (bbody x)) =
   lift n k0 (strip_casts (bbody x))) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, strip_casts (lift n k0 t1) = lift n k0 (strip_casts t1)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk19a"><hr></label><div class="goal-conclusion"><span class="highlight">strip_casts (lift n (#|pcontext t0| + k) (preturn t0)) =
lift n (#|pcontext t0| + k) (strip_casts (preturn t0))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk19b"><span class="highlight">solve_all.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ci</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">case_info</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">predicate term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">t2</span> : term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 t2) =
   lift n k0 (strip_casts t2)) (pparams t0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat,
strip_casts (lift n k0 (preturn t0)) =
lift n k0 (strip_casts (preturn t0))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list (branch term)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">All
  (<span class="kr">fun</span> <span class="nv">x</span> : branch term =&gt;
   <span class="kr">forall</span> <span class="nv">k0</span> : nat,
   strip_casts (lift n k0 (bbody x)) =
   lift n k0 (strip_casts (bbody x))) l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : nat, strip_casts (lift n k0 t1) = lift n k0 (strip_casts t1)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">strip_casts (lift n (#|pcontext t0| + k) (preturn t0)) =
lift n (#|pcontext t0| + k) (strip_casts (preturn t0))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">solve_all.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk19c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mkApps_ex</span> <span class="nv">t</span> <span class="nv">u</span> <span class="nv">l</span> : ‚àë f args, Ast.mkApps t (u :: l) = Ast.tApp f args.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t, u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">‚àë (f : term) (args : list term),
  mkApps t (u :: l) = tApp f args</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk19d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t, u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">‚àë (f : term) (args : list term),
  mkApps t (u :: l) = tApp f args</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">induction</span> t; <span class="nb">simpl</span>; <span class="nb">eexists</span> _, _; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight"><span class="c">(* </span>
<span class="c">Lemma mkApps_tApp&#39; f l l&#39; : mkApps (tApp f l) l&#39; = mkApps f (l ++ l&#39;).</span>
<span class="c">Proof.</span>
<span class="c">  induction l&#39;; simpl. rewrite app_nil_r.  *)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk19e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">list_length_ind</span> {<span class="nv">A</span>} (<span class="nv">P</span> : list A -&gt; <span class="kt">Type</span>) (<span class="nv">p0</span> : P [])
  (<span class="nv">pS</span> : <span class="kr">forall</span> <span class="nv">d</span> <span class="nv">Œì</span>, (<span class="kr">forall</span> <span class="nv">Œì&#39;</span>, #|Œì&#39;| &lt;= #|Œì|  -&gt; P Œì&#39;) -&gt; P (d :: Œì)) 
  <span class="nv">Œì</span> : P Œì.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk19f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1a0"><span class="highlight"><span class="nb">generalize</span> (le_n #|Œì|).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì| &lt;= #|Œì| -&gt; P Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1a1"><span class="highlight"><span class="nb">generalize</span> #|Œì| <span class="nb">at</span> <span class="mi">2</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, #|Œì| &lt;= n -&gt; P Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1a2"><span class="highlight"><span class="nb">induction</span> n <span class="kr">in</span> Œì |- *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì| &lt;= <span class="mi">0</span> -&gt; P Œì</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk1a3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : list A, #|Œì0| &lt;= n -&gt; P Œì0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk1a3"><hr></label><div class="goal-conclusion"><span class="highlight">#|Œì| &lt;= S n -&gt; P Œì</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1a4"><span class="highlight"><span class="nb">destruct</span> Œì; [|<span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="nb">elimtype</span> <span class="kt">False</span>; <span class="bp">lia</span>].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì| -&gt; P Œì&#39;) -&gt;
P (d :: Œì)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|[]| &lt;= <span class="mi">0</span> -&gt; P []</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk1a5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : list A, #|Œì0| &lt;= n -&gt; P Œì0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk1a5"><hr></label><div class="goal-conclusion"><span class="highlight">#|Œì| &lt;= S n -&gt; P Œì</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1a6"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì| -&gt; P Œì&#39;) -&gt;
P (d :: Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|[]| &lt;= <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P []</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk1a7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : list A, #|Œì0| &lt;= n -&gt; P Œì0</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk1a7"><hr></label><div class="goal-conclusion"><span class="highlight">#|Œì| &lt;= S n -&gt; P Œì</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1a8"><span class="highlight"><span class="nb">apply</span> p0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : list A, #|Œì0| &lt;= n -&gt; P Œì0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì| &lt;= S n -&gt; P Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1a9"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : list A, #|Œì0| &lt;= n -&gt; P Œì0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì| &lt;= S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P Œì</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1aa"><span class="highlight"><span class="nb">destruct</span> Œì; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì| -&gt; P Œì&#39;) -&gt;
P (d :: Œì)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì</span> : list A, #|Œì| &lt;= n -&gt; P Œì</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt;= S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P []</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk1ab" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : list A, #|Œì0| &lt;= n -&gt; P Œì0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S #|Œì| &lt;= S n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk1ab"><hr></label><div class="goal-conclusion"><span class="highlight">P (a :: Œì)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1ac"><span class="highlight"><span class="nb">apply</span> p0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : list A, #|Œì0| &lt;= n -&gt; P Œì0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S #|Œì| &lt;= S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (a :: Œì)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1ad"><span class="highlight"><span class="nb">apply</span> pS.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì0| -&gt; P Œì&#39;) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : list A, #|Œì0| &lt;= n -&gt; P Œì0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S #|Œì| &lt;= S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì&#39;</span> : list A, #|Œì&#39;| &lt;= #|Œì| -&gt; P Œì&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1ae"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;0</span> : list A, #|Œì&#39;0| &lt;= #|Œì0| -&gt; P Œì&#39;0) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : list A, #|Œì0| &lt;= n -&gt; P Œì0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S #|Œì| &lt;= S n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= #|Œì|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P Œì&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1af"><span class="highlight"><span class="nb">apply</span> IHn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;0</span> : list A, #|Œì&#39;0| &lt;= #|Œì0| -&gt; P Œì&#39;0) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : list A, #|Œì0| &lt;= n -&gt; P Œì0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S #|Œì| &lt;= S n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= #|Œì|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1b0"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">d</span> : A) (<span class="nv">Œì0</span> : list A),
(<span class="kr">forall</span> <span class="nv">Œì&#39;0</span> : list A, #|Œì&#39;0| &lt;= #|Œì0| -&gt; P Œì&#39;0) -&gt;
P (d :: Œì0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">Œì0</span> : list A, #|Œì0| &lt;= n -&gt; P Œì0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S #|Œì| &lt;= S n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Œì'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|Œì&#39;| &lt;= #|Œì|</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|Œì&#39;| &lt;= n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1b1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">strip_casts_mkApps_tApp</span> <span class="nv">f</span> <span class="nv">l</span> : 
  isApp f = false -&gt;
  strip_casts (mkApps f l) = strip_casts (tApp f l).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isApp f = false -&gt;
strip_casts (mkApps f l) = strip_casts (tApp f l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1b2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isApp f = false -&gt;
strip_casts (mkApps f l) = strip_casts (tApp f l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1b3"><span class="highlight"><span class="nb">induction</span> l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isApp f = false -&gt;
strip_casts (mkApps f []) = strip_casts (tApp f [])</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="LiftSubst-v-chk1b4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp f = false -&gt; strip_casts (mkApps f l) = strip_casts (tApp f l)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="LiftSubst-v-chk1b4"><hr></label><div class="goal-conclusion"><span class="highlight">isApp f = false -&gt;
strip_casts (mkApps f (a :: l)) =
strip_casts (tApp f (a :: l))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1b5"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp f = false -&gt; strip_casts (mkApps f l) = strip_casts (tApp f l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isApp f = false -&gt;
strip_casts (mkApps f (a :: l)) =
strip_casts (tApp f (a :: l))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1b6"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp f = false -&gt; strip_casts (mkApps f l) = strip_casts (tApp f l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp f = false</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">strip_casts (mkApps f (a :: l)) =
strip_casts (tApp f (a :: l))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">rewrite</span> mkApps_tApp //.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1b7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">strip_casts_mkApps</span> <span class="nv">f</span> <span class="nv">l</span> : 
  isApp f = false -&gt;
  strip_casts (mkApps f l) = mkApps (strip_casts f) (map strip_casts l).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isApp f = false -&gt;
strip_casts (mkApps f l) =
mkApps (strip_casts f) (map strip_casts l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1b8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">isApp f = false -&gt;
strip_casts (mkApps f l) =
mkApps (strip_casts f) (map strip_casts l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="LiftSubst-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="LiftSubst-v-chk1b9"><span class="highlight"><span class="nb">intros</span> Hf.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list term</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">isApp f = false</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">strip_casts (mkApps f l) =
mkApps (strip_casts f) (map strip_casts l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">rewrite</span> strip_casts_mkApps_tApp //.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre></article></body></html>